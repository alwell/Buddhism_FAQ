<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>

<script type="text/javascript">
// <![CDATA[
// Begin Ad Muncher helper script
// Do not remove without removing all references to this in the below page (eg: everything containing "Xyw" or "Xyb")
// Original URL:   http://zolag.tiddlyspot.com/
// Retrieved from: 208.97.134.114:80
function Xywn(){return false;};
function XywbHelp(a,b){XywXgp(a);XywXbn();return;};
function Xywb(a,b,c,d){XywXgp(a);XywXbn();return XywXfw(b);};
function XywXpp(a){XywXppa=a;if(a)XywXorgsti("XywXppa=0;",500);};
function XywbtePopup(a,b,c,d,e,f){XywXgp();XywXbn();return XywXfw();};
function XywbModalDialog(a,b,c){XywXgp(a);XywXbn();return XywXfw();};
function XywXj(m,u,l){if(XywXolp){XywXqn=XywXqnbu;XywXolp=0;};return true;};
function XywbModelessDialog(a,b,c){XywXgp(a);XywXbn();return XywXfw();};
function XywXpl(a,b,c){while(a.indexOf(b)!=-1)a=a.replace(b,c);return a;};
function XywXtry(a,z){if(XywXtryk())eval("try{"+a+"}catch(e){};");else eval(a);};
function Xywc(){XywXqn=XywXqnbu=10;XywXorgsti("XywXqn=XywXqnbu=0;",500);return;};
function XywX__amscript_addonload(a){XywX_ams_onload[XywX_ams_onload_i++]=(typeof(a)=="function")?a:new Function(a);};
function XywX__amscript_addonunload(a){XywX_ams_onunload[XywX_ams_onunload_i++]=(typeof(a)=="function")?a:new Function(a);};
function XywXfcs(z){XywXfcsr=0;if(z){XywXfcsrz=z;XywXtry("XywXfcsr=XywXfcsd();");};return XywXfcsr;};
function XywXfc(a,z){for(var i=0;i<a.length;i++)if(a[i].name==z||XywXfc(a[i].frames,z))return 1;return 0;};
function Xyb(z){if(typeof(z.location)!="undefined"||typeof(z.blur)=="undefined")return false;return z.blur();};
function Xywf(z){if(typeof(z.location)!="undefined"||typeof(z.focus)=="undefined")return false;return z.focus();};
function XywXHelp(a,b){if(XywXck(a))return;if(XywXqn)XywXqn-=1;if(b)return showHelp(a,b);else return showHelp(a);};
function XywTimeout(a,b){if(((!XywXqn&&!XywXa)||XywXppa||XywXul)&&typeof(a)=="string")return XywXorgsti("XywXpp(1);"+a+";XywXpp(0);",b);return XywXorgsti(a,b);};
function XywInterval(a,b){if(((!XywXqn&&!XywXa)||XywXppa||XywXul)&&typeof(a)=="string")return XywXorgsin("XywXpp(1);"+a+";XywXpp(0);",b);return XywXorgsin(a,b);};
function XywXbn(){if(XywXd&&XywXm){if(XywXb){XywXc="s";XywXb+=", "+XywXm;}else{XywXc="";XywXb=XywXm;};XywXi="Popup"+XywXc+" on page blocked by Ad Muncher: "+XywXb;XywXu();};};
function XywXox(){var x;for(var i=0;i<XywX_ams_onunload.length;i++){if(typeof(XywX_ams_onunload[i])=="function")XywX_ams_onunload[i]();};if(typeof(XywXffad)!="undefined"&&!XywXffadd){if(XywXkou)XywXul=1;XywXffadd=1;if(typeof(XywXffad)=="function")x=XywXffad();else eval(XywXffad);XywXul=0;};return x;};
function XywXModalDialog(a,b,c){if(XywXck(a,b))return XywXfw();if(XywXqn)XywXqn-=1;if(c)return showModalDialog(a,b,c);else if(b)return showModalDialog(a,b);else return showModalDialog(a);};
function XywXs(a){if((typeof(a.target)!="undefined"&&typeof(a.action)!="undefined"&&a.target&&XywXnw(a.target)&&XywXck(a.action))||typeof(a.submit)=="undefined")return false;return a.submit();};
function XywXt(a){if((XywXqn||XywXa)&&!XywXppa&&!XywXul){if(XywXqn)XywXqn-=1;return alert(a);};if(a&&XywXd){XywXi="Alert message blocked by Ad Muncher: "+XywXpl(a,"\n"," ");XywXu();};return false;};
function XywXModelessDialog(a,b,c){if(XywXck(a,b))return XywXfw();if(XywXqn)XywXqn-=1;if(c)return showModelessDialog(a,b,c);else if(b)return showModelessDialog(a,b);else return showModelessDialog(a);};
function XywXsp(a,z){if(a.split)return a.split(z);var j,c,s,n,b,e;j=b=0;c=on.length;s=new Array();a+=z;n=a.length;while(b<n){e=z?a.indexOf(z,b):b+1;s[j++]=a.substring(b,e);b=e+c;};return s.length=j,s;};
function XywXu(a){XywXi=XywXpl(XywXpl(XywXi.substring(0,1024),'"',"<~am~`"),"<~am~`",'\\"');XywXir='defaultStatus="'+XywXi+'";';if(!XywXss){XywXss=1;XywXorgsin("eval(XywXir);",3000);};XywXorgsti("eval(XywXir);",1000);};
function XywXe(){XywXa=0;XywXqnbu=XywXqn;XywXqn=0;XywXolp=1;XywXorgsti("XywXa=1;",1000);if(!XywXffd){XywXffd=1;for(var i=0;i<XywX_ams_onload.length;i++){if(typeof(XywX_ams_onload[i])=="function")XywX_ams_onload[i]();};if(typeof(XywXff)!="undefined"){if(typeof(XywXff)=="function")XywXff();else eval(XywXff);};};XywXqn=XywXqnbu;XywXolp=0;XywXx();};
function XywXnw(a){XywXagt=navigator.userAgent.toLowerCase();if(a!="_self"&&a!="_top"&&a!="_main"&&a!="_parent"&&!XywXfcs(a)&&((XywXagt.indexOf("msie")==-1||XywXagt.indexOf("opera")!=-1)||(a!="_search"&&a!="_media")))return 1;return 0;};
function XywXobx(){var x;if(typeof(XywXffreunload)!="undefined"&&!XywXffreunloadd){if(XywXkou)XywXul=1;XywXffreunloadd=1;if(typeof(XywXffreunload)=="function")x=XywXffreunload();else eval(XywXffreunload);XywXffreunloadd=0;XywXul=0;};return x;};
function XywXtryk(){var b=navigator.userAgent.toLowerCase();var c=parseInt(navigator.appVersion);if((b.indexOf("mozilla")!=-1&&b.indexOf("compatible")== -1&&c>=5)||(b.indexOf("opera")!=-1&&c>=6)||(b.indexOf("msie")!=-1&&c>=4))return 1;return 0;};
function XywXfcsd(){var v=self;if(XywXfc(v.frames,XywXfcsrz)||(typeof(v.name)!="undefined"&&v.name==XywXfcsrz))return 1;while(v!=v.parent){v=v.parent;if(XywXfc(v.frames,XywXfcsrz)||(typeof(v.name)!="undefined"&&v.name==XywXfcsrz))return 1;};return 0;};
function XywXtePopup(a,b,c,d,e,f){if(XywXck())return XywXfw();if(XywXqn)XywXqn-=1;if(f)return createPopup(a,b,c,d,e,f);else if(e)return createPopup(a,b,c,d,e);else if(d)return createPopup(a,b,c,d);else if(c)return createPopup(a,b,c);else if(b)return createPopup(a,b);else return createPopup(a);};
function XywXmc(){if(typeof(document.layers)!="undefined")document.captureEvents(Event.KeyDown|Event.MouseUp|Event.Blur|Event.KeyPress|Event.Move|Event.Click|Event.KeyUp|Event.Reset|Event.Change|Event.Load|Event.Resize|Event.DblClick|Event.MouseDown|Event.Select|Event.DragDrop|Event.MouseMove|Event.Submit|Event.Error|Event.MouseOut|Event.Unload|Event.Focus|Event.MouseOver);document.onmousedown=XywXr;return 0;};
function XywXck(a,b){if(!XywXul&&!XywXppa&&(XywXro||XywXqn||XywXa||(b&&!XywXnw(b)))){return 0;};XywXgp(a);var l,s,c;for(var i=0;i<XywXpmx.length;i++){l=0;s=XywXsp(XywXpmx[i],"*");for(var z=0;z<s.length;z++){c=XywXn.indexOf(s[z],l);if(c==-1){l=0;break;};l=c;};if(l)return 0;};XywXbn();if(XywXrp){XywXrpi5=XywXrpi4;XywXrpi4=XywXrpi3;XywXrpi3=XywXrpi2;XywXrpi2=XywXrpi1;XywXrpi1=new Image();var XywXzn;XywXtry("XywXzn=document.referrer");XywXrpi1.src="http://www.admuncher.com/cgi-bin/pr.pl?p="+escape(XywXm)+"&s="+escape(document.location.href)+"&r="+escape(XywXzn)+"&v=4.7.27105&l=1511";};return 1;};
function XywXr(e){if((e&&e.which==1)||(typeof(window.event)!="undefined"&&window.event.button==1)){XywXqn=XywXqnbu=10;XywXorgsti("XywXqn=XywXqnbu=0;",500);if(typeof(document.XywXusedown)!="undefined"){if(typeof(document.XywXusedown)=="function")return document.XywXusedown(e);else return eval(document.XywXusedown);};};if(typeof(document.XywXusedown)!="undefined"){if(e||typeof(window.event)!="undefined"){if(typeof(document.XywXusedown)=="function"){XywXpp(0);var XywXtn=document.XywXusedown(e);XywXpp(1);return XywXtn;}else return eval("XywXpp(1);"+document.XywXusedown+";XywXpp(0);");};if(typeof(document.XywXusedown)=="function")return document.XywXusedown(e);else return eval(document.XywXusedown);};return true;};
function XywXx(){XywXtry('if(typeof(window.onload)=="undefined")window.onload=XywXe;else{XywXq=""+window.onload;if(!window.onload||!XywXq||XywXq.indexOf("XywXe")!=-1)window.onload=XywXe;};if(typeof(window.onunload)=="undefined")window.onunload=XywXox;else{XywXq=""+window.onunload;if(!window.onunload||!XywXq||XywXq.indexOf("XywXox")!=-1)window.onunload=XywXox;};if(typeof(window.onbeforeunload)=="undefined")window.onbeforeunload=XywXobx;else{XywXq=""+window.onbeforeunload;if(!window.onbeforeunload||!XywXq||XywXq.indexOf("XywXobx")!=-1)window.onbeforeunload=XywXobx;};if(typeof(window.onmousedown)=="undefined")XywXmc();else{XywXq=""+document.onmousedown;if(!window.onmousedown||!XywXq||XywXq.indexOf("XywXr")!=-1){XywXmc();};};');};
function XywXgp(a){if(a){var XywXckjs=/[A-Za-z]+:/;if(a.search(XywXckjs)!=-1){if(a.substring(0,5).toLowerCase()!="http:"){XywXm="(No URL)";XywXn=a.toLowerCase()+" "+document.URL.toLowerCase();return;};};XywXp="/admuncherpopcheck&"+Math.random()+"&"+document.URL;XywXmi3=XywXmi2;XywXmi2=XywXmi1;XywXmi1=new Image();XywXn=a;XywXnn=XywXn.indexOf("#");if(XywXnn!=-1)XywXn=XywXn.substring(0,XywXnn);XywXmi1.src=XywXn+XywXp;XywXnn=XywXmi1.src.indexOf(XywXp);if(XywXnn!=-1)XywXm=XywXmi1.src.substring(0,XywXnn);XywXn=XywXm.toLowerCase()+" "+document.URL.toLowerCase();}else{XywXm="(No URL)";XywXn=document.URL.toLowerCase();XywXp="/admuncherpopchecknourl&"+Math.random();XywXmi3=XywXmi2;XywXmi2=XywXmi1;XywXmi1=new Image();XywXmi1.src=document.URL+XywXp;};};
function XywX(a,b,c,d){if(XywXck(a,b))return XywXfw(b);if(XywXqn)XywXqn-=1;if(!a)a="";if(typeof(c)=="string"){c=XywXpl(c.toLowerCase()," ","");if(XywXw){c=XywXpl(c,"height=","xxx=");c=XywXpl(c,"width=","xxx=");c=XywXpl(c,"top=","xxx=");c=XywXpl(c,"left=","xxx=");c=XywXpl(c,"screenx=","xxx=");c=XywXpl(c,"screeny=","xxx=");};if(XywXy){c=XywXpl(c,"location=","xxx=");c=XywXpl(c,"toolbar=","xxx=");c=XywXpl(c,"menubar=","xxx=");c=XywXpl(c,"resizable=","xxx=");c=XywXpl(c,"scrollbars=","xxx=");c=XywXpl(c,"status=","xxx=");c=XywXpl(c,"titlebar=","xxx=");c=XywXpl(c,"fullscreen=","xxx=");c=XywXpl(c,"directories=","xxx=");};};if(XywXy){if(typeof(c)=="string")c+=",";else c="";c+="location,toolbar,menubar,resizable,scrollbars,status,titlebar,directories";};if(d)return XywXorgo(a,b,c,d);else if(c)return XywXorgo(a,b,c);else if(b)return XywXorgo(a,b);else return XywXorgo(a);};
function XywXso(c,a){if(typeof(a)=="string"&&a.substring(0,11)=="javascript:"){a=a.substring(11,a.length);};if(typeof(XywXsod[c])=="undefined"||!XywXsod[c]){XywXsod[c]=1;var x=new Array('quot22','amp26','lt3C','gt3E','nbspA0','iexclA1','centA2','poundA3','yenA5','brvbarA6','sectA7','umlA8','copyA9','ordfAA','laquoAB','notAC','shyAD','regAE','macrAF','degB0','plusmnB1','sup2B2','sup3B3','acuteB4','microB5','paraB6','middotB7','cedilB8','sup1B9','ordmBA','raquoBB','frac14BC','frac12BD','frac34BE','iquestBF','AgraveC0','AacuteC1','AcircC2','AtildeC3','AumlC4','AringC5','AEligC6','CcedilC7','EgraveC8','EacuteC9','EcircCA','EumlCB','IgraveCC','IacuteCD','IcircCE','IumlCF','ETHD0','NtildeD1','OgraveD2','OacuteD3','OcircD4','OtildeD5','OumlD6','timesD7','OslashD8','UgraveD9','UacuteDA','UcircDB','UumlDC','YacuteDD','THORNDE','szligDF','agraveE0','aacuteE1','acircE2','atildeE3','aumlE4','aringE5','aeligE6','ccedilE7','egraveE8','eacuteE9','ecircEA','eumlEB','igraveEC','iacuteED','icircEE','iumlEF','ethF0','ntildeF1','ograveF2','oacuteF3','ocircF4','otildeF5','oumlF6','divideF7','oslashF8','ugraveF9','uacuteFA','ucircFB','uumlFC','yacuteFD','thornFE','yumlFF');var l,m;for(var i=0;i<x.length;i++){if (typeof(x[i])=="string"){l=x[i].length;m="&"+x[i].substring(0,(l-2))+";";a=XywXpl(a,m,unescape("%"+x[i].substring((l-2),l)));};};if(c==1)XywXff=new Function(a);if(c==2)XywXffad=new Function(a);if(c==3)XywXffreunload=new Function(a);};};
function XywXfw(b){var r=new Object();for(i in window)r[i]=window[i];var v=new Array("scrollBy","getSelection","scrollByLines","scrollByPages","sizeToContent","dump","setTimeout","setInterval","clearTimeout","clearInterval","setResizable","captureEvents","releaseEvents","routeEvent","enableExternalCapture","disableExternalCapture","prompt","open","openDialog","find","alert","confirm","focus","blur","back","forward","home","stop","print","moveTo","moveBy","resizeTo","resizeBy","scroll","close","show","updateCommands","escape","unescape","atob","btoa","addEventListener","removeEventListener","dispatchEvent","getComputedStyle");for(var i=0;i<v.length;i++)r[v[i]]=Xywn;v=new Array("captureEvents","close","open","releaseEvents","clear","writeln","getElementById","getElementsByName","elementFromPoint","createEvent","getSelection","write","createElement","createElementNS","createDocumentFragment","createTextNode","createComment","createAttribute","getElementsByTagName","importNode","attachEvent","detachEvent","hasAttributes","addEventListener","removeEventListener","dispatchEvent","contains","insertBefore","replaceChild","removeChild","appendChild","hasChildNodes","isSupported","normalize","cloneNode");r.document=new Object();for(var i=0;i<v.length;i++)r.document[v[i]]=Xywn;r.document.body=new Object();r.document.body.style=new Object();r.name=b;r.amwin="a";r.location=new Object(XywXm);r.location.href=XywXm;r.location.hash=window.location.hash;r.location.host=window.location.host;r.location.hostname=window.location.hostname;r.location.pathname=window.location.pathname;r.location.port=window.location.port;r.location.protocol=window.location.protocol;r.location.search=window.location.search;XywXclct+=1;eval("XywXpc["+XywXclct+"]=r;XywXorgsti(\"XywXpc["+XywXclct+"].closed=true;\",1500);");return r;};
if(typeof(self.XywXinited)=="undefined"){
var XywXinited=1;var XywXa,XywXb,XywXc,XywXd,XywXi,XywXir,XywXk,XywXm,XywXmi1,XywXmi2,XywXmi3,XywXn,XywXnn,XywXp,XywXq,XywXss,XywXv,XywXw,XywXy,XywXro,XywXolp,XywXqn,XywXqnbu,XywXplt,XywXagt,XywXtz,XywXti,XywXsa,XywXeb,XywXrp,XywXrpi1,XywXrpi2,XywXrpi3,XywXrpi4,XywXrpi5,XywXppa,XywXffd,XywXorgo,XywXorgsin,XywXorgsti,XywXul,XywXkou,XywXffreunloadd,XywXffadd,XywXfcsr,XywXfcsrz;var XywX_ams_onload_i=0;var XywX_ams_onload=new Array();var XywX_ams_onunload_i=0;var XywX_ams_onunload=new Array();var XywXsod=new Array();for(var XywXvin="";XywXvin!="aaaaaaaaaaaaaaaaaaaa";XywXvin+="a")eval("var AdMch"+XywXvin+";");var XywXclct=0;var XywXpc=new Array();XywXk=1;XywXd=1;XywXw=0;XywXy=0;XywXro=0;XywXi="";XywXtz=0;XywXti=0;XywXrp=0;XywXkou=1;var XywXpmx=new Array('.gov/funzone/','/apps/mediaplayer/','/home/loaded.php?room=','/online/popup.html?','/playradionow.jsp?','/portalcookiecheck.aspx?site=','/private.php?','/privmsg.php?','/radio/launchradio.','/reviews_viewer.php?object=','/site/olspage.jsp?id=','/spurl.php?v=','/video/partners/','/vspot/player.','/watch_fullscreen?','isapi.dll?picture','launch.yahoo.*/play/','music.yahoo.','skinbase.org/files/','webmessenger.msn.com');XywXorgo=open;XywXorgsti=setTimeout;XywXorgsin=setInterval;XywXx();if(XywXk)XywXtry("window.onerror=XywXj;");var XywXz;XywXtry("XywXz=document.referrer");if(!XywXz){if(XywXti){if(XywXtz)XywXz=location.protocol+"//"+location.host+"/";else XywXz="http://www.admuncher.com/";};}else if(XywXz.substring(0,7)=="http://"){XywXsa=XywXz;XywXsa=XywXsa.substring(7,1024);if(XywXsa.indexOf("/")!=-1)XywXsa=XywXsa.substring(0,XywXsa.indexOf("/"));if(XywXsa!=location.host){if(XywXtz)XywXz=location.protocol+"//"+location.host+"/";else XywXz="http://www.admuncher.com/";};};
/*1*/ var XywX__amscript_slist=new Array("adjab.com","autoblog.com","autobloggreen.com","bbhub.com","bloggingbaby.com","blogginge3.com","bloggingneworleans.com","bloggingohio.com","bloggingstocks.com","cardsquad.com","cinematical.com","divester.com","downloadsquad.com","droxy.com","dsfanboy.com","dvguru.com","engadget.com","engadgetmobile.com","flashinsider.com");
/*2*/  XywX__amscript_slist=XywX__amscript_slist.concat("gadling.com","hdbeat.com","joystiq.com","luxist.com","medicalinformaticsinsider.com","ps3fanboy.com","pspfanboy.com","pvrwire.com","revolutionfanboy.com","slashfood.com","thecancerblog.com","thecardioblog.com","thediabetesblog.com","thewirelessreport.com","tuaw.com","tvsquad.com","weblogsinc.com","wowinsider.com","xbox360fanboy.com");
/*3*/ for(var XywX__amscript_i=0;XywX__amscript_i<XywX__amscript_slist.length;XywX__amscript_i++)if(document.domain.indexOf(XywX__amscript_slist[XywX__amscript_i])!=-1){document.write('<style type="text/css"> p.sponsored, div.topleader, div.leader, div.medrect, object#pchome, div#dogear_promo, div#aolautos, div.nextag, div#promobanner {display:none;} div#outerslice {visibility:hidden;} <\/style>');};
/*4*/ var XywX__amscript_zdlist=new Array("baselinemag.com","channelinsider.com","cioinsight.com","desktoplinux.com","digitallife.com","eweek.com","extremetech.com","linuxdevices.com","microsoft-watch.com","pcmag.com","pdfzone.com","publish.com","smartcompany.com","windowsfordevices.com");
/*5*/ for(var XywX__amscript_zd=0;XywX__amscript_zd<XywX__amscript_zdlist.length;XywX__amscript_zd++)if(document.domain.indexOf(XywX__amscript_zdlist[XywX__amscript_zd])!=-1){document.write('<style type="text/css"> .AdModule_Content, div#p_sl_header, div#p_spotlight, .AdModule_BG, .AdModule_ContentLarge, .PremPart_Container, .partner_spotlight, .spoModule_hdr, .spoModule_Content, .Newsletter_BG, .AD_BG, .sponsors_container, div#Premium_Partners_Super_Container, .hp_text_deck_style, table.buy_it_here_table, div#hp_ad_right_column_1, div.zd_services_wrapper, #eweekWPModule, table#Table_01, table.SponsorBg, div#marketplace_container, div.ad_sponsors, div#TopAdBox, div#towerAd, div.bottom_sponsor_space, td.mktcell1, td.mktcell2, table.bgcolor4, div.sponsors_container {display:none;} <\/style>');};
AFProcessSaleV2=new Function();opener=new Object();
GA_googleFillSlot=new Function();GA_googleAddSlot=new Function();GA_googleFetchAds=new Function();
OAS_VARS=new Function();OAS_START=new Function();TR_Show=new Function();trataLinksCentr=new Function();var adll="fake";
XywX__amscript_addonload("if (typeof(tuw)=='function'){t=1;tuw();}else if (typeof(tuw1)=='function'){ts=1;tuw1();};");
XywX__amscript_addonload("if(document.domain.indexOf(\".startpagina.nl\")!=-1){n=new Function();n2=new Function();};");
XywX__amscript_addonload("if(location.href.indexOf('/login/redirect.php?url=')!=-1&&typeof(redir)=='function'){redir();};");
XywX__amscript_addonload("if(typeof(AdTimeOut)=='function'&&document.getElementById('adContainer')){AdTimeOut();adEnd();};");
XywX__amscript_addonload("if(typeof(DisplayInfo)=='function'&&typeof(popup)=='function'){DisplayInfo=new Function();};");
XywX__amscript_addonload("if(typeof(FCx)=='function'){document.cookie='FCxIC=1; path=/; expires=';};");
XywX__amscript_addonload("if(typeof(Handle_AdPlaybackComplete)=='function')Handle_AdPlaybackComplete();else if(typeof(HandleAdPlaybackComplete)=='function')HandleAdPlaybackComplete();");
XywX__amscript_addonload("if(typeof(PREPLAY)!='undefined'&&typeof(PREPLAY.showContent)=='function')PREPLAY.showContent();");
XywX__amscript_addonload("if(typeof(actionLib)=='function')actionLib=new Function();");
XywX__amscript_addonload("if(typeof(bannerclick)=='function'){bannerclick=new Function('document.banner.submit();');};");
XywX__amscript_addonload("if(typeof(change_ads_download)=='function'){change_ads_download=new Function();};");
XywX__amscript_addonload("if(typeof(checkAd)=='function'&&document.getElementById('video_ad'))checkAd();");
XywX__amscript_addonload("if(typeof(closeAd)=='function'&&document.getElementById('adDiv'))closeAd();");
XywX__amscript_addonload("if(typeof(countdown)==\"function\"&&document.getElementById('downloadhtml')){var v=String(countdown).match(/if\\s*\\(\\s*([a-zA-Z][0-9]{4})[^a-zA-Z0-9_]/);if(v.length==2){window[v[1]]=1;countdown();};};");
XywX__amscript_addonload("if(typeof(destination)=='string'&&typeof(cookName)=='string'){SetCookie(cookName,cookVal,expyear);}");
XywX__amscript_addonload("if(typeof(doClick)=='function')doClick=new Function();");
XywX__amscript_addonload("if(typeof(doSwitch)=='function')doSwitch();");
XywX__amscript_addonload("if(typeof(doneWithMedia)=='function'&&document.getElementById('movieTitle')){doneWithMedia();};");
XywX__amscript_addonload("if(typeof(download)=='function'&&document.getElementById('dl')){time=1;download();};");
XywX__amscript_addonload("if(typeof(download)=='function'&&document.getElementById('rom')){time=1;download();};");
XywX__amscript_addonload("if(typeof(drawAdCalls)=='function'){drawAdCalls=new Function();}");
XywX__amscript_addonload("if(typeof(endAd)=='function'&&document.getElementById('displayBlock'))endAd();");
XywX__amscript_addonload("if(typeof(expired)=='function'&&typeof(checktime)=='function'){setTimeout('expired();',5);};");
XywX__amscript_addonload("if(typeof(fc)=='function'&&document.getElementById('itemover')){c=0;fc();};");
XywX__amscript_addonload("if(typeof(fsrD)=='function'){fstime = 0;}");
XywX__amscript_addonload("if(typeof(getVideo)=='function'&&typeof(getVideoPreroll)=='function')getVideo();");
XywX__amscript_addonload("if(typeof(goBackToReferer)=='function'){goBackToReferer();};");
XywX__amscript_addonload("if(typeof(loaded)=='function'&&typeof(load)=='function')loaded();");
XywX__amscript_addonload("if(typeof(loading)=='function'&&document.getElementById('download')){loaded=1;loading();};");
XywX__amscript_addonload("if(typeof(loadingdownload)=='function')loadingdownload=new Function();");
XywX__amscript_addonload("if(typeof(open_popup_media)=='function'){seconds=4;document.counter.d2.value='4';open_popup_media=new Function();};");
XywX__amscript_addonload("if(typeof(pop_ping)=='function'&&typeof(send_ping)=='function'){pop_ping=new Function();send_ping=new Function();};");var currentStory_uoi_id;
XywX__amscript_addonload("if(typeof(prevSize)=='function'&&typeof(goToDest)=='function')goToDest();");
XywX__amscript_addonload("if(typeof(programManager)!='undefined'&&typeof(programManager.preplayComplete)=='function')programManager.preplayComplete();");
XywX__amscript_addonload("if(typeof(refreshAd)=='function')refreshAd=new Function('');");
XywX__amscript_addonload("if(typeof(remove_ad)=='function'&&typeof(show_game)=='function'){remove_ad();show_game();};");
XywX__amscript_addonload("if(typeof(returnToRequestedPage)=='function'&&document.getElementById('sponsorship')){returnToRequestedPage();};");
XywX__amscript_addonload("if(typeof(rotateRoomAd)=='function'){rotateRoomAd=new Function();};");
XywX__amscript_addonload("if(typeof(sendHome)=='function'&&document.getElementById('wholepagemea')){sendHome();};");
XywX__amscript_addonload("if(typeof(showContent)=='function'&&document.getElementById('preplay')){setTimeout('showContent();',5);};");
XywX__amscript_addonload("if(typeof(show_url)=='function'&&document.getElementById('img_code_block'))show_url(0);");
XywX__amscript_addonload("if(typeof(show_wa)=='function'){show_wa=new Function();};");
XywX__amscript_addonload("if(typeof(waitForDownload)=='function'&&document.getElementById('download_link')){waitingTime=0;waitForDownload();};");
XywX__amscript_addonload("if(typeof(zCu)=='function'&&typeof(adunit)=='function'){zT=new Function('');};");
XywX__amscript_addonload("openBadPopUp=new Function();openQuestion=new Function();openFavoritesQuestion=new Function();openSidebar=new Function();if(typeof(openBadPopUp)=='function'&&typeof(enter)=='function'){enter=new Function();};");
XywX__amscript_addonload('if(location.href.indexOf(\'/showplay_robosapien.asp?\')!=-1){window.setTimeout(\'window.location="../../showplay.asp?episode=" + episode; \',1);};');
ads_gettag=new Function();overture_suchbegriffe=new Object;
callShopping=new Function();ShopWidget=new Function();ShopWidget.prototype.render=function(){};
ckAdWatch ='0';getIgnlogin=new Function();getAta=new Function();function changeStatus(status){document.getElementById("downloadStatus").innerHTML = status;};
clickLink=new Function();
cnnad_createAd=new Function();
endBodyAdCode=new Function();adCall=new Function();
fc_click=new Function();
function AV_init(){};
function DM_tag(){};function DM_addToLoc(){};
function OAS_AD(){};function DisplayAds(){};
function O_GoT(){};
function XywX__amscript_gcc(){var o=new Date();var d=o.getDate();var m=o.getMonth() + 1;var y=o.getFullYear();d=(d < 10) ? '0' + d:d;m=(m < 10) ? '0' + m:m;y=(y > 2000) ? y - 2000:y;y=(y < 10) ? '0' + y:y;return m + d + y;};if(document.domain.indexOf(".tv.com")!=-1){document.cookie='tv_promo_'+XywX__amscript_gcc()+'=1;expires=Thu, 8 Jul 2010 08:11:31 UTC;path=/';document.cookie='tv_interstitial=VIEWED; expires=Thu, 8 Jul 2010 08:11:31 UTC; path=/';}else if(document.domain.indexOf(".gamespot.com")!=-1){document.cookie='gspot_side_'+XywX__amscript_gcc()+'=1;expires=Thu, 8 Jul 2010 08:11:31 UTC;domain=gamespot.com;path=/';};function mboxCreate(){};function MadCap(){};XywX__amscript_addonload("if(document.getElementById('gnenav')&&document.getElementById('prestitial')&&location.href.indexOf('?request_url=')==-1){window.location.reload();};");
function XywX__amscript_rf(a,b,c,d){XywX__amscript_addonload('if(typeof(window.'+a+')=="function")eval("window.'+a+'="+window.'+a+'.toString().replace(/'+b.replace(/\//,'\\/')+'/'+d+',\"'+c.replace(/"/,'\\\\"')+'\"));');};if(document.domain.indexOf(".cnbc.com")!=-1&&location.href.indexOf("?video=")!=-1){XywX__amscript_rf('cnbc_video_playURL',"\\?ad=[^&]*&url=",'?url=','i');};
function XywX__amscript_sWinSiz(am1,am2){var wHeight = parseInt(am1);var wWidth = parseInt(am2);window.resizeTo(wWidth,wHeight);if (self.innerWidth){wDelta = (wWidth - self.innerWidth);hDelta = (wHeight - self.innerHeight);}else if (document.documentElement && document.documentElement.clientWidth){wDelta = (wWidth - document.documentElement.clientWidth);hDelta = (wHeight - document.documentElement.clientHeight);}else if (document.body){wDelta = (wWidth - document.body.clientWidth);hDelta = (wHeight - document.body.clientHeight);}window.resizeTo((wWidth + wDelta),(wHeight + hDelta));};
function __utmLinker(amURL){document.location = amURL;};
function _isr_load(isr_){var isr_a=isr_.options[isr_.selectedIndex].value;if(isr_a){location.href=isr_a}return false};
function adSetOthDclk(){};params=new Object();function get_links(){};function rsiAdInit(){};
function adSetSearch(){};function adSetType(){};function htmlAdWH(){};function adSetTarget(){};
function cmCreateProductviewTag(){};function cmSetProduction(){};function cmCreatePageviewTag(){};function cmSetProductionBasedOnURL(){};function cmCreateTechPropsTag(){};function cmPageviewOnClick(){};function cmSetProductCategories(){};
function dcsMultiTrack(){};
function doubleClickAd(){this.renderDoubleClickAd=function(){};};
function getRandom(a,b){return Math.round(Math.random() * (b - a)) + 1;};var agentP;
function get_a(){};function get_adi(){};var rsinetsegs = new Array("happy","sad");
function goLink(){};
function popPLTracklink(_link,param_0,param_1,param_2){sendInitCall(param_0, param_1, param_2);popPlaytime(_link);};function tracklink(_link,param_0,param_1,param_2){location.href = _link;};
function quantserve(){};function TCDA(){};
function recordASCEvent2(){};
function s_co(){};function s_wds(){};
function s_gs(){};function trackFlash(){};function launchFlashLink(linkURL,trackCode) {window.location.href = linkURL;};trackClick=new Function();
function sf(){document.f.q.focus();};
function thisLoad(){};
function urchinTracker(){};
if (document.domain.indexOf(".1up.com")!=-1) {document.cookie='prestitial=1; expires=Thu, 8 Jul 2011 22:16:14 UTC; path=/';};
if (document.domain.indexOf(".answers.com")!=-1) { document.write('<style type="text/css"> div.sponsoredBar, td#th1 {display:none;} <\/style>');};
if (document.domain.indexOf(".go.com")!=-1) { document.write('<style type="text/css"> div#ad_top, div#feature_sponsor, div#marketplace, div#columnad {display:none;} <\/style>');};
if (document.domain.indexOf(".google.com")!=-1){var rwt=new Function();var clk=new Function();};
if (document.domain.indexOf(".space.com")!=-1) {document.cookie='interstitial2=1; expires=Thu, 8 Jul 2012 20:16:14 UTC; path=/';};
if (document.domain.indexOf(".theonion.com")!=-1) {document.cookie='premercial=true; expires=Thu, 8 Jul 2011 22:16:14 UTC; path=/';};
if (document.domain.indexOf(".weather.com")!=-1) {var actionLib=new Function();showExpPromoLink=new Function();paramValue=new Function();var hstname;_cm=new Function();var CM_page_id;var CM_cat_id;var CM_rmid;var CM_urs_id;var CM_where_search;var CM_partner;var CM_dma;var CM_country;var CM_state;var CM_topProdID;var CM_detailProdID;var CM_prodViewTag;var CM_shop5Tag;var CM_shop9Tag;};
if (document.domain.indexOf("aimoo.com")!=-1) { document.write('<style type="text/css"> div#img {display:none !important;} <\/style>');};
if (document.domain.indexOf("boingboing.net")!=-1) { document.write('<style type="text/css"> div#content {width:650px;background-color:#EEE;} <\/style>');};
if (document.domain.indexOf("cpcw.com")!=-1) { document.write('<style type="text/css"> div#sidebar, div#sidebar2, div#sidebar3, div#sidebar4, div#sidebar5, div#sidebar6 {display:none !important;} <\/style>');};
if (document.domain.indexOf("foodnetwork.com")!=-1) {AdManager=new Function('');initAdManager=new Function('');TacodaSetupCode=new Function('');SuperstitialAd=new Function('');FoodAd=new Function('');};
if (document.domain.indexOf("forums.cheatcc.com")!=-1) { document.write('<style type="text/css"> div.post {width:680px; !important;} <\/style>');};
if (document.domain.indexOf("forums.whirlpool.net.au")!=-1) { document.write('<iframe src="about:blank" name="ivote" id="ivote" width="1" height="1" style="display:none;"><\/iframe>');};
if (document.domain.indexOf("foxnews.com")!=-1) { document.write('<style type="text/css"> div#marketplace, div.quigo, div#bannertwins, div#sponsor_sidenav, div#sponsor_1, div.qui {display:none;} div#corrSpon, div#sponDuration {visibility:hidden;} <\/style>');var fnDomain='';var section_id=0;var subsection_id = "";var secTimeStamp='';var speed=440;prerollCall=new Function();loadSponsor=new Function();};
if (document.domain.indexOf("gamespy.com")!=-1) { document.write('<style type="text/css"> div.adbox {display:none;} <\/style>');};
if (document.domain.indexOf("highbeam.com")!=-1) { document.write('<style type="text/css"> div#Div1, td.sideCol {display:none;} <\/style>');};
if (document.domain.indexOf("intel.com")!=-1){var wa_intelCorpRS = 1;};
if (document.domain.indexOf("jubii.dk")!=-1) { document.write('<style type="text/css"> div.columns1 {display:none;} <\/style>');};
if (document.domain.indexOf("megaupload.com")!=-1) { document.write('<META HTTP-EQUIV="Set-Cookie" CONTENT="intermission=1; path=/">');};
if (document.domain.indexOf("msn.com")!=-1||document.domain.indexOf("ctv.ca")!=-1) { document.write('<style type="text/css"> td.adheader, div.ModAdDiv, table.ads {display:none;} <\/style>');};
if (document.domain.indexOf("nforce.nl")!=-1) { document.write('<style type="text/css"> td.right {display:none;} <\/style>');};
if (document.domain.indexOf("opel.de")!=-1){logclientdata=new Function();var civersion;var id;var server;var secureserver;var site;var hbx=new Object;};
if (document.domain.indexOf("supermp3.org")!=-1) { document.write('<style type="text/css"> table#AutoNumber1, table#AutoNumber2 {display:none;} <\/style>');};
if (document.domain.indexOf("theglobeandmail.com")!=-1) { document.write('<style type="text/css"> div.bigbox.ad, div.buttons.ad {display:none !important;} <\/style>');};
if (document.domain.indexOf("titantv.com")!=-1) { document.write('<META HTTP-EQUIV="Set-Cookie" CONTENT="fcsb=1; path=/">');};
if (document.domain.indexOf("torrentportal.com")!=-1) { document.write('<style type="text/css"> td [href*="/cbt.php?c="], iframe#sidead, iframe#etunes_if, iframe#fugly {display:none;}  div#sc1 {display:none !important;} <\/style>');};
if (document.domain.indexOf("tucows.com")!=-1) { document.write('<style type="text/css"> div#google-listing, div#pre-top, span.sponsor, div#pre-bottom {display:none !important;} div#header {height:105px !important;} div.ad300, div.ad120, div.ad160, div.ad728 {display:none;} <\/style>');};
if (document.domain.indexOf("westerncourier.com")!=-1) {document.cookie='HASREGISTEREDORLOGGEDIN=2613723; expires=Thu, 8 Jul 2021 22:25:01 UTC; path=/';};
if (document.domain.indexOf("zol.com.cn")!=-1) { document.write('<style type="text/css"> div.tltop, div.topad, div#TopLogoad, div#TopLogoad2, div.sadtop, div.sadtop1, div#scad, div.Ad130, div.tonglan, div.top_ad, div#Float1631, div#Float1700, div#Article_Top_Banner {display:none;} <\/style>');};
if (location.href.indexOf(".myspace.com/index.cfm")!=-1&&location.href.indexOf("=user.viewprofile")==-1&&location.href.indexOf("=blog.listAll")==-1&&location.href.indexOf("=blog.view")==-1){document.write('<style type="text/css"> body {background-image:none !important;} <\/style>');};
if (location.href.indexOf("/ad/banner/table.jsp?site=")!=-1||location.href.indexOf("/ad/banner/game.jsp?site=")!=-1||location.href.indexOf("/ad/liveness.jsp?site=")!=-1){self.close();};
if (location.href.indexOf("/avatar.asp?dist=")!=-1) {XywX__amscript_addonload("introJump();");};
if (location.href.indexOf("/common/intr.main")!=-1) {XywX__amscript_addonload("allowLink();seenAd();");};
if (location.href.indexOf("/game_player/index.jhtml")!=-1) {XywX__amscript_addonload("goplay();");};
if (location.href.indexOf("/native_nm.html")!=-1) {XywX__amscript_addonload("cnnPassToPlayer();");};
if (location.href.indexOf("/rewind/full_episodes/")!=-1){s=new Object;rewindSponsor="toy";omnitureCall=new Function();};
if (location.href.indexOf("/video/player/player.")!=-1){ document.write('<iframe src="about:blank" width="0" height="0" frameborder="0" id="playlist" name="playlist"><\/iframe>');};
if (location.href.indexOf("google.com/custom?")!=-1) { document.write('<style type="text/css"> div.ch {display:none !important;} <\/style>');};
if(document.domain.indexOf(".about.com")!=-1){document.write('<style type="text/css"> div#gB5 {display:none;} <\/style>');};
if(document.domain.indexOf(".adoption.com")!=-1){document.write('<style type="text/css"> div#topbanner, div#uac_ad_B, div#uac_ad_A, div#uac_ad_D {display:none;} div#left_side_wrapper {margin-top:-100px;} <\/style>');};
if(document.domain.indexOf(".aol.com")!=-1){document.write('<style type="text/css"> #sponsored, #shoppingLayer, div.SLL, div.TBARL, div.WOL {display:none;} <\/style>');};
if(document.domain.indexOf(".buscape.com")!=-1){document.write('<style type="text/css"> div#cel9, div#barra.ta2, div#ofer, div#ofer2, div#linha4.tg.mtable {display:none;} <\/style>');};
if(document.domain.indexOf(".cnn.com")!=-1){document.write('<style type="text/css"> div.cnn4pxPad, table#adBannerTable, div.CNN_homeAdBox, table#cnnRRad, table#cnnContextualLinks, div.cnnContextualLinksBox, div.cnnContextualLinksBoxHeader, div#moneyPromotionBox, ul.cnnResults {display:none;} div#cnnPipelineModBox {position:relative;margin-top:-320px;} <\/style>');};
if(document.domain.indexOf(".corriere.it")!=-1){document.write('<style type="text/css"> div#boxadv, div.adv, div#boxadv2 {display:none;} <\/style>');};
if(document.domain.indexOf(".economist.com")!=-1){document.write('<style type="text/css"> div.bottom-row, div.banner, div.content-banner-double, div#bannerspace-bottom, div.banner-left, div.banner-right, div#bannerspace-top, div.content-banner {display:none;} <\/style>');};
if(document.domain.indexOf(".edmunds.com")!=-1){document.write('<style type="text/css"> div#spotlight, div.right, div.adunit, div.spotlightArea, div#hd_marketplace {display:none;} <\/style>');};
if(document.domain.indexOf(".enet.com.cn")!=-1){document.write('<style type="text/css"> iframe#enettonglan, iframe#enettonglanunder, iframe#enettonglanlin, iframe#sky1, iframe#banner1, iframe#enetbannerlin, iframe#enetposter1, iframe#enetposter2, iframe#enetbutton, iframe#tonglan2, iframe#enettonglan2lin, iframe#tonglan3, iframe#tonglan4, iframe#oatonglan, iframe#oatonglannei, iframe#button220, iframe#eproductflashlin, iframe#flash1,  iframe#sky2, iframe#eprobulin, iframe#tonglan0, iframe#tonglan01, iframe#egametonglanunder, iframe#egamesky1, iframe#egamebanner, iframe#egamesky2, iframe#egametonglan02, iframe#egametonglan3, iframe#egametonglanlin, iframe#egametonglan120, iframe#egametonglandi, iframe#tonglan3, iframe#egameskynei, iframe#motherboardflash, iframe#shumabannerlin, iframe#xgwznew, iframe#tonglan1, iframe#eladybutton, iframe#eladytong2, iframe#eladytong3, iframe#mp3under, iframe#mp3sky480, iframe#mp3tonglan2 {display:none;} <\/style>');};
if(document.domain.indexOf(".gamespot.com")!=-1){document.write('<style type="text/css"> body {background:#000000 url("http://img.gamespot.com/gamespot/shared/gs5/themes/standard/bg.gif") repeat fixed top !important;} div#headband, div#glead {display:none;} <\/style>');};
if(document.domain.indexOf(".heise.de")!=-1){document.write('<style type="text/css"> div.contentbanner, div.bmc_content, table.kasten_markt, div.adbottom, div.heiseadvert, div.adbottom_itmarkt, div.skyscraper, div.leaderboard {display:none;} <\/style>');};
if(document.domain.indexOf(".icq.com")!=-1){document.write('<style type="text/css"> div.sp, div.res-txt-line, div.sp2 {display:none;} <\/style>');};
if(document.domain.indexOf(".imbuddy.net")!=-1){document.write('<style type="text/css"> body {margin-top:91px;background-color:#F2F2F2;} <\/style>');};
if(document.domain.indexOf(".imdb.com")!=-1){document.cookie='uu=; domain=imdb.com; expires=Thu, 8 Jul 2010 18:11:31 UTC; path=/';document.cookie='cs=;domain=imdb.com;expires=Thu, 8 Jul 2010 18:11:31 UTC; path=/';};
if(document.domain.indexOf(".marketwatch.com")!=-1){document.write('<style type="text/css"> div#ToolsResearchAdDiv, div.adModule, span#TradingCenter, div.advertisement {display:none;} <\/style>');};
if(document.domain.indexOf(".msn.com")!=-1||document.domain.indexOf(".msn.ca")!=-1){document.write('<style type="text/css"> .adbar, table.esmod, .adlink, div.esspnsr, .adsb, div#shoppinglayout, div#msnservice, div#rad_ad, div#ad300x250, div#shopping, div#msnservices, div.flashlinkedimg#NISPBCM3, div#ad2, div.adv#module9, div.adp, div#specialoffers {display:none;} <\/style>');};
if(document.domain.indexOf(".tv.com")!=-1&&location.href.indexOf("/photos/viewer.html?type=")==-1){document.write('<style type="text/css"> body {background:url("http://image.com.com/tv/images/tv2_layout/bg-blue.gif") center repeat-y #22304E !important;} <\/style>');};
if(document.domain.indexOf(".ugo.com")!=-1){document.write('<style type="text/css"> div#wrapper_banner, div.flow1, div#content_right_side_advertisement_on_top_wrapper, div#content_left_side_advertisement_on_bottom_wrapper, div#content_left_side_hubs_and_advertisement_element_advertisement_wrapper {display:none;} <\/style>');};
if(document.domain.indexOf(".yahoo.com")!=-1){document.write('<style type="text/css"> div#k.r, div.spon, div.yshp_ad_o_n, div.yshp_ad_o_e, div.sponsor, #sponsorlink, div#yspAdWrapper, div.tgl, div#ovt-no-border, div#pollObj, div#south-ad-wrapper, td.ymhnav.sbg a, iframe#SKY, div.spons, span#YSLUG, div#marketplace.md, div#adiv2, div#yschmktg, iframe.LREC, div#news-w1-ad, div.yad-mrec, div.ysm, div.adcn, div#yreAdCE1, div#yfiadfm, td.yfiadhdr, div.yfiad_body, table.yfiadmain_tll, div#yfiinshdrad, div#new_car_lrec, div.yatadsoembd, div.ysmsponsor, div#sponsored, div#state_farm_sky, div#insurance_spotlight, div.lrec, div.ov-east, div.tgl-block, div#ks-ypn-ads {display:none;} <\/style>');};
if(document.domain.indexOf("andhravilas.com")!=-1){document.write('<style type="text/css"> div#sideFrame, div#sideFrame1, div#sideFrame3 {display:none;} <\/style>');};
if(document.domain.indexOf("arstechnica.com")!=-1){document.write('<style type="text/css"> div.Ad {display:none;} <\/style>');};
if(document.domain.indexOf("dir.yahoo.com")!=-1){document.write('<style type="text/css"> div.ydirspns, div.ydireast, div#ydireast {display:none;}<\/style>');};
if(document.domain.indexOf("expressen.se")!=-1){document.write('<style type="text/css"> table[border="0"][cellspacing="0"][cellpadding="0"][width="120"][align="center"]  {display:none;} <\/style>');};
if(document.domain.indexOf("franksarcade.com")!=-1){document.cookie='credits=9; domain=franksarcade.com; expires=Thu, 8 Jul 2010 08:11:31 UTC; path=/';};
if(document.domain.indexOf("mail.yahoo.com")!=-1){document.write('<style type="text/css"> #leftnavad, #northbanner, #swads, div.advertisement, div#nwad {display:none;} div#nwPane, iframe#nwPane, iframe#swPane {visibility:hidden !important;height:0px !important;} <\/style>');};
if(document.domain.indexOf("msnbc.msn.com")!=-1||document.domain.indexOf(".msnbc.com")!=-1){document.write('<style type="text/css"> .adbar, div.textSmallgrey, td.textSmallGrey, div#DCol.DCol {display:none;} <\/style>');};
if(document.domain.indexOf("netz.ru")!=-1){document.write('<style type="text/css"> div.banner {display:none;} <\/style>');};
if(document.domain.indexOf("nhacso.net")!=-1){document.write('<style type="text/css"> div#floating_banner_left, div#floating_banner_right, div#rightBox {display:none;} <\/style>');};
if(document.domain.indexOf("switchboard.com")!=-1){document.write('<style type="text/css"> div#featuredsites, div.ad {display:none;} <\/style>');};
if(document.domain.indexOf("thesuperficial.com")!=-1){document.write('<style type="text/css"> body {background-image:none !important;} div.adheader, div.adentrybody {display:none;} <\/style>');};
if(document.domain.indexOf("washingtonpost.com")!=-1){var adTemplate;var show_doubleclick_ad;var AD_LINKS_RIGHT;var TEXTLINKS;var AD_LINKS_BOTTOM;var TOOLBOX_BOTTOM;var TOOLBOX_LEFT;var TILE_LEFT;document.write('<style type="text/css"> div.sponsorship, div#toolbox_ad_left, iframe#post_promo {display:none;} <\/style>');};
if(document.domain.indexOf('videodetective.com')!=-1){XywX__amscript_addonload("if(typeof(top.CreateCompanion)=='function'&&typeof(top.AdDone)=='function'){top.CreateCompanion=new Function();setTimeout('top.AdDone();',500);};");};
if(location.href.indexOf(".caranddriver.com")!=-1){document.write=new Function();};
if(location.href.indexOf("/adpopup.php?theGame=")!=-1){var XywX__amscript_PCG = new Array();XywX__amscript_PCG = location.search.split('=');var XywX__amscript_PCG2 = new Array();XywX__amscript_PCG2 = XywX__amscript_PCG[1].split('&');var XywX__amscript_PCGL = "http://" + unescape(location.hostname) + "/gamepopup.php?theGame=" + unescape(XywX__amscript_PCG2[0] + "&lcid=1033&alt_webgame=");window.location.replace(XywX__amscript_PCGL);};
if(location.href.indexOf("/break/IframeAds/")!=-1||location.href.indexOf("/videos_contentdetail.html")!=-1){window.location.replace("http://info.break.com/static/v2/mod/recommendedvideos/recommendedvideos.html");};
if(location.href.indexOf("/dart_inter.php?lcid=")!=-1){XywX__amscript_addonload("window.parent.endad('true');");};
if(location.href.indexOf("/dl.php?file=")!=-1||location.href.indexOf("/dl2.php?file=")!=-1){ document.write('<style type="text/css"> img, iframe {display:none !important;} <\/style>');};
if(location.href.indexOf("/play.html?episode=")!=-1||location.href.indexOf("/play_video.html?episode=")!=-1&&location.href.indexOf("&PreRoll_url=")==-1){var XywX__amscript_HTF = new Array();XywX__amscript_HTF = location.search.split('=');var XywX__amscript_HTFL = "http://" + unescape(location.hostname) + "/watch_episodes/flash/play_player.asp?episode=" + unescape(XywX__amscript_HTF[1]);window.location.replace(XywX__amscript_HTFL);};
if(location.href.indexOf("/popupworldmap.ws")!=-1){XywX__amscript_sWinSiz(548,660);};
if(location.href.indexOf("/preload.shtml?portal=")!=-1){XywX__amscript_addonload("if(typeof(checkTimeout)=='function'){secTotal=60;checkTimeout();};");};
if(location.href.indexOf("/shockscreen.asp?shost=")!=-1){XywX__amscript_addonload("flashTimerExpired();");};
if(location.href.indexOf("/trailers_player.php?")!=-1&&location.href.indexOf("=videolarge")==-1){XywX__amscript_addonload(function(){var a=document.body.getElementsByTagName('object');for(var i=0;i<a.length;i++){var b=a[i].getElementsByTagName('param');for(var x=0;x<b.length;x++){if(b[x].name=='FlashVars'){var result=new RegExp("downloadURL=([^&]*)","i").exec(b[x].value);if(result!=null){changeStatus("Your download is ready <u>now<\/u> thanks to Ad Muncher. <a href='"+result[1]+"'>Right-click here to save.<\/a>");}}}}});};
if(location.href.indexOf("/vidaveevid.php?zone=")!=-1&&location.href.indexOf("&ad=on")!=-1){var XywX__amscript_HTP = new Array();XywX__amscript_HTP = location.search.split('&');var XywX__amscript_HTPL = "http://" + unescape(location.hostname) + unescape(location.pathname) + unescape(XywX__amscript_HTP[0]) + "&" + unescape(XywX__amscript_HTP[1]) + "&autoStart=on&ad=off";window.location.replace(XywX__amscript_HTPL);};
if(location.href.indexOf("/watch_episodes/flash/play_")!=-1&&location.href.indexOf("&PreRoll_url=")!=-1){var XywX__amscript_HTF = new Array();XywX__amscript_HTF = location.search.split('&');var XywX__amscript_HTFL = "http://" + unescape(location.hostname) + unescape(location.pathname) + unescape(XywX__amscript_HTF[0]);window.location.replace(XywX__amscript_HTFL);};
if(location.href.indexOf("?fuseaction=ad.games")!=-1){window.location.replace("http://games.myspace.com/");};
if(location.href.indexOf("badongo.com/file")!=-1){XywX__amscript_rf('refresh','check_n < 1[^;]*','1){','i');};
if(location.href.indexOf("imdb.com/ad/preroll/")!=-1){XywX__amscript_addonload("var XywX__amscript_imdb1 = swfARGS[11];var XywX__amscript_imdb2 = new Array();XywX__amscript_imdb2 = XywX__amscript_imdb1.split('LY//');var XywX__amscript_imdb3 =  unescape(XywX__amscript_imdb2[1]);location.replace(XywX__amscript_imdb3);");};
if(location.href.indexOf("solvable.sdirect")!=-1&&location.href.indexOf("?interstitial=")==-1&&location.href.indexOf("&puzzleNumber=")!=-1){var XywX__amscript_BCW = "http://" + unescape(location.hostname) + unescape(location.pathname) + "?interstitial=0&" + unescape(location.search.substr(1).split());window.location.replace(XywX__amscript_BCW);};
if(location.href.indexOf('/upgrade.adp?ref=')!=-1){XywX__amscript_addonload("if(typeof(proceed)=='function'){setTimeout('proceed();',500);};");};
if(location.href.indexOf('?fuseaction=interstitial&')!=-1||location.href.indexOf('?fuseaction=ad&')!=-1){window.location.replace('http://home.myspace.com/index.cfm?fuseAction=user');};
metriwebTag=new Function();
nettracker_getUser=new Function();ntptEventTag=new Function();dummy=new Function();
pctTrack=new Function();
placeAd=new Function();
s=new Object();s.t=new Function('return "xyz"');
sa_flash=new Function();
showbanner=new Function();
spylog_tracker=new Function();
up_runPresence=new Function();
var Ads_skid;
var XywX__amscript_fslist=new Array("ohshare.com","quicksharing.com");for(var XywX__amscript_fs=0;XywX__amscript_fs<XywX__amscript_fslist.length;XywX__amscript_fs++)if(document.domain.indexOf(XywX__amscript_fslist[XywX__amscript_fs])!=-1){document.write('<style type="text/css"> span.normal_text a, font a {position:absolute;z-index:1;} <\/style>');};
var XywX__amscript_thwlist=new Array(".geardigest.com",".smallnetbuilder.com",".tgdaily.com",".thgweb.de",".tomshardware.com",".twitchguru.com");for(var XywX__amscript_fs=0;XywX__amscript_fs<XywX__amscript_thwlist.length;XywX__amscript_fs++)if(document.domain.indexOf(XywX__amscript_thwlist[XywX__amscript_fs])!=-1){document.write('<style type="text/css"> div.ad, div.footer, div.keyword, div.mlink_right, div.thg_banner, div#newEgg, div.sponsored_link, div.spiffy, div#weeklyDotz, div#cat_600, div#pro_336, table#merchant_link, table#product_finder, div#netline_special, div.sponsored_links_article, div#cb_table_wide_main, div#cb_table_main {display:none;} <\/style>');};
var _hbDownload=new Function();var _hbSet=new Function();var _hbSend=new Function();var _hbPageView=new Function();var _hbM=new Function();var _hbLink=new Function();hbx=new Object;
var aLOBads = 1;
var countGridView = new Function();
var dap=new Function();
var dedicatedPrerollURL='';XywX__amscript_addonload("if(typeof(doplay)=='function'&&typeof(playMovie)=='function')doplay();");
var google_random = 1; var GoogleAds = 1; var google_ads = 1;
var mediaAds={obj:'settings'};
var renderSpecialOfferBox = new Function();
var rmShowPop=new Function();var rmShowAd=new Function();
var rnd=new Date().getTime();
var rx=/.*&thankyou_url=([^&]*).*/;if(location.href.search(rx)!=-1)location.replace(unescape(location.href.replace(rx,"$1")));
var shouldTrackOmniture=false;var shouldTrackAvenueA=false;var s_account="XywX__amscript_none";s_ca=new Function('');sendAnalyticsEvent=new Function('');var s_gi=new Function("var s=new Object();s.tl=new Function();return s;");var s_dc=new Function();
var showBan = new Function();var showBanRoll = new Function();
var showPopBehind = new Function();
var xt_med = new Function();
verzoegerung = new Function("window.location.replace('/scripts/wgate/zcop_b2c/?~template=pcat_area_s_browse&glb_user_js=y&shop=b2c&p_init_ipc=x&~cookies=1');");
wad_word_over=new Function();wad_word_out=new Function();
};
// End Ad Muncher helper script
// ]]>
</script>
<style type="text/css"><!--
/* CSS added by Ad Muncher */
#mwpDrop {display:none !important;}
#sp2overlay {display:none;}
.bannerBorder, table.hotcouponside, table.hotcouponside2, table.offTopicBox {display:none;}
.hotlink2 {border-bottom-width:medium;border-bottom-style:none;} table.dmnmarketplace, table.ashopguidetitle, table.shopguidetable, table.htdiv {display:none;}
.ishoppertext {display:none !important;}
.network.sponsors {display:none;}
.wad_word {border-bottom-width:medium;border-bottom-style:none;color:black;} .wad_word:hover {color:black;}
a.adText, a.adHeadline {display:none;}
a.oldl2 {display:none !important;}
center#topad {display:none;}
div#Ad160x120, div#Ad160x600, div#AdSponsoredLinks, div#innerFloaterAd, div#Ad160x160, div#adAtTop, div#ad160x600, div#ad160x160, div#banner160x600, div#banner160x160, div#bannerSponsoredLinks {display:none;} div#AdLeaderboard {visibility:hidden;}
div#AdTopDiv, div#AdDiv, div#AdBGDiv, div#AdChatDiv, div#AdIntermissionDiv {display:none !important;}
div#CMR1C2Box, div#CMR2C2Column {display:none;}
div#HBpromo3 {display:none !important;}
div#IZKflashDalaiDiv {margin-top:-45px !important;}
div#LayerFloatingBn_special, div#ti_banner, div#LayerFloatingBn, div#LayerFloatingBn1 {display:none;}
div#NMI_pop {display:none !important;}
div#NispOffersBB {display:none;}
div#SponsoredLinks_Right {display:none;}
div#ad-blocking-makes-fella-sad {display:none;}
div#ad-side, div#ad-lb {display:none !important;}
div#ad-wrap, #leaderboardRegion {display:none;}
div#ad300x250box, div.advertisementLabel {display:none;}
div#ad728x90, div#ad300x600, div#adNoticeRight {display:none;}
div#adBoxPopup {visibility:hidden;} div#download_waiter {visibility:hidden;margin-bottom:0px !important;}
div#ad_content, div.Banner200 {display:none;}
div#ad_word1, div#ad_770 {display:none;}
div#adbriteimg {display:none !important;}
div#adheader {display:none !important;}
div#ads_topC, div#ads_bottomC, div#ads_rightC {display:none;}
div#advertiserLinks, div#adxCircBottom, td#advertiserLinkImg, div#adxToolSponsor, div#adxLeaderboard, div#searchSponsor, div#adxBigAd, div.advertisementColumnGroup, div#adxMiddle5, div#nytStoreBox, div.blog_adBox, div.travelDeal, div.cColumn-TextAdsBox, div#realEstateAds, div.advertisement {display:none;}
div#advertising_img {display:none !important;}
div#advertisingcolumn {display:none;}
div#advertpopup {display:none !important;}
div#annonserad, div#adnettboard, div#quicklinks, div.dinepengerboks {display:none;}
div#appdiv {visibility:visible !important;}
div#bandasuperiorpublicidad, div#publi728x90, div.publi300x250 {display:none;}
div#banner-sup {display:none;}
div#bannerTop, div.googleBlock {display:none;}
div#banner_src, div#sky1 {display:none;}
div#bannerbar {display:none;}
div#bannerpnt {display:none;}
div#bdfs1, div#bdfs2, div#bdfs3 {display:none !important;}
div#bgwrapper {background-image:none !important;}
div#bottomad {display:none;}
div#bwMall {display:none;}
div#chinazads {display:none !important;}
div#col_b_us, div.top_ads {display:none;}
div#couplet_right, div#couplet_left, div#couplet {display:none !important;}
div#crestAds {visibility:hidden;margin-bottom:-50px;} div#adPaneRight {visibility:hidden;width:0px;} table.hpadstable, div#AdContainer {display:none;}
div#currency, div#pricingBox {display:none;}
div#divBannerWindow, div#divAdPlayer {display:none;}
div#divMaster {display:none;}
div#divStayTopLeft {visibility:hidden;}
div#divTopAd, div#divLeftAd, div#divBotAd {display:none;}
div#dropin, div#dropinboxv2cover {display:none !important;}
div#ejs_slide_box {display:none;}
div#elementDiv {display:none !important;}
div#flasHheaderContent {display:none;}
div#flash2, div#flash123 {display:block !important;}
div#floatingbanner, div#FloatingLayer {display:none !important;}
div#floatingbox, div.AdBriteAdBox, div#bottomadd {display:none;}
div#fromSponsors {display:none;}
div#from_our_sponsors, div.box_ad, div#skyscraper.adv {display:none;}
div#globalNavHolder {margin-top:-90px;}
div#hestesko .left, div#hestesko .right, div#hestesko .top {display:none;}
div#huashuolayer2, div#huashuolayer3, div#myleft, div#dangdang, div#netease4, div#myright {display:none !important;}
div#ibwidebox, table#amazon_side {display:none;}
div#introportion, div#upperad {display:none !important;}
div#invuediv {display:none !important;}
div#layer_top {display:none;}
div#layersexo, div#peSponsors6, div#peSponsor7 {display:none;}
div#leaderboard, a.PartCenter {display:none;}
div#leaderboardAd, div.spOffersDiv {display:none;}
div#leftAd, div#topAd {visibility:hidden;}
div#left_173FlyAdv, div#right_173FlyAdv, div#left_173DobAdv, div#right_173DobAdv {display:none;}
div#lexico-box, div.endofpagead {display:none;}
div#lovexin1, div#lovexin2 {display:none;}
div#mouselayer {display:none;}
div#mpuHolder, div#mpuholder {display:none;}
div#mrrobapaginas {display:none;}
div#msbanner, td.footer_br {display:none;}
div#nav2Holder {position:relative;margin-top:-90px !important;}
div#nbcSponsorAd, div#smallAd {visibility:hidden;}
div#noticiasPubli, div.patrocinados, ul.enlacesPatrocinados2, table#tPublicityLinks2, table#tPublicityLinks1 {display:none;} div#servicios  {display:none !important;}
div#notregistered, div#searchboxes, tr.textads_row {display:none;}
div#overtureA, div#overtureB, div#overture {display:none;}
div#pcentre, div.aisleAd, div#sponsoredLinks {display:none;} #leaddiv {background-image:none !important;}
div#peellayers {display:none !important;}
div#popDiv {display:none;}
div#popupwin {display:none !important;}
div#postit {display:none !important;}
div#rec-downloads, div.rec-down-featured, div.rec-left, div.rec-right, div#search-ads {display:none;}
div#reisesok-topp {display:none;}
div#reskin-1, div#reskin-2 {display:none !important;}
div#rm1 {display:none;}
div#searchspe, div#searchspe2 {display:none !important;}
div#sidebar_image, div#sidebar2_image, div#bottom_ad_modelimage, span.sponsor_text, div.sponsor_message {display:none;}
div#slideCode {display:none;}
div#sponsorAdDiv, div#sponsorAdDiv2 {display:none;}
div#sponsorLinks, div#sponsorl {display:none !important;}
div#sponsored div#sidebar {display:none;}
div#sponsored_links, div#quigo {display:none;} div#promocolumn {visibility:hidden;}
div#sponsoredlinks, div.sponsoredLinks, div#SponsoredLinks {display:none;}
div#sponsors, div#av-tout {display:none;}
div#storyAd, div#leftAdCol {display:none;}
div#sunshine_top, div#merchfooter, table#topAdTable {display:none;}
div#swf_supertab_2, div.imdb_lb {display:none;}
div#textAdsWrapper, table.advertbox {display:none;}
div#text_ad_1, div#text_ad_2, div#text_ad_3, div#htext_ad {display:none;}
div#thelayer, div#ad_banner_top {display:none;}
div#threenine, div#threenine1 {display:none !important;}
div#tickerad, div#topp {display:none;}
div#toolMissed {width:300px;}
div#topAdContainer, div.ad_label_horz, div#content_box_300body_adsspecialoffers, div.content_box_sponsoredoffer, div#ad_728_foot {display:none;}
div#topjobs {display:none !important;}
div#topp-ad, div.ad860x85, div.ad768-topp, div.ad180-topp, div.ad280x60, div.ad468-2, div.ad180x500a, div.ad335, div.ad860x448 {display:none !important;}
div#topsponsors.sponsors {display:none !important;}
div#tower_div {visibility:hidden;}
div#ultimas {display:none !important;}
div#v_banner, div#v_tracker {display:none !important;}
div#waitblock {visibility:hidden;margin-bottom:-20px;} div#linkblock {display:block !important;}
div#watermarklogo {display:none !important;}
div#webIM_Flash {display:none;}
div#wrapper_3827 {display:none;}
div#yatad_ovt {display:none !important;}
div#yfirhaus, div.augl-flash-container {display:none;}
div#yh-ovt, div#west.ovt, div#east.ovt {display:none !important;}
div.AB_adArea {height:0px !important;}
div.ExternalShoppingControl {display:none;}
div.OAS.Right {display:none;} div.Right {display:block;}
div.SL_zone {display:none;}
div.TextAd, table#AdTable {display:none;}
div.ad1_container, div.ad3_container, div.ad2, div.blogads {display:none;}
div.ad728x90, div.boxMidRt3#ad, div#adhead, div.boxbody#ad {display:none;}
div.adMPU.leaveMeAlone {display:none !important;}
div.adMsg, div.ad728, div.textlink, div.ad468 {display:none;}
div.ad_sponsored_links_box {display:none;}
div.adboxes, div#nowads {display:none;}
div.additionalResources, div.sponsored_links {display:none !important;}
div.adlinks_box {display:none;}
div.ads.topads, div#bottom_ad {display:none;}
div.ads_leaderboard, div.ads_mpu {display:none;}
div.adv1 {display:none;}
div.advert300, div#homeadvert300, iframe#ifr_adSky, iframe#ifr_adBox, iframe#ifr_adSponsor, div.sponsoredResults {display:none;}
div.apiAd {display:none;}
div.articleEmbeddedAdBox {display:none;}
div.asl_margin, div#btm_btn_ad, div.rr_prem_shell, div.circ_wrap, div.htb, div.rr_ldr, div#sh_shop, div.rr_po_compete_hd, div.rr_po_about_link, div.rr_mid_main, div.ad_itext_bar, div#spons_links, div.ad_text_top, div.ad_ed_cfeature, td#bidwar, div#bidwar, div#specialDeals, div#shr_speco, div.tc-vendor-wrapper {display:none;}
div.attachment-ads {display:none;}
div.baner_l {display:none;}
div.blockAds, table#adsBox, div.shop#shop1, div#shuol.mod {display:none;}
div.body_ad {display:none;}
div.ch#tpa1, div.ch#tpa2, div.ch#tpa3, div.ch#tba1, div.ch#tba2, div.ch#tba3, div.bottomads {display:none;}
div.clwin {display:none;}
div.commercematch, div.commercenonmatch {display:none !important;}
div.content-tab-slinks, div.content-block-slinks, p.story-cip {display:none;}
div.embedSpn, div.bucketG {display:none;} div.dynamicbucket.epromo {display:none !important;}
div.espotting {display:none !important;}
div.float-side-div {display:none;}
div.gsp, div.T16, div.m10_0_8_0 {display:none;}
div.guaranteedTopSpot {display:none !important;}
div.header-advert, div.advert-article-box-hw, div.advert-article-box-news, div.advert-article-box-mod, div.advert-article-box-col, div.advert-article-box-game, div.advert-article-box-index {display:none;}
div.headlineAffiliates {display:none !important;}
div.hotspot, div#blog_spbg, table.ss_head, table.ss_body, div#powerPlayShell, div.dl-cdr-bd-ad, div#dotd, div#highImpactBox_v2, div#mcafee_promo, div#vs_promo_sponsor, div#hotspotwrap, div#powerPromo {display:none;}
div.leaderboardAd, div.buttonad2x1Ad, div.towerAd, div.adMkt2Colg, div.adMkt2Colw, div.printHide, div.halfpageAd, div.showcaseAd, div.divSrchSponsored, tr.sponsored, tr.sponsoredShade {display:none;}
div.left-banner, div#top-banner, div.right-banner, div.center-banner, div.opis, div#bottom-banner {display:none;}
div.macad, div#hs-cont, div#sl-cont, div#pctbg, table#dirmtable, ul#dirm {display:none;}
div.moduleDiv#moduleAV {visibility:visible !important;}
div.quadad, table.halfad {display:none !important;}
div.reiter_markt, table.textblock_markt, div.reiter_downloads, table.textblock_downloads, div#tb_html {display:none;}
div.reklama {display:none;}
div.sponsRes {display:none !important;}
div.sponsorbox, div.navrailadbox, div.cubeadbox, div.adrailbox {display:none;}
div.sponsored-links, div.textads-inline {display:none;}
div.sponsorsborder {display:none;}
div.story-advertisement {display:none;}
div.subcolumncomponent, div.top-ad-space {display:none;}
div.teaser.advertisement {display:none !important;}
div.thead1, div.thead2, div.thead3, div.thead4 {display:none;}
div.threeColRightContentAd {display:none !important;}
div.top_sponsored, div.bottom_sponsored {display:none;}
div.user_ads {visibility:hidden;} div.box_advert, div#sidebar_advert {display:none;}
div.visionSeriesPaintBox, div.advertIntelQuad, div.featuredJobs {display:none;}
div.werbetextlinks {display:none;}
iframe#PogoAdIframe {display:none;} iframe#PogoHeaderIframe {height:144px;}
iframe#ad_adTall {display:none;}
iframe#advert_frame {display:none !important;} div#buy-it.commerce {display:none;}
iframe#alertsPromo {display:none !important;}
iframe#bannerFrame {visibility:hidden;} div#bannerDiv {display:none;}
iframe#dclk999 {display:none;}
iframe#iFrameBanner {display:none;}
iframe#topbarAdPos1, iframe#sidebarAd, iframe#home_flash_pos75, div#topBarAdCall, div.adblock {display:none;}
iframe#trhs {display:none;}
input#downloadbtn {display:none !important;} span#downloadfile {display:block !important;}
li#tabT_topSellerSelection_vsel, div#tabC_topSellerSelection_vsel {display:none;}
ol.sponsored {display:none !important;}
p.bstext {display:none !important;}
span#nowads, div#followDiv1, div#followDiv2, div#aspsky {display:none !important;}
span.marketplaceHeads {display:none;}
table#BannerTbl, table#BannerTblHelp {display:none !important;}
table#ad_leaderboard {display:none;}
table#bannercontainer {display:none;}
table#googleadsa {display:none !important;}
table#mxsJDP, table#mxsJDPTopRight, table#mxsJDPSubDet {display:none !important;}
table#poplayer, div#dwindow, div#fadeinbox, div#point1 {display:none !important;}
table#rmenu_ad {display:none;}
table#specials {display:none;}
table#sponsoredLinksRight, div.tspons, div#sbspons, div#wrapthisad {display:none;}
table#zdSliderTableElement {display:none;}
table.adbig {display:none;}
table.asdasd {display:none;}
table.etalage {display:none;}
table.poweredTable {display:none;}
table.shopping_geral {display:none;}
table.sponsored-links-tbl {display:none;}
table.sponsoredLinksMain, span.sponsoredLinkTitle, .sponsoredLinkSmall, div.sponsoredLinkItemTD, table#sponsoredLinksWide {display:none;}
table.sponsoredlinks {display:none !important;}
table.webSearch {display:none !important;}
td img[width="23"][height="100"], td img[width="12"][height="100"] {display:none;}
td#Soft_top_770_60, td#soft_300_300 {display:none;}
td#TowerAdSpace {display:none !important;}
td#ad728x15-1, div#ad728x90-top, span.inlineAd, div#ad728x90-btm {display:none;}
td#ad_wrap, div.lead_ad, div.dubl_ad_300x250, div.sing_plus_ad160x600, div.ad160x600, div.ad300x250 {display:none;}
td#headerHtbltd2 {display:none;}
td#sky, div#subad, div#ymadbn, table#shp, div.marketplace, div#d2, div#popupdiv, span#SkyScrpr, div#horizads, div#ygrp-sponsor-box, div#ygrp-sponsored-links, ul.sr_sponsered, div#VisitorOverlayAd, div#sponseredlinks, table.ysptblbdr3 {display:none;}
td#tdRightAdvertColumn {display:none;}
td.AdColumn, div.AdSpot, div#AdBlock {display:none;}
td.SearchSponsorBG {display:none;}
td.adtext {display:none;}
td.google_ads {display:none !important;}
td.inGridAd, div.ccTopAdContainer, div#ad_270, iframe#TvgoIFrameStore, div#adRotator, div#lw_ad_270, iframe#TvgoIFramePromo {display:none;}
td.leftadhead, table.leftadbody, div#bottomAds, table[id="full"] tr[class="vaT"] td[class="taC"] {display:none;}
td.tbcj {display:none;}
td.yschsec {display:none !important;}
tr.cshopbg, td.cshoptxt2, td.cshoptxt1 {display:none;}
ul#xtextads1, ul#xtextads2 {display:none;}
ul.sponsored {display:none;}
--></style>



<script type="text/javascript">
//<![CDATA[
var version = {major: 2, minor: 1, revision: 3, date: new Date("Nov 3, 2006"), extensions: {}};
//]]>
</script>
<!--
TiddlyWiki 2.1.3 by Jeremy Ruston, (jeremy [at] osmosoft [dot] com)

Copyright (c) Osmosoft Limited 2004-2006

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright notice, this
list of conditions and the following disclaimer in the documentation and/or other
materials provided with the distribution.

Neither the name of the Osmosoft Limited nor the names of its contributors may be
used to endorse or promote products derived from this software without specific
prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.
-->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<!--PRE-HEAD-START-->
<!--{{{-->
<link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml'/>
<!--}}}-->
<!--PRE-HEAD-END-->
<title> Zolag - -FAQ </title>
<script type="text/javascript">
//<![CDATA[
// ---------------------------------------------------------------------------------
// Configuration repository
// ---------------------------------------------------------------------------------

// Miscellaneous options
var config = {
	numRssItems: 20, // Number of items in the RSS feed
	animFast: 0.12, // Speed for animations (lower == slower)
	animSlow: 0.01, // Speed for EasterEgg animations
	cascadeFast: 20, // Speed for cascade animations (higher == slower)
	cascadeSlow: 60, // Speed for EasterEgg cascade animations
	cascadeDepth: 5, // Depth of cascade animation
	displayStartupTime: false // Whether to display startup time
	};

// Messages
config.messages = {
	messageClose: {},
	dates: {}
};

// Options that can be set in the options panel and/or cookies
config.options = {
	chkRegExpSearch: false,
	chkCaseSensitiveSearch: false,
	chkAnimate: true,
	chkSaveBackups: true,
	chkAutoSave: false,
	chkGenerateAnRssFeed: false,
	chkSaveEmptyTemplate: false,
	chkOpenInNewWindow: true,
	chkToggleLinks: false,
	chkHttpReadOnly: true,
	chkForceMinorUpdate: false,
	chkConfirmDelete: true,
	chkInsertTabs: false,
	txtBackupFolder: "",
	txtMainTab: "tabTimeline",
	txtMoreTab: "moreTabAll",
	txtMaxEditRows: "30"
	};
	
// List of notification functions to be called when certain tiddlers are changed or deleted
config.notifyTiddlers = [
	{name: "StyleSheetLayout", notify: refreshStyles},
	{name: "StyleSheetColors", notify: refreshStyles},
	{name: "StyleSheet", notify: refreshStyles},
	{name: "StyleSheetPrint", notify: refreshStyles},
	{name: "PageTemplate", notify: refreshPageTemplate},
	{name: "SiteTitle", notify: refreshPageTitle},
	{name: "SiteSubtitle", notify: refreshPageTitle},
	{name: "ColorPalette", notify: refreshColorPalette},
	{name: null, notify: refreshDisplay}
	];

// Default tiddler templates
var DEFAULT_VIEW_TEMPLATE = 1;
var DEFAULT_EDIT_TEMPLATE = 2;
config.tiddlerTemplates = {
	1: "ViewTemplate",
	2: "EditTemplate"
	};

// More messages (rather a legacy layout that shouldn't really be like this)
config.views = {
	wikified: {
		tag: {}
		},
	editor: {
		tagChooser: {}
		}
	};

// Macros; each has a 'handler' member that is inserted later
config.macros = {
	today: {},
	version: {},
	search: {sizeTextbox: 15},
	tiddler: {},
	tag: {},
	tags: {},
	tagging: {},
	timeline: {},
	allTags: {},
	list: {
		all: {},
		missing: {},
		orphans: {},
		shadowed: {}
		},
	closeAll: {},
	permaview: {},
	saveChanges: {},
	slider: {},
	option: {},
	newTiddler: {},
	newJournal: {},
	sparkline: {},
	tabs: {},
	gradient: {},
	message: {},
	view: {},
	edit: {},
	tagChooser: {},
	toolbar: {},
	br: {},
	plugins: {},
	refreshDisplay: {},
	importTiddlers: {}
	};

// Commands supported by the toolbar macro
config.commands = {
	closeTiddler: {},
	closeOthers: {},
	editTiddler: {},
	saveTiddler: {hideReadOnly: true},
	cancelTiddler: {},
	deleteTiddler: {hideReadOnly: true},
	permalink: {},
	references: {},
	jump: {}
	};

// Browser detection... In a very few places, there's nothing else for it but to
// know what browser we're using.
config.userAgent = navigator.userAgent.toLowerCase();
config.browser = {
	isIE: config.userAgent.indexOf("msie") != -1 && config.userAgent.indexOf("opera") == -1,
	ieVersion: /MSIE (\d.\d)/i.exec(config.userAgent), // config.browser.ieVersion[1], if it exists, will be the IE version string, eg "6.0"
	isSafari: config.userAgent.indexOf("applewebkit") != -1,
	isBadSafari: !((new RegExp("[\u0150\u0170]","g")).test("\u0150")),
	firefoxDate: /Gecko\/(\d{8})/i.exec(config.userAgent), // config.browser.firefoxDate[1], if it exists, will be Firefox release date as "YYYYMMDD"
	isOpera: config.userAgent.indexOf("opera") != -1,
	isLinux: config.userAgent.indexOf("linux") != -1,
	isUnix: config.userAgent.indexOf("x11") != -1,
	isMac: config.userAgent.indexOf("mac") != -1,
	isWindows: config.userAgent.indexOf("win") != -1
	};

// Basic regular expressions
config.textPrimitives = {
	upperLetter: "[A-Z\u00c0-\u00de\u0150\u0170]",
	lowerLetter: "[a-z0-9_\\-\u00df-\u00ff\u0151\u0171]",
	anyLetter:   "[A-Za-z0-9_\\-\u00c0-\u00de\u00df-\u00ff\u0150\u0170\u0151\u0171]",
	anyLetterStrict: "[A-Za-z0-9\u00c0-\u00de\u00df-\u00ff\u0150\u0170\u0151\u0171]"
	};
if(config.browser.isBadSafari)
	config.textPrimitives = {
		upperLetter: "[A-Z\u00c0-\u00de]",
		lowerLetter: "[a-z0-9_\\-\u00df-\u00ff]",
		anyLetter:   "[A-Za-z0-9_\\-\u00c0-\u00de\u00df-\u00ff]",
		anyLetterStrict: "[A-Za-z0-9\u00c0-\u00de\u00df-\u00ff]"
		}
config.textPrimitives.sliceSeparator = "::";
config.textPrimitives.urlPattern = "[a-z]{3,8}:[^\\s:'\"][^\\s'\"]*(?:/|\\b)";
config.textPrimitives.unWikiLink = "~";
config.textPrimitives.wikiLink = "(?:(?:" + config.textPrimitives.upperLetter + "+" +
												config.textPrimitives.lowerLetter + "+" +
												config.textPrimitives.upperLetter +
												config.textPrimitives.anyLetter + "*)|(?:" +
												config.textPrimitives.upperLetter + "{2,}" +
												config.textPrimitives.lowerLetter + "+))";

config.textPrimitives.cssLookahead = "(?:(" + config.textPrimitives.anyLetter + "+)\\(([^\\)\\|\\n]+)(?:\\):))|(?:(" + config.textPrimitives.anyLetter + "+):([^;\\|\\n]+);)";
config.textPrimitives.cssLookaheadRegExp = new RegExp(config.textPrimitives.cssLookahead,"mg");

config.textPrimitives.brackettedLink = "\\[\\[([^\\]]+)\\]\\]";
config.textPrimitives.titledBrackettedLink = "\\[\\[([^\\[\\]\\|]+)\\|([^\\[\\]\\|]+)\\]\\]";
config.textPrimitives.tiddlerForcedLinkRegExp = new RegExp("(?:" + config.textPrimitives.titledBrackettedLink + ")|(?:" +
	config.textPrimitives.brackettedLink + ")|(?:" + 
	config.textPrimitives.urlPattern + ")","mg");
config.textPrimitives.tiddlerAnyLinkRegExp = new RegExp("("+ config.textPrimitives.wikiLink + ")|(?:" +
	config.textPrimitives.titledBrackettedLink + ")|(?:" +
	config.textPrimitives.brackettedLink + ")|(?:" +
	config.textPrimitives.urlPattern + ")","mg");

// ---------------------------------------------------------------------------------
// Shadow tiddlers
// ---------------------------------------------------------------------------------

config.shadowTiddlers = {
	ColorPalette: "Background: #fff\n" + 
				  "Foreground: #000\n" +
				  "PrimaryPale: #8cf\n" +
				  "PrimaryLight: #18f\n" +
				  "PrimaryMid: #04b\n" +
				  "PrimaryDark: #014\n" +
				  "SecondaryPale: #ffc\n" +
				  "SecondaryLight: #fe8\n" +
				  "SecondaryMid: #db4\n" +
				  "SecondaryDark: #841\n" +
				  "TertiaryPale: #eee\n" +
				  "TertiaryLight: #ccc\n" +
				  "TertiaryMid: #999\n" +
				  "TertiaryDark: #666\n" +
				  "Error: #f88\n",
	StyleSheet: "",
	StyleSheetColors: "/*{{{*/\nbody {\n	background: [[ColorPalette::Background]];\n	color: [[ColorPalette::Foreground]];\n}\n\na{\n	color: [[ColorPalette::PrimaryMid]];\n}\n\na:hover{\n	background: [[ColorPalette::PrimaryMid]];\n	color: [[ColorPalette::Background]];\n}\n\na img{\n	border: 0;\n}\n\nh1,h2,h3,h4,h5 {\n	color: [[ColorPalette::SecondaryDark]];\n	background: [[ColorPalette::PrimaryPale]];\n}\n\n.button {\n	color: [[ColorPalette::PrimaryDark]];\n	border: 1px solid [[ColorPalette::Background]];\n}\n\n.button:hover {\n	color: [[ColorPalette::PrimaryDark]];\n	background: [[ColorPalette::SecondaryLight]];\n	border-color: [[ColorPalette::SecondaryMid]];\n}\n\n.button:active {\n	color: [[ColorPalette::Background]];\n	background: [[ColorPalette::SecondaryMid]];\n	border: 1px solid [[ColorPalette::SecondaryDark]];\n}\n\n.header {\n	background: [[ColorPalette::PrimaryMid]];\n}\n\n.headerShadow {\n	color: [[ColorPalette::Foreground]];\n}\n\n.headerShadow a {\n	font-weight: normal;\n	color: [[ColorPalette::Foreground]];\n}\n\n.headerForeground {\n	color: [[ColorPalette::Background]];\n}\n\n.headerForeground a {\n	font-weight: normal;\n	color: [[ColorPalette::PrimaryPale]];\n}\n\n.tabSelected{\n	color: [[ColorPalette::PrimaryDark]];\n	background: [[ColorPalette::TertiaryPale]];\n	border-left: 1px solid [[ColorPalette::TertiaryLight]];\n	border-top: 1px solid [[ColorPalette::TertiaryLight]];\n	border-right: 1px solid [[ColorPalette::TertiaryLight]];\n}\n\n.tabUnselected {\n	color: [[ColorPalette::Background]];\n	background: [[ColorPalette::TertiaryMid]];\n}\n\n.tabContents {\n	color: [[ColorPalette::PrimaryDark]];\n	background: [[ColorPalette::TertiaryPale]];\n	border: 1px solid [[ColorPalette::TertiaryLight]];\n}\n\n.tabContents .button {\n	 border: 0;}\n\n#sidebar {\n}\n\n#sidebarOptions input {\n	border: 1px solid [[ColorPalette::PrimaryMid]];\n}\n\n#sidebarOptions .sliderPanel {\n	background: [[ColorPalette::PrimaryPale]];\n}\n\n#sidebarOptions .sliderPanel a {\n	border: none;\n	color: [[ColorPalette::PrimaryMid]];\n}\n\n#sidebarOptions .sliderPanel a:hover {\n	color: [[ColorPalette::Background]];\n	background: [[ColorPalette::PrimaryMid]];\n}\n\n#sidebarOptions .sliderPanel a:active {\n	color: [[ColorPalette::PrimaryMid]];\n	background: [[ColorPalette::Background]];\n}\n\n.wizard {\n	background: [[ColorPalette::SecondaryLight]];\n	border-top: 1px solid [[ColorPalette::SecondaryMid]];\n	border-left: 1px solid [[ColorPalette::SecondaryMid]];\n}\n\n.wizard h1 {\n	color: [[ColorPalette::SecondaryDark]];\n}\n\n.wizard h2 {\n	color: [[ColorPalette::Foreground]];\n}\n\n.wizardStep {\n	background: [[ColorPalette::Background]];\n	border-top: 1px solid [[ColorPalette::SecondaryMid]];\n	border-bottom: 1px solid [[ColorPalette::SecondaryMid]];\n	border-left: 1px solid [[ColorPalette::SecondaryMid]];\n}\n\n.wizard .button {\n	color: [[ColorPalette::Background]];\n	background: [[ColorPalette::PrimaryMid]];\n	border-top: 1px solid [[ColorPalette::PrimaryLight]];\n	border-right: 1px solid [[ColorPalette::PrimaryDark]];\n	border-bottom: 1px solid [[ColorPalette::PrimaryDark]];\n	border-left: 1px solid [[ColorPalette::PrimaryLight]];\n}\n\n.wizard .button:hover {\n	color: [[ColorPalette::PrimaryLight]];\n	background: [[ColorPalette::PrimaryDark]];\n	border-color: [[ColorPalette::PrimaryLight]];\n}\n\n.wizard .button:active {\n	color: [[ColorPalette::Background]];\n	background: [[ColorPalette::PrimaryMid]];\n	border-top: 1px solid [[ColorPalette::PrimaryLight]];\n	border-right: 1px solid [[ColorPalette::PrimaryDark]];\n	border-bottom: 1px solid [[ColorPalette::PrimaryDark]];\n	border-left: 1px solid [[ColorPalette::PrimaryLight]];\n}\n\n#messageArea {\n	border: 1px solid [[ColorPalette::SecondaryDark]];\n	background: [[ColorPalette::SecondaryMid]];\n	color: [[ColorPalette::PrimaryDark]];\n}\n\n#messageArea .button {\n	padding: 0.2em 0.2em 0.2em 0.2em;\n	color: [[ColorPalette::PrimaryDark]];\n	background: [[ColorPalette::Background]];\n}\n\n.popup {\n	background: [[ColorPalette::PrimaryLight]];\n	border: 1px solid [[ColorPalette::PrimaryMid]];\n}\n\n.popup hr {\n	color: [[ColorPalette::PrimaryDark]];\n	background: [[ColorPalette::PrimaryDark]];\n	border-bottom: 1px;\n}\n\n.listBreak div{\n	border-bottom: 1px solid [[ColorPalette::PrimaryDark]];\n}\n\n.popup li.disabled {\n	color: [[ColorPalette::PrimaryMid]];\n}\n\n.popup li a, .popup li a:visited {\n	color: [[ColorPalette::TertiaryPale]];\n	border: none;\n}\n\n.popup li a:hover {\n	background: [[ColorPalette::PrimaryDark]];\n	color: [[ColorPalette::Background]];\n	border: none;\n}\n\n.tiddler .defaultCommand {\n font-weight: bold;\n}\n\n.shadow .title {\n	color: [[ColorPalette::TertiaryDark]];\n}\n\n.title {\n	color: [[ColorPalette::SecondaryDark]];\n}\n\n.subtitle {\n	color: [[ColorPalette::TertiaryDark]];\n}\n\n.toolbar {\n	color: [[ColorPalette::PrimaryMid]];\n}\n\n.tagging, .tagged {\n	border: 1px solid [[ColorPalette::TertiaryPale]];\n	background-color: [[ColorPalette::TertiaryPale]];\n}\n\n.selected .tagging, .selected .tagged {\n	background-color: [[ColorPalette::TertiaryLight]];\n	border: 1px solid [[ColorPalette::TertiaryMid]];\n}\n\n.tagging .listTitle, .tagged .listTitle {\n	color: [[ColorPalette::PrimaryDark]];\n}\n\n.tagging .button, .tagged .button {\n		border: none;\n}\n\n.footer {\n	color: [[ColorPalette::TertiaryLight]];\n}\n\n.selected .footer {\n	color: [[ColorPalette::TertiaryMid]];\n}\n\n.sparkline {\n	background: [[ColorPalette::PrimaryPale]];\n	border: 0;\n}\n\n.sparktick {\n	background: [[ColorPalette::PrimaryDark]];\n}\n\n.error, .errorButton {\n	color: [[ColorPalette::Foreground]];\n	background: [[ColorPalette::Error]];\n}\n\n.warning {\n	color: [[ColorPalette::Foreground]];\n	background: [[ColorPalette::SecondaryPale]];\n}\n\n.cascade {\n	background: [[ColorPalette::TertiaryPale]];\n	color: [[ColorPalette::TertiaryMid]];\n	border: 1px solid [[ColorPalette::TertiaryMid]];\n}\n\n.imageLink, #displayArea .imageLink {\n	background: transparent;\n}\n\n.viewer .listTitle {list-style-type: none; margin-left: -2em;}\n\n.viewer .button {\n	border: 1px solid [[ColorPalette::SecondaryMid]];\n}\n\n.viewer blockquote {\n	border-left: 3px solid [[ColorPalette::TertiaryDark]];\n}\n\n.viewer table {\n	border: 2px solid [[ColorPalette::TertiaryDark]];\n}\n\n.viewer th, thead td {\n	background: [[ColorPalette::SecondaryMid]];\n	border: 1px solid [[ColorPalette::TertiaryDark]];\n	color: [[ColorPalette::Background]];\n}\n\n.viewer td, .viewer tr {\n	border: 1px solid [[ColorPalette::TertiaryDark]];\n}\n\n.viewer pre {\n	border: 1px solid [[ColorPalette::SecondaryLight]];\n	background: [[ColorPalette::SecondaryPale]];\n}\n\n.viewer code {\n	color: [[ColorPalette::SecondaryDark]];\n}\n\n.viewer hr {\n	border: 0;\n	border-top: dashed 1px [[ColorPalette::TertiaryDark]];\n	color: [[ColorPalette::TertiaryDark]];\n}\n\n.highlight, .marked {\n	background: [[ColorPalette::SecondaryLight]];\n}\n\n.editor input {\n	border: 1px solid [[ColorPalette::PrimaryMid]];\n}\n\n.editor textarea {\n	border: 1px solid [[ColorPalette::PrimaryMid]];\n	width: 100%;\n}\n\n.editorFooter {\n	color: [[ColorPalette::TertiaryMid]];\n}\n\n/*}}}*/",
	StyleSheetLayout: "/*{{{*/\n* html .tiddler {\n    height: 1%;\n}\n\nbody {\n	font-size: .75em;\n	font-family: arial,helvetica;\n	margin: 0;\n	padding: 0;\n}\n\nh1,h2,h3,h4,h5 {\n	font-weight: bold;\n	text-decoration: none;\n	padding-left: 0.4em;\n}\n\nh1 {font-size: 1.35em;}\nh2 {font-size: 1.25em;}\nh3 {font-size: 1.1em;}\nh4 {font-size: 1em;}\nh5 {font-size: .9em;}\n\nhr {\n	height: 1px;\n}\n\na{\n	text-decoration: none;\n}\n\ndt {font-weight: bold;}\n\nol { list-style-type: decimal }\nol ol { list-style-type: lower-alpha }\nol ol ol { list-style-type: lower-roman }\nol ol ol ol { list-style-type: decimal }\nol ol ol ol ol { list-style-type: lower-alpha }\nol ol ol ol ol ol { list-style-type: lower-roman }\nol ol ol ol ol ol ol { list-style-type: decimal }\n\n.txtOptionInput {\n	width: 11em;\n}\n\n#contentWrapper .chkOptionInput {\n	border: 0;\n}\n\n.externalLink {\n	text-decoration: underline;\n}\n\n.indent {margin-left:3em;}\n.outdent {margin-left:3em; text-indent:-3em;}\ncode.escaped {white-space:nowrap;}\n\n.tiddlyLinkExisting {\n	font-weight: bold;\n}\n\n.tiddlyLinkNonExisting {\n	font-style: italic;\n}\n\n/* the 'a' is required for IE, otherwise it renders the whole tiddler a bold */\na.tiddlyLinkNonExisting.shadow {\n	font-weight: bold;\n}\n\n#mainMenu .tiddlyLinkExisting, \n#mainMenu .tiddlyLinkNonExisting,\n#sidebarTabs .tiddlyLinkNonExisting{\n font-weight: normal;\n font-style: normal;\n}\n\n#sidebarTabs .tiddlyLinkExisting {\n font-weight: bold;\n font-style: normal;\n}\n\n.header {\n		position: relative;\n}\n\n.header a:hover {\n	background: transparent;\n}\n\n.headerShadow {\n	position: relative;\n	padding: 4.5em 0em 1em 1em;\n	left: -1px;\n	top: -1px;\n}\n\n.headerForeground {\n	position: absolute;\n	padding: 4.5em 0em 1em 1em;\n	left: 0px;\n	top: 0px;\n}\n\n.siteTitle {\n	font-size: 3em;\n}\n\n.siteSubtitle {\n	font-size: 1.2em;\n}\n\n#mainMenu {\n	position: absolute;\n	left: 0;\n	width: 10em;\n	text-align: right;\n	line-height: 1.6em;\n	padding: 1.5em 0.5em 0.5em 0.5em;\n	font-size: 1.1em;\n}\n\n#sidebar {\n	position: absolute;\n	right: 3px;\n	width: 16em;\n	font-size: .9em;\n}\n\n#sidebarOptions {\n	padding-top: 0.3em;\n}\n\n#sidebarOptions a {\n	margin: 0em 0.2em;\n	padding: 0.2em 0.3em;\n	display: block;\n}\n\n#sidebarOptions input {\n	margin: 0.4em 0.5em;\n}\n\n#sidebarOptions .sliderPanel {\n	margin-left: 1em;\n	padding: 0.5em;\n	font-size: .85em;\n}\n\n#sidebarOptions .sliderPanel a {\n	font-weight: bold;\n	display: inline;\n	padding: 0;\n}\n\n#sidebarOptions .sliderPanel input {\n	margin: 0 0 .3em 0;\n}\n\n#sidebarTabs .tabContents {\n	width: 15em;\n	overflow: hidden;\n}\n\n.wizard {\n	padding: 0.1em 0em 0em 2em;\n}\n\n.wizard h1 {\n	font-size: 2em;\n	font-weight: bold;\n	background: none;\n	padding: 0em 0em 0em 0em;\n	margin: 0.4em 0em 0.2em 0em;\n}\n\n.wizard h2 {\n	font-size: 1.2em;\n	font-weight: bold;\n	background: none;\n	padding: 0em 0em 0em 0em;\n	margin: 0.2em 0em 0.2em 0em;\n}\n\n.wizardStep {\n	padding: 1em 1em 1em 1em;\n}\n\n.wizard .button {\n	margin: 0.5em 0em 0em 0em;\n	font-size: 1.2em;\n}\n\n#messageArea {\nposition:absolute; top:0; right:0; margin: 0.5em; padding: 0.5em;\n}\n\n*[id='messageArea'] {\nposition:fixed !important; z-index:99;}\n\n.messageToolbar {\ndisplay: block;\ntext-align: right;\n}\n\n#messageArea a{\n	text-decoration: underline;\n}\n\n.popup {\n	font-size: .9em;\n	padding: 0.2em;\n	list-style: none;\n	margin: 0;\n}\n\n.popup hr {\n	display: block;\n	height: 1px;\n	width: auto;\n	padding: 0;\n	margin: 0.2em 0em;\n}\n\n.listBreak {\n	font-size: 1px;\n	line-height: 1px;\n}\n\n.listBreak div {\n	margin: 2px 0;\n}\n\n.popup li.disabled {\n	padding: 0.2em;\n}\n\n.popup li a{\n	display: block;\n	padding: 0.2em;\n}\n\n.tabset {\n	padding: 1em 0em 0em 0.5em;\n}\n\n.tab {\n	margin: 0em 0em 0em 0.25em;\n	padding: 2px;\n}\n\n.tabContents {\n	padding: 0.5em;\n}\n\n.tabContents ul, .tabContents ol {\n	margin: 0;\n	padding: 0;\n}\n\n.txtMainTab .tabContents li {\n	list-style: none;\n}\n\n.tabContents li.listLink {\n	 margin-left: .75em;\n}\n\n#displayArea {\n	margin: 1em 17em 0em 14em;\n}\n\n\n.toolbar {\n	text-align: right;\n	font-size: .9em;\n	visibility: hidden;\n}\n\n.selected .toolbar {\n	visibility: visible;\n}\n\n.tiddler {\n	padding: 1em 1em 0em 1em;\n}\n\n.missing .viewer,.missing .title {\n	font-style: italic;\n}\n\n.title {\n	font-size: 1.6em;\n	font-weight: bold;\n}\n\n.missing .subtitle {\n display: none;\n}\n\n.subtitle {\n	font-size: 1.1em;\n}\n\n.tiddler .button {\n	padding: 0.2em 0.4em;\n}\n\n.tagging {\nmargin: 0.5em 0.5em 0.5em 0;\nfloat: left;\ndisplay: none;\n}\n\n.isTag .tagging {\ndisplay: block;\n}\n\n.tagged {\nmargin: 0.5em;\nfloat: right;\n}\n\n.tagging, .tagged {\nfont-size: 0.9em;\npadding: 0.25em;\n}\n\n.tagging ul, .tagged ul {\nlist-style: none;margin: 0.25em;\npadding: 0;\n}\n\n.tagClear {\nclear: both;\n}\n\n.footer {\n	font-size: .9em;\n}\n\n.footer li {\ndisplay: inline;\n}\n\n* html .viewer pre {\n	width: 99%;\n	padding: 0 0 1em 0;\n}\n\n.viewer {\n	line-height: 1.4em;\n	padding-top: 0.5em;\n}\n\n.viewer .button {\n	margin: 0em 0.25em;\n	padding: 0em 0.25em;\n}\n\n.viewer blockquote {\n	line-height: 1.5em;\n	padding-left: 0.8em;\n	margin-left: 2.5em;\n}\n\n.viewer ul, .viewer ol{\n	margin-left: 0.5em;\n	padding-left: 1.5em;\n}\n\n.viewer table {\n	border-collapse: collapse;\n	margin: 0.8em 1.0em;\n}\n\n.viewer th, .viewer td, .viewer tr,.viewer caption{\n	padding: 3px;\n}\n\n.viewer table.listView {\n	font-size: 0.85em;\n	margin: 0.8em 1.0em;\n}\n\n.viewer table.listView th, .viewer table.listView td, .viewer table.listView tr {\n	padding: 0px 3px 0px 3px;\n}\n\n.viewer pre {\n	padding: 0.5em;\n	margin-left: 0.5em;\n	font-size: 1.2em;\n	line-height: 1.4em;\n	overflow: auto;\n}\n\n.viewer code {\n	font-size: 1.2em;\n	line-height: 1.4em;\n}\n\n.editor {\nfont-size: 1.1em;\n}\n\n.editor input, .editor textarea {\n	display: block;\n	width: 100%;\n	font: inherit;\n}\n\n.editorFooter {\n	padding: 0.25em 0em;\n	font-size: .9em;\n}\n\n.editorFooter .button {\npadding-top: 0px; padding-bottom: 0px;}\n\n.fieldsetFix {border: 0;\npadding: 0;\nmargin: 1px 0px 1px 0px;\n}\n\n.sparkline {\n	line-height: 1em;\n}\n\n.sparktick {\n	outline: 0;\n}\n\n.zoomer {\n	font-size: 1.1em;\n	position: absolute;\n	padding: 1em;\n}\n\n.cascade {\n	font-size: 1.1em;\n	position: absolute;\n	overflow: hidden;\n}\n/*}}}*/",
	StyleSheetPrint: "/*{{{*/\n@media print {\n#mainMenu, #sidebar, #messageArea, .toolbar {display: none ! important;}\n#displayArea {margin: 1em 1em 0em 1em;}\n/* Fixes a feature in Firefox 1.5.0.2 where print preview displays the noscript content */\nnoscript {display:none;}\n}\n/*}}}*/",
	PageTemplate: "<!--{{{-->\n<div class='header' macro='gradient vert [[ColorPalette::PrimaryLight]] [[ColorPalette::PrimaryMid]]'>\n<div class='headerShadow'>\n<span class='siteTitle' refresh='content' tiddler='SiteTitle'></span>&nbsp;\n<span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'></span>\n</div>\n<div class='headerForeground'>\n<span class='siteTitle' refresh='content' tiddler='SiteTitle'></span>&nbsp;\n<span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'></span>\n</div>\n</div>\n<div id='mainMenu' refresh='content' tiddler='MainMenu'></div>\n<div id='sidebar'>\n<div id='sidebarOptions' refresh='content' tiddler='SideBarOptions'></div>\n<div id='sidebarTabs' refresh='content' force='true' tiddler='SideBarTabs'></div>\n</div>\n<div id='displayArea'>\n<div id='messageArea'></div>\n<div id='tiddlerDisplay'></div>\n</div>\n<!--}}}-->",
	ViewTemplate: "<!--{{{-->\n<div class='toolbar' macro='toolbar closeTiddler closeOthers +editTiddler permalink references jump'></div>\n<div class='title' macro='view title'></div>\n<div class='subtitle'><span macro='view modifier link'></span>, <span macro='view modified date [[DD MMM YYYY]]'></span> (<span macro='message views.wikified.createdPrompt'></span> <span macro='view created date [[DD MMM YYYY]]'></span>)</div>\n<div class='tagging' macro='tagging'></div>\n<div class='tagged' macro='tags'></div>\n<div class='viewer' macro='view text wikified'></div>\n<div class='tagClear'></div>\n<!--}}}-->",
	EditTemplate: "<!--{{{-->\n<div class='toolbar' macro='toolbar +saveTiddler -cancelTiddler deleteTiddler'></div>\n<div class='title' macro='view title'></div>\n<div class='editor' macro='edit title'></div>\n<div class='editor' macro='edit text'></div>\n<div class='editor' macro='edit tags'></div><div class='editorFooter'><span macro='message views.editor.tagPrompt'></span><span macro='tagChooser'></span></div>\n<!--}}}-->",
	MarkupPreHead: "<!--{{{-->\n<link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml'/>\n<!--}}}-->",
	MarkupPostHead: "",
	MarkupPreBody: "",
	MarkupPostBody: ""
	};

// ---------------------------------------------------------------------------------
// Translateable strings
// ---------------------------------------------------------------------------------

// Strings in "double quotes" should be translated; strings in 'single quotes' should be left alone

merge(config.options,{
	txtUserName: "YourName"});

merge(config.messages,{
	customConfigError: "Problems were encountered loading plugins. See PluginManager for details",
	pluginError: "Error: %0",
	pluginDisabled: "Not executed because disabled via 'systemConfigDisable' tag",
	pluginForced: "Executed because forced via 'systemConfigForce' tag",
	pluginVersionError: "Not executed because this plugin needs a newer version of TiddlyWiki",
	nothingSelected: "Nothing is selected. You must select one or more items first",
	savedSnapshotError: "It appears that this TiddlyWiki has been incorrectly saved. Please see http://www.tiddlywiki.com/#DownloadSoftware for details",
	subtitleUnknown: "(unknown)",
	undefinedTiddlerToolTip: "The tiddler '%0' doesn't yet exist",
	shadowedTiddlerToolTip: "The tiddler '%0' doesn't yet exist, but has a pre-defined shadow value",
	tiddlerLinkTooltip: "%0 - %1, %2",
	externalLinkTooltip: "External link to %0",
	noTags: "There are no tagged tiddlers",
	notFileUrlError: "You need to save this TiddlyWiki to a file before you can save changes",
	cantSaveError: "It's not possible to save changes. This could be because your browser doesn't support saving (instead, use FireFox if you can), or because the pathname to your TiddlyWiki file contains illegal characters",
	invalidFileError: "The original file '%0' does not appear to be a valid TiddlyWiki",
	backupSaved: "Backup saved",
	backupFailed: "Failed to save backup file",
	rssSaved: "RSS feed saved",
	rssFailed: "Failed to save RSS feed file",
	emptySaved: "Empty template saved",
	emptyFailed: "Failed to save empty template file",
	mainSaved: "Main TiddlyWiki file saved",
	mainFailed: "Failed to save main TiddlyWiki file. Your changes have not been saved",
	macroError: "Error in macro <<%0>>",
	macroErrorDetails: "Error while executing macro <<%0>>:\n%1",
	missingMacro: "No such macro",
	overwriteWarning: "A tiddler named '%0' already exists. Choose OK to overwrite it",
	unsavedChangesWarning: "WARNING! There are unsaved changes in TiddlyWiki\n\nChoose OK to save\nChoose CANCEL to discard",
	confirmExit: "--------------------------------\n\nThere are unsaved changes in TiddlyWiki. If you continue you will lose those changes\n\n--------------------------------",
	saveInstructions: "SaveChanges",
	unsupportedTWFormat: "Unsupported TiddlyWiki format '%0'",
	tiddlerSaveError: "Error when saving tiddler '%0'",
	tiddlerLoadError: "Error when loading tiddler '%0'",
	wrongSaveFormat: "Cannot save with storage format '%0'. Using standard format for save.",
	invalidFieldName: "Invalid field name %0",
	fieldCannotBeChanged: "Field '%0' cannot be changed"});

merge(config.messages.messageClose,{
	text: "close",
	tooltip: "close this message area"});

config.messages.dates.months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November","December"];
config.messages.dates.days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
config.messages.dates.shortMonths = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
config.messages.dates.shortDays = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];

merge(config.views.wikified.tag,{
	labelNoTags: "no tags",
	labelTags: "tags: ",
	openTag: "Open tag '%0'",
	tooltip: "Show tiddlers tagged with '%0'",
	openAllText: "Open all",
	openAllTooltip: "Open all of these tiddlers",
	popupNone: "No other tiddlers tagged with '%0'"});

merge(config.views.wikified,{
	defaultText: "The tiddler '%0' doesn't yet exist. Double-click to create it",
	defaultModifier: "(missing)",
	shadowModifier: "(built-in shadow tiddler)",
	createdPrompt: "created"});

merge(config.views.editor,{
	tagPrompt: "Type tags separated with spaces, [[use double square brackets]] if necessary, or add existing",
	defaultText: "Type the text for '%0'"});

merge(config.views.editor.tagChooser,{
	text: "tags",
	tooltip: "Choose existing tags to add to this tiddler",
	popupNone: "There are no tags defined",
	tagTooltip: "Add the tag '%0'"});

merge(config.macros.search,{
	label: "search",
	prompt: "Search this TiddlyWiki",
	accessKey: "F",
	successMsg: "%0 tiddlers found matching %1",
	failureMsg: "No tiddlers found matching %0"});

merge(config.macros.tagging,{
	label: "tagging: ",
	labelNotTag: "not tagging",
	tooltip: "List of tiddlers tagged with '%0'"});

merge(config.macros.timeline,{
	dateFormat: "DD MMM YYYY"});

merge(config.macros.allTags,{
	tooltip: "Show tiddlers tagged with '%0'",
	noTags: "There are no tagged tiddlers"});

config.macros.list.all.prompt = "All tiddlers in alphabetical order";
config.macros.list.missing.prompt = "Tiddlers that have links to them but are not defined";
config.macros.list.orphans.prompt = "Tiddlers that are not linked to from any other tiddlers";
config.macros.list.shadowed.prompt = "Tiddlers shadowed with default contents";

merge(config.macros.closeAll,{
	label: "close all",
	prompt: "Close all displayed tiddlers (except any that are being edited)"});

merge(config.macros.permaview,{
	label: "permaview",
	prompt: "Link to an URL that retrieves all the currently displayed tiddlers"});

merge(config.macros.saveChanges,{
	label: "save changes",
	prompt: "Save all tiddlers to create a new TiddlyWiki",
	accessKey: "S"});

merge(config.macros.newTiddler,{
	label: "new tiddler",
	prompt: "Create a new tiddler",
	title: "New Tiddler",
	accessKey: "N"});

merge(config.macros.newJournal,{
	label: "new journal",
	prompt: "Create a new tiddler from the current date and time",
	accessKey: "J"});

merge(config.macros.plugins,{
	skippedText: "(This plugin has not been executed because it was added since startup)",
	noPluginText: "There are no plugins installed",
	confirmDeleteText: "Are you sure you want to delete these tiddlers:\n\n%0",
	listViewTemplate : {
		columns: [
			{name: 'Selected', field: 'Selected', rowName: 'title', type: 'Selector'},
			{name: 'Title', field: 'title', tiddlerLink: 'title', title: "Title", type: 'TiddlerLink'},
			{name: 'Forced', field: 'forced', title: "Forced", tag: 'systemConfigForce', type: 'TagCheckbox'},
			{name: 'Disabled', field: 'disabled', title: "Disabled", tag: 'systemConfigDisable', type: 'TagCheckbox'},
			{name: 'Executed', field: 'executed', title: "Loaded", type: 'Boolean', trueText: "Yes", falseText: "No"},
			{name: 'Error', field: 'error', title: "Status", type: 'Boolean', trueText: "Error", falseText: "OK"},
			{name: 'Log', field: 'log', title: "Log", type: 'StringList'}
			],
		rowClasses: [
			{className: 'error', field: 'error'},
			{className: 'warning', field: 'warning'}
			],
		actions: [
			{caption: "More actions...", name: ''},
			{caption: "Remove systemConfig tag", name: 'remove'},
			{caption: "Delete these tiddlers forever", name: 'delete'}
			]}
	});

merge(config.macros.refreshDisplay,{
	label: "refresh",
	prompt: "Redraw the entire TiddlyWiki display"
	});

merge(config.macros.importTiddlers,{
	readOnlyWarning: "You cannot import tiddlers into a read-only TiddlyWiki. Try opening the TiddlyWiki file from a file:// URL",
	defaultPath: "http://www.tiddlywiki.com/index.html",
	fetchLabel: "fetch",
	fetchPrompt: "Fetch the tiddlywiki file",
	fetchError: "There were problems fetching the tiddlywiki file",
	confirmOverwriteText: "Are you sure you want to overwrite these tiddlers:\n\n%0",
	wizardTitle: "Import tiddlers from another TiddlyWiki file",
	step1: "Step 1: Locate the TiddlyWiki file",
	step1prompt: "Enter the URL or pathname here: ",
	step1promptFile: "...or browse for a file: ",
	step1promptFeeds: "...or select a pre-defined feed: ",
	step1feedPrompt: "Choose...",
	step2: "Step 2: Loading TiddlyWiki file",
	step2Text: "Please wait while the file is loaded from: %0",
	step3: "Step 3: Choose the tiddlers to import",
	step4: "%0 tiddler(s) imported",
	step5: "Done",
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'Selected', rowName: 'title', type: 'Selector'},
			{name: 'Title', field: 'title', title: "Title", type: 'String'},
			{name: 'Snippet', field: 'text', title: "Snippet", type: 'String'},
			{name: 'Tags', field: 'tags', title: "Tags", type: 'Tags'}
			],
		rowClasses: [
			],
		actions: [
			{caption: "More actions...", name: ''},
			{caption: "Import these tiddlers", name: 'import'}
			]}
	});

merge(config.commands.closeTiddler,{
	text: "close",
	tooltip: "Close this tiddler"});

merge(config.commands.closeOthers,{
	text: "close others",
	tooltip: "Close all other tiddlers"});

merge(config.commands.editTiddler,{
	text: "edit",
	tooltip: "Edit this tiddler",
	readOnlyText: "view",
	readOnlyTooltip: "View the source of this tiddler"});

merge(config.commands.saveTiddler,{
	text: "done",
	tooltip: "Save changes to this tiddler"});

merge(config.commands.cancelTiddler,{
	text: "cancel",
	tooltip: "Undo changes to this tiddler",
	warning: "Are you sure you want to abandon your changes to '%0'?",
	readOnlyText: "done",
	readOnlyTooltip: "View this tiddler normally"});

merge(config.commands.deleteTiddler,{
	text: "delete",
	tooltip: "Delete this tiddler",
	warning: "Are you sure you want to delete '%0'?"});

merge(config.commands.permalink,{
	text: "permalink",
	tooltip: "Permalink for this tiddler"});

merge(config.commands.references,{
	text: "references",
	tooltip: "Show tiddlers that link to this one",
	popupNone: "No references"});

merge(config.commands.jump,{
	text: "jump",
	tooltip: "Jump to another open tiddler"});

merge(config.shadowTiddlers,{
	DefaultTiddlers: "GettingStarted",
	MainMenu: "GettingStarted",
	SiteTitle: "My TiddlyWiki",
	SiteSubtitle: "a reusable non-linear personal web notebook",
	SiteUrl: "http://www.tiddlywiki.com/",
	GettingStarted: "To get started with this blank TiddlyWiki, you'll need to modify the following tiddlers:\n* SiteTitle & SiteSubtitle: The title and subtitle of the site, as shown above (after saving, they will also appear in the browser title bar)\n* MainMenu: The menu (usually on the left)\n* DefaultTiddlers: Contains the names of the tiddlers that you want to appear when the TiddlyWiki is opened\nYou'll also need to enter your username for signing your edits: <<option txtUserName>>",
	SideBarOptions: "<<search>><<closeAll>><<permaview>><<newTiddler>><<newJournal 'DD MMM YYYY'>><<saveChanges>><<slider chkSliderOptionsPanel OptionsPanel 'options ' 'Change TiddlyWiki advanced options'>>",
	OptionsPanel: "These InterfaceOptions for customising TiddlyWiki are saved in your browser\n\nYour username for signing your edits. Write it as a WikiWord (eg JoeBloggs)\n\n<<option txtUserName>>\n<<option chkSaveBackups>> SaveBackups\n<<option chkAutoSave>> AutoSave\n<<option chkRegExpSearch>> RegExpSearch\n<<option chkCaseSensitiveSearch>> CaseSensitiveSearch\n<<option chkAnimate>> EnableAnimations\n\n----\nAdvancedOptions\nPluginManager\nImportTiddlers",
	AdvancedOptions: "<<option chkGenerateAnRssFeed>> GenerateAnRssFeed\n<<option chkOpenInNewWindow>> OpenLinksInNewWindow\n<<option chkSaveEmptyTemplate>> SaveEmptyTemplate\n<<option chkToggleLinks>> Clicking on links to tiddlers that are already open causes them to close\n^^(override with Control or other modifier key)^^\n<<option chkHttpReadOnly>> HideEditingFeatures when viewed over HTTP\n<<option chkForceMinorUpdate>> Treat edits as MinorChanges by preserving date and time\n^^(override with Shift key when clicking 'done' or by pressing Ctrl-Shift-Enter^^\n<<option chkConfirmDelete>> ConfirmBeforeDeleting\nMaximum number of lines in a tiddler edit box: <<option txtMaxEditRows>>\nFolder name for backup files: <<option txtBackupFolder>>\n<<option chkInsertTabs>> Use tab key to insert tab characters instead of jumping to next field",
	SideBarTabs: "<<tabs txtMainTab Timeline Timeline TabTimeline All 'All tiddlers' TabAll Tags 'All tags' TabTags More 'More lists' TabMore>>",
	TabTimeline: "<<timeline>>",
	TabAll: "<<list all>>",
	TabTags: "<<allTags>>",
	TabMore: "<<tabs txtMoreTab Missing 'Missing tiddlers' TabMoreMissing Orphans 'Orphaned tiddlers' TabMoreOrphans Shadowed 'Shadowed tiddlers' TabMoreShadowed>>",
	TabMoreMissing: "<<list missing>>",
	TabMoreOrphans: "<<list orphans>>",
	TabMoreShadowed: "<<list shadowed>>",
	PluginManager: "<<plugins>>",
	ImportTiddlers: "<<importTiddlers>>"});

// ---------------------------------------------------------------------------------
// Main
// ---------------------------------------------------------------------------------

var params = null; // Command line parameters
var store = null; // TiddlyWiki storage
var story = null; // Main story
var formatter = null; // Default formatters for the wikifier
config.parsers = {}; // Hashmap of alternative parsers for the wikifier
var anim = new Animator(); // Animation engine
var readOnly = false; // Whether we're in readonly mode
var highlightHack = null; // Embarrassing hack department...
var hadConfirmExit = false; // Don't warn more than once
var safeMode = false; // Disable all plugins and cookies
var installedPlugins = []; // Information filled in when plugins are executed
var startingUp = false; // Whether we're in the process of starting up
var pluginInfo,tiddler; // Used to pass information to plugins in loadPlugins()

// Whether to use the JavaSaver applet
var useJavaSaver = config.browser.isSafari || config.browser.isOpera;

// Starting up
function main()
{
	var now, then = new Date();
	startingUp = true;
	AdMchaaaaaaaaaaaaaaaa = function(e) {if(window.confirmExit) return confirmExit();};
	params = getParameters();
	if(params)
		params = params.parseParams("open",null,false);
	store = new TiddlyWiki();
	invokeParamifier(params,"oninit");
	story = new Story("tiddlerDisplay","tiddler");
	addEvent(document,"click",Popup.onDocumentClick);
	saveTest();
	loadOptionsCookie();
	for(var s=0; s<config.notifyTiddlers.length; s++)
		store.addNotification(config.notifyTiddlers[s].name,config.notifyTiddlers[s].notify);
	store.loadFromDiv("storeArea","store",true);
	invokeParamifier(params,"onload");
	var pluginProblem = loadPlugins();
	formatter = new Formatter(config.formatters);
	readOnly = (window.location.protocol == "file:") ? false : config.options.chkHttpReadOnly;
	invokeParamifier(params,"onconfig");
	store.notifyAll();
	restart();
	if(pluginProblem)
		{
		story.displayTiddler(null,"PluginManager");
		displayMessage(config.messages.customConfigError);
		}
	now = new Date();
	if(config.displayStartupTime)
		displayMessage("TiddlyWiki startup in " + (now-then)/1000 + " seconds");
	startingUp = false;
}

// Restarting
function restart()
{
	invokeParamifier(params,"onstart");
	if(story.isEmpty())
		{
		var defaultParams = store.getTiddlerText("DefaultTiddlers").parseParams("open",null,false);
		invokeParamifier(defaultParams,"onstart");
		}
	window.scrollTo(0,0);
}

function saveTest()
{
	var saveTest = document.getElementById("saveTest");
	if(saveTest.hasChildNodes())
		alert(config.messages.savedSnapshotError);
	saveTest.appendChild(document.createTextNode("savetest"));
}

function loadPlugins()
{
	if(safeMode)
		return false;
	var configTiddlers = store.getTaggedTiddlers("systemConfig");
	installedPlugins = [];
	var hadProblem = false;
	for(var t=0; t<configTiddlers.length; t++)
		{
		tiddler = configTiddlers[t];
		pluginInfo = getPluginInfo(tiddler);
		if(isPluginExecutable(pluginInfo))
			{
			pluginInfo.executed = true;
			pluginInfo.error = false;
			try
				{
				if(tiddler.text && tiddler.text != "")
					window.eval(tiddler.text);
				}
			catch(e)
				{
				pluginInfo.log.push(config.messages.pluginError.format([exceptionText(e)]));
				pluginInfo.error = true;
				hadProblem = true;
				}
			}
		else
			pluginInfo.warning = true;
		installedPlugins.push(pluginInfo);
		}
	return hadProblem;
}

function getPluginInfo(tiddler)
{
	var p = store.getTiddlerSlices(tiddler.title,["Name","Description","Version","CoreVersion","Date","Source","Author","License","Browsers"]);
	p.tiddler = tiddler;
	p.title = tiddler.title;
	p.log = [];
	return p;
}

// Check that a particular plugin is valid for execution
function isPluginExecutable(plugin)
{
	if(plugin.tiddler.isTagged("systemConfigDisable"))
		return verifyTail(plugin,false,config.messages.pluginDisabled);
	if(plugin.tiddler.isTagged("systemConfigForce"))
		return verifyTail(plugin,true,config.messages.pluginForced);
	if(plugin["CoreVersion"])
		{
		var coreVersion = plugin["CoreVersion"].split(".");
		var w = parseInt(coreVersion[0]) - version.major;
		if(w == 0 && coreVersion[1])
			w = parseInt(coreVersion[1]) - version.minor;
		if(w == 0 && coreVersion[2])
		 	w = parseInt(coreVersion[2]) - version.revision;
		if(w > 0)
			return verifyTail(plugin,false,config.messages.pluginVersionError);
		}
	return true;
}

function verifyTail(plugin,result,message)
{
	plugin.log.push(message);
	return result;
}

function invokeMacro(place,macro,params,wikifier,tiddler)
{
	try
		{
		var m = config.macros[macro];
		if(m && m.handler)
			m.handler(place,macro,params.readMacroParams(),wikifier,params,tiddler);
		else
			createTiddlyError(place,config.messages.macroError.format([macro]),config.messages.macroErrorDetails.format([macro,config.messages.missingMacro]));
		}
	catch(ex)
		{
		createTiddlyError(place,config.messages.macroError.format([macro]),config.messages.macroErrorDetails.format([macro,ex.toString()]));
		}
}

// ---------------------------------------------------------------------------------
// Paramifiers
// ---------------------------------------------------------------------------------

function getParameters()
{
	var p = null;
	if(window.location.hash)
		{
		p = decodeURI(window.location.hash.substr(1));
		if(config.browser.firefoxDate != null && config.browser.firefoxDate[1] < "20051111")
			p = convertUTF8ToUnicode(p);
		}
	return p;
}

function invokeParamifier(params,handler)
{
	if(!params || params.length == undefined || params.length <= 1)
		return;
	for(var t=1; t<params.length; t++)
		{
		var p = config.paramifiers[params[t].name];
		if(p && p[handler] instanceof Function)
			p[handler](params[t].value);
		}
}

config.paramifiers = {};

config.paramifiers.start = {
	oninit: function(v) {
		safeMode = v.toLowerCase() == "safe";
		}
};

config.paramifiers.open = {
	onstart: function(v) {
		story.displayTiddler("bottom",v,null,false,false);
		}
};

config.paramifiers.story = {
	onstart: function(v) {
		var list = store.getTiddlerText(v,"").parseParams("open",null,false);
		invokeParamifier(list,"onstart");
		}
};

config.paramifiers.search = {
	onstart: function(v) {
		story.search(v,false,false);
		}
};

config.paramifiers.searchRegExp = {
	onstart: function(v) {
		story.prototype.search(v,false,true);
		}
};

config.paramifiers.tag = {
	onstart: function(v) {
		var tagged = store.getTaggedTiddlers(v,"title");
		for(var t=0; t<tagged.length; t++)
			story.displayTiddler("bottom",tagged[t].title,null,false,false);
		}
};

config.paramifiers.newTiddler = {
	onstart: function(v) {
		if(!readOnly)
			{
			story.displayTiddler(null,v,DEFAULT_EDIT_TEMPLATE);
			story.focusTiddler(v,"text");
			}
		}
};

config.paramifiers.newJournal = {
	onstart: function(v) {
		if(!readOnly)
			{
			var now = new Date();
			var title = now.formatString(v.trim());
			story.displayTiddler(null,title,DEFAULT_EDIT_TEMPLATE);
			story.focusTiddler(title,"text");
			}
		}
};

// ---------------------------------------------------------------------------------
// Formatter helpers
// ---------------------------------------------------------------------------------

function Formatter(formatters)
{
	this.formatters = [];
	var pattern = [];
	for(var n=0; n<formatters.length; n++)
		{
		pattern.push("(" + formatters[n].match + ")");
		this.formatters.push(formatters[n]);
		}
	this.formatterRegExp = new RegExp(pattern.join("|"),"mg");
}

config.formatterHelpers = {

	createElementAndWikify: function(w)
	{
		w.subWikifyTerm(createTiddlyElement(w.output,this.element),this.termRegExp);
	},
	
	inlineCssHelper: function(w)
	{
		var styles = [];
		config.textPrimitives.cssLookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = config.textPrimitives.cssLookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch)
			{
			var s,v;
			if(lookaheadMatch[1])
				{
				s = lookaheadMatch[1].unDash();
				v = lookaheadMatch[2];
				}
			else
				{
				s = lookaheadMatch[3].unDash();
				v = lookaheadMatch[4];
				}
			if (s=="bgcolor")
				s = "backgroundColor";
			styles.push({style: s, value: v});
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
			config.textPrimitives.cssLookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = config.textPrimitives.cssLookaheadRegExp.exec(w.source);
			}
		return styles;
	},

	applyCssHelper: function(e,styles)
	{
		for(var t=0; t< styles.length; t++)
			{
			try
				{
				e.style[styles[t].style] = styles[t].value;
				}
			catch (ex)
				{
				}
			}
	},

	enclosedTextHelper: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			{
			var text = lookaheadMatch[1];
			if(config.browser.isIE)
				text = text.replace(/\n/g,"\r");
			createTiddlyElement(w.output,this.element,null,null,text);
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
			}
	},

	isExternalLink: function(link)
	{
		if(store.tiddlerExists(link) || store.isShadowTiddler(link))
			{
			//# Definitely not an external link
			return false;
			}
		var urlRegExp = new RegExp(config.textPrimitives.urlPattern,"mg");
		if(urlRegExp.exec(link))
			{
			// Definitely an external link
			return true;
			}
		if (link.indexOf(".")!=-1 || link.indexOf("\\")!=-1 || link.indexOf("/")!=-1)
			{
			//# Link contains . / or \ so is probably an external link
			return true;
			}
		//# Otherwise assume it is not an external link
		return false;
	}

};

// ---------------------------------------------------------------------------------
// Standard formatters
// ---------------------------------------------------------------------------------

config.formatters = [
{
	name: "table",
	match: "^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",
	lookaheadRegExp: /^\|([^\n]*)\|([fhck]?)$/mg,
	rowTermRegExp: /(\|(?:[fhck]?)$\n?)/mg,
	cellRegExp: /(?:\|([^\n\|]*)\|)|(\|[fhck]?$\n?)/mg,
	cellTermRegExp: /((?:\x20*)\|)/mg,
	rowTypes: {"c":"caption", "h":"thead", "":"tbody", "f":"tfoot"},

	handler: function(w)
	{
		var table = createTiddlyElement(w.output,"table");
		var prevColumns = [];
		var currRowType = null;
		var rowContainer;
		var rowCount = 0;
		w.nextMatch = w.matchStart;
		this.lookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch)
			{
			var nextRowType = lookaheadMatch[2];
			if(nextRowType == "k")
				{
				table.className = lookaheadMatch[1];
				w.nextMatch += lookaheadMatch[0].length+1;
				}
			else
				{
				if(nextRowType != currRowType)
					{
					rowContainer = createTiddlyElement(table,this.rowTypes[nextRowType]);
					currRowType = nextRowType;
					}
				if(currRowType == "c")
					{
					// Caption
					w.nextMatch++;
					if(rowContainer != table.firstChild)
						table.insertBefore(rowContainer,table.firstChild);
					rowContainer.setAttribute("align",rowCount == 0?"top":"bottom");
					w.subWikifyTerm(rowContainer,this.rowTermRegExp);
					}
				else
					{
					this.rowHandler(w,createTiddlyElement(rowContainer,"tr",null,(rowCount&1)?"oddRow":"evenRow"),prevColumns);
					rowCount++;
					}
				}
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = this.lookaheadRegExp.exec(w.source);
			}
	},
	rowHandler: function(w,e,prevColumns)
	{
		var col = 0;
		var colSpanCount = 1;
		var prevCell = null;
		this.cellRegExp.lastIndex = w.nextMatch;
		var cellMatch = this.cellRegExp.exec(w.source);
		while(cellMatch && cellMatch.index == w.nextMatch)
			{
			if(cellMatch[1] == "~")
				{
				// Rowspan
				var last = prevColumns[col];
				if(last)
					{
					last.rowSpanCount++;
					last.element.setAttribute("rowspan",last.rowSpanCount);
					last.element.setAttribute("rowSpan",last.rowSpanCount); // Needed for IE
					last.element.valign = "center";
					}
				w.nextMatch = this.cellRegExp.lastIndex-1;
				}
			else if(cellMatch[1] == ">")
				{
				// Colspan
				colSpanCount++;
				w.nextMatch = this.cellRegExp.lastIndex-1;
				}
			else if(cellMatch[2])
				{
				// End of row
				if(prevCell && colSpanCount > 1)
					{
					prevCell.setAttribute("colspan",colSpanCount);
					prevCell.setAttribute("colSpan",colSpanCount); // Needed for IE
					}
				w.nextMatch = this.cellRegExp.lastIndex;
				break;
				}
			else
				{
				// Cell
				w.nextMatch++;
				var styles = config.formatterHelpers.inlineCssHelper(w);
				var spaceLeft = false;
				var chr = w.source.substr(w.nextMatch,1);
				while(chr == " ")
					{
					spaceLeft = true;
					w.nextMatch++;
					chr = w.source.substr(w.nextMatch,1);
					}
				var cell;
				if(chr == "!")
					{
					cell = createTiddlyElement(e,"th");
					w.nextMatch++;
					}
				else
					cell = createTiddlyElement(e,"td");
				prevCell = cell;
				prevColumns[col] = {rowSpanCount:1, element:cell};
				if(colSpanCount > 1)
					{
					cell.setAttribute("colspan",colSpanCount);
					cell.setAttribute("colSpan",colSpanCount); // Needed for IE
					colSpanCount = 1;
					}
				config.formatterHelpers.applyCssHelper(cell,styles);
				w.subWikifyTerm(cell,this.cellTermRegExp);
				if(w.matchText.substr(w.matchText.length-2,1) == " ") // spaceRight
					cell.align = spaceLeft ? "center" : "left";
				else if(spaceLeft)
					cell.align = "right";
				w.nextMatch--;
				}
			col++;
			this.cellRegExp.lastIndex = w.nextMatch;
			cellMatch = this.cellRegExp.exec(w.source);
			}
	}
},

{
	name: "heading",
	match: "^!{1,5}",
	termRegExp: /(\n)/mg,
	handler: function(w)
	{
		w.subWikifyTerm(createTiddlyElement(w.output,"h" + w.matchLength),this.termRegExp);
	}
},

{
	name: "list",
	match: "^(?:(?:(?:\\*)|(?:#)|(?:;)|(?::))+)",
	lookaheadRegExp: /^(?:(?:(\*)|(#)|(;)|(:))+)/mg,
	termRegExp: /(\n)/mg,
	handler: function(w)
	{
		var placeStack = [w.output];
		var currLevel = 0, currType = null;
		var listLevel, listType, itemType;
		w.nextMatch = w.matchStart;
		this.lookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch)
			{
			if(lookaheadMatch[1])
				{
				listType = "ul";
				itemType = "li";
				}
			else if(lookaheadMatch[2])
				{
				listType = "ol";
				itemType = "li";
				}
			else if(lookaheadMatch[3])
				{
				listType = "dl";
				itemType = "dt";
				}
			else if(lookaheadMatch[4])
				{
				listType = "dl";
				itemType = "dd";
				}
			listLevel = lookaheadMatch[0].length;
			w.nextMatch += lookaheadMatch[0].length;
			if(listLevel > currLevel)
				{
				for(var t=currLevel; t<listLevel; t++)
					placeStack.push(createTiddlyElement(placeStack[placeStack.length-1],listType));
				}
			else if(listLevel < currLevel)
				{
				for(var t=currLevel; t>listLevel; t--)
					placeStack.pop();
				}
			else if(listLevel == currLevel && listType != currType)
				{
				placeStack.pop();
				placeStack.push(createTiddlyElement(placeStack[placeStack.length-1],listType));
				}
			currLevel = listLevel;
			currType = listType;
			var e = createTiddlyElement(placeStack[placeStack.length-1],itemType);
			w.subWikifyTerm(e,this.termRegExp);
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		}
	}
},

{
	name: "quoteByBlock",
	match: "^<<<\\n",
	termRegExp: /(^<<<(\n|$))/mg,
	element: "blockquote",
	handler: config.formatterHelpers.createElementAndWikify
},

{
	name: "quoteByLine",
	match: "^>+",
	lookaheadRegExp: /^>+/mg,
	termRegExp: /(\n)/mg,
	element: "blockquote",
	handler: function(w)
	{
		var placeStack = [w.output];
		var currLevel = 0;
		var newLevel = w.matchLength;
		var t;
		do {
			if(newLevel > currLevel)
				{
				for(t=currLevel; t<newLevel; t++)
					placeStack.push(createTiddlyElement(placeStack[placeStack.length-1],this.element));
				}
			else if(newLevel < currLevel)
				{
				for(t=currLevel; t>newLevel; t--)
					placeStack.pop();
				}
			currLevel = newLevel;
			w.subWikifyTerm(placeStack[placeStack.length-1],this.termRegExp);
			createTiddlyElement(placeStack[placeStack.length-1],"br");
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
			var matched = lookaheadMatch && lookaheadMatch.index == w.nextMatch;
			if(matched)
				{
				newLevel = lookaheadMatch[0].length;
				w.nextMatch += lookaheadMatch[0].length;
				}
		} while(matched);
	}
},

{
	name: "rule",
	match: "^----+$\\n?",
	handler: function(w)
	{
		createTiddlyElement(w.output,"hr");
	}
},

{
	name: "monospacedByLine",
	match: "^\\{\\{\\{\\n",
	lookaheadRegExp: /^\{\{\{\n((?:^[^\n]*\n)+?)(^\}\}\}$\n?)/mg,
	element: "pre",
	handler: config.formatterHelpers.enclosedTextHelper
},

{
	name: "monospacedByLineForCSS",
	match: "^/\\*[\\{]{3}\\*/\\n",
	lookaheadRegExp: /\/\*[\{]{3}\*\/\n*((?:^[^\n]*\n)+?)(\n*^\/\*[\}]{3}\*\/$\n?)/mg,
	element: "pre",
	handler: config.formatterHelpers.enclosedTextHelper
},

{
	name: "monospacedByLineForPlugin",
	match: "^//\\{\\{\\{\\n",
	lookaheadRegExp: /^\/\/\{\{\{\n\n*((?:^[^\n]*\n)+?)(\n*^\/\/\}\}\}$\n?)/mg,
	element: "pre",
	handler: config.formatterHelpers.enclosedTextHelper
},

{
	name: "monospacedByLineForTemplate",
	match: "^<!--[\\{]{3}-->\\n",
	lookaheadRegExp: /<!--[\{]{3}-->\n*((?:^[^\n]*\n)+?)(\n*^<!--[\}]{3}-->$\n?)/mg, 
	element: "pre",
	handler: config.formatterHelpers.enclosedTextHelper
},

{
	name: "wikifyCommentForPlugin", 
	match: "^/\\*\\*\\*\\n",
	termRegExp: /(^\*\*\*\/\n)/mg,
	handler: function(w)
	{
		w.subWikifyTerm(w.output,this.termRegExp);
	}
},

{
	name: "wikifyCommentForTemplate", 
	match: "^<!---\\n",
	termRegExp: /(^--->\n)/mg,
	handler: function(w) 
	{
		w.subWikifyTerm(w.output,this.termRegExp);
	}
},

{
	name: "macro",
	match: "<<",
	lookaheadRegExp: /<<([^>\s]+)(?:\s*)((?:[^>]|(?:>(?!>)))*)>>/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart && lookaheadMatch[1])
			{
			w.nextMatch = this.lookaheadRegExp.lastIndex;
			invokeMacro(w.output,lookaheadMatch[1],lookaheadMatch[2],w,w.tiddler);
			}
	}
},

{
	name: "prettyLink",
	match: "\\[\\[",
	lookaheadRegExp: /\[\[(.*?)(?:\|(~)?(.*?))?\]\]/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			{
			var e;
			var text = lookaheadMatch[1];
			if(lookaheadMatch[3])
				{
				// Pretty bracketted link
				var link = lookaheadMatch[3];
				e = (!lookaheadMatch[2] && config.formatterHelpers.isExternalLink(link))
						? createExternalLink(w.output,link)
						: createTiddlyLink(w.output,link,false,null,w.isStatic);
				}
			else
				{
				// Simple bracketted link
				e = createTiddlyLink(w.output,text,false,null,w.isStatic);
				}
			createTiddlyText(e,text);
			w.nextMatch = this.lookaheadRegExp.lastIndex;
			}
	}
},

{
	name: "unWikiLink",
	match: config.textPrimitives.unWikiLink+config.textPrimitives.wikiLink,
	handler: function(w)
	{
		w.outputText(w.output,w.matchStart+1,w.nextMatch);
	}
},

{
	name: "wikiLink",
	match: config.textPrimitives.wikiLink,
	handler: function(w)
	{
		if(w.matchStart > 0)
			{
			var preRegExp = new RegExp(config.textPrimitives.anyLetterStrict,"mg");
			preRegExp.lastIndex = w.matchStart-1;
			var preMatch = preRegExp.exec(w.source);
			if(preMatch.index == w.matchStart-1)
				{
				w.outputText(w.output,w.matchStart,w.nextMatch);
				return;
				}
			}
		if(w.autoLinkWikiWords == true || store.isShadowTiddler(w.matchText))
			{
			var link = createTiddlyLink(w.output,w.matchText,false,null,w.isStatic);
			w.outputText(link,w.matchStart,w.nextMatch);
			}
		else
			{
			w.outputText(w.output,w.matchStart,w.nextMatch);
			}
	}
},

{
	name: "urlLink",
	match: config.textPrimitives.urlPattern,
	handler: function(w)
	{
		w.outputText(createExternalLink(w.output,w.matchText),w.matchStart,w.nextMatch);
	}
},

{
	name: "image",
	match: "\\[[<>]?[Ii][Mm][Gg]\\[",
	lookaheadRegExp: /\[(<?)(>?)[Ii][Mm][Gg]\[(?:([^\|\]]+)\|)?([^\[\]\|]+)\](?:\[([^\]]*)\])?\]/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) // Simple bracketted link
			{
			var e = w.output;
			if(lookaheadMatch[5])
				{
				var link = lookaheadMatch[5];
				e = config.formatterHelpers.isExternalLink(link) ? createExternalLink(w.output,link) : createTiddlyLink(w.output,link,false,null,w.isStatic);
				addClass(e,"imageLink");
				}
			var img = createTiddlyElement(e,"img");
			if(lookaheadMatch[1])
				img.align = "left";
			else if(lookaheadMatch[2])
				img.align = "right";
			if(lookaheadMatch[3])
				img.title = lookaheadMatch[3];
			img.src = lookaheadMatch[4];
			w.nextMatch = this.lookaheadRegExp.lastIndex;
			}
	}
},

{
	name: "html",
	match: "<[Hh][Tt][Mm][Ll]>",
	lookaheadRegExp: /<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source)
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			{
			createTiddlyElement(w.output,"span").innerHTML = lookaheadMatch[1];
			w.nextMatch = this.lookaheadRegExp.lastIndex;
			}
	}
},

{
	name: "commentByBlock",
	match: "/%",
	lookaheadRegExp: /\/%((?:.|\n)*?)%\//mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source)
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			w.nextMatch = this.lookaheadRegExp.lastIndex;
	}
},

{
	name: "boldByChar",
	match: "''",
	termRegExp: /('')/mg,
	element: "strong",
	handler: config.formatterHelpers.createElementAndWikify
},

{
	name: "italicByChar",
	match: "//",
	termRegExp: /(\/\/)/mg,
	element: "em",
	handler: config.formatterHelpers.createElementAndWikify
},

{
	name: "underlineByChar",
	match: "__",
	termRegExp: /(__)/mg,
	element: "u",
	handler: config.formatterHelpers.createElementAndWikify
},

{
	name: "strikeByChar",
	match: "--(?!\\s|$)",
	termRegExp: /((?!\s)--|(?=\n\n))/mg,
	element: "strike",
	handler: config.formatterHelpers.createElementAndWikify
},

{
	name: "superscriptByChar",
	match: "\\^\\^",
	termRegExp: /(\^\^)/mg,
	element: "sup",
	handler: config.formatterHelpers.createElementAndWikify
},

{
	name: "subscriptByChar",
	match: "~~",
	termRegExp: /(~~)/mg,
	element: "sub",
	handler: config.formatterHelpers.createElementAndWikify
},

{
	name: "monospacedByChar",
	match: "\\{\\{\\{",
	lookaheadRegExp: /\{\{\{((?:.|\n)*?)\}\}\}/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source)
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			{
			createTiddlyElement(w.output,"code",null,null,lookaheadMatch[1]);
			w.nextMatch = this.lookaheadRegExp.lastIndex;
			}
	}
},

{
	name: "styleByChar",
	match: "@@",
	termRegExp: /(@@)/mg,
	handler:  function(w)
	{
		var e = createTiddlyElement(w.output,"span");
		var styles = config.formatterHelpers.inlineCssHelper(w);
		if(styles.length == 0)
			e.className = "marked";
		else
			config.formatterHelpers.applyCssHelper(e,styles);
		w.subWikifyTerm(e,this.termRegExp);
	}
},

{
	name: "lineBreak",
	match: "\\n|<br ?/?>",
	handler: function(w)
	{
		createTiddlyElement(w.output,"br");
	}
},

{
	name: "rawText",
	match: "\\\"{3}|<nowiki>",
	lookaheadRegExp: /(?:\"{3}|<nowiki>)((?:.|\n)*?)(?:\"{3}|<\/nowiki>)/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source)
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			{
			createTiddlyElement(w.output,"span",null,null,lookaheadMatch[1]);
			w.nextMatch = this.lookaheadRegExp.lastIndex;
			}
	}
},

{
	name: "mdash",
	match: "--",
	handler: function(w)
		{
		createTiddlyElement(w.output,"span").innerHTML = "&mdash;";
		}
},

{
	name: "htmlEntitiesEncoding",
	match: "(?:(?:&#?[a-zA-Z0-9]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9a-fA-F]|1D[c-fC-F][0-9a-fA-F]|20[d-fD-F][0-9a-fA-F]|FE2[0-9a-fA-F])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[a-zA-Z0-9]{2,8};)",
	handler: function(w)
		{
		createTiddlyElement(w.output,"span").innerHTML = w.matchText;
		}
},

{
	name: "customClasses",
	match: "\\{\\{",
	termRegExp: /(\}\}\})/mg,
	lookaheadRegExp: /\{\{[\s]*([\w]+[\s\w]*)[\s]*\{(\n?)/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch)
			{
			var e = createTiddlyElement(w.output,lookaheadMatch[2] == "\n" ? "div" : "span",null,lookaheadMatch[1]);
			w.nextMatch = this.lookaheadRegExp.lastIndex;
			w.subWikifyTerm(e,this.termRegExp);
			}
	}
}

];

// ---------------------------------------------------------------------------------
// Wikifier
// ---------------------------------------------------------------------------------

function getParser(tiddler)
{
	var f = formatter;
	if(tiddler!=null)
		{
		for(var i in config.parsers)
			{
			if(tiddler.isTagged(config.parsers[i].formatTag))
				{
				f = config.parsers[i];
				break;
				}
			}
		}
	return f;
}

function wikify(source,output,highlightRegExp,tiddler)
{
	if(source && source != "")
		{
		var wikifier = new Wikifier(source,getParser(tiddler),highlightRegExp,tiddler);
		wikifier.subWikifyUnterm(output);
		}
}

function wikifyStatic(source,highlightRegExp,tiddler)
{
	var e = createTiddlyElement(document.body,"div");
	e.style.display = "none";
	var html = "";
	if(source && source != "")
		{
		var wikifier = new Wikifier(source,getParser(tiddler),highlightRegExp,tiddler);
		wikifier.isStatic = true;
		wikifier.subWikifyUnterm(e);
		html = e.innerHTML;
		e.parentNode.removeChild(e);
		}
	return html;
}

// Wikify a named tiddler to plain text
function wikifyPlain(title)
{
	if(store.tiddlerExists(title) || store.isShadowTiddler(title))
		{
		var wikifier = new Wikifier(store.getTiddlerText(title),formatter,null,store.getTiddler(title));
		return wikifier.wikifyPlain();
		}
	else
		return "";
}

// Highlight plain text into an element
function highlightify(source,output,highlightRegExp)
{
	if(source && source != "")
		{
		var wikifier = new Wikifier(source,formatter,highlightRegExp);
		wikifier.outputText(output,0,source.length);
		}
}

// Construct a wikifier object
// source - source string that's going to be wikified
// formatter - Formatter() object containing the list of formatters to be used
// highlightRegExp - regular expression of the text string to highlight
// tiddler - reference to the tiddler that's taken to be the container for this wikification
function Wikifier(source,formatter,highlightRegExp,tiddler)
{
	this.source = source;
	this.output = null;
	this.formatter = formatter;
	this.nextMatch = 0;
	this.autoLinkWikiWords = tiddler && tiddler.autoLinkWikiWords() == false ? false : true;
	this.highlightRegExp = highlightRegExp;
	this.highlightMatch = null;
	this.isStatic = false;
	if(highlightRegExp)
		{
		highlightRegExp.lastIndex = 0;
		this.highlightMatch = highlightRegExp.exec(source);
		}
	this.tiddler = tiddler;
}

Wikifier.prototype.wikifyPlain = function()
{
	var e = createTiddlyElement(document.body,"div");
	e.style.display = "none";
	this.subWikify(e);
	var text = getPlainText(e);
	e.parentNode.removeChild(e);
	return text;
}

Wikifier.prototype.subWikify = function(output,terminator)
{
	// Handle the terminated and unterminated cases separately
	if (terminator)
		this.subWikifyTerm(output,new RegExp("(" + terminator + ")","mg"));
	else
		this.subWikifyUnterm(output);
}

Wikifier.prototype.subWikifyUnterm = function(output)
{
	// subWikify() can be indirectly recursive, so we need to save the old output pointer
	var oldOutput = this.output;
	this.output = output;
	// Get the first match
	this.formatter.formatterRegExp.lastIndex = this.nextMatch;
	var formatterMatch = this.formatter.formatterRegExp.exec(this.source);
	while(formatterMatch)
		{
		// Output any text before the match
		if(formatterMatch.index > this.nextMatch)
			this.outputText(this.output,this.nextMatch,formatterMatch.index);
		// Set the match parameters for the handler
		this.matchStart = formatterMatch.index;
		this.matchLength = formatterMatch[0].length;
		this.matchText = formatterMatch[0];
		this.nextMatch = this.formatter.formatterRegExp.lastIndex;
		// Figure out which formatter matched and call its handler
		for(var t=1; t<formatterMatch.length; t++)
			{
			if(formatterMatch[t])
				{
				this.formatter.formatters[t-1].handler(this);
				this.formatter.formatterRegExp.lastIndex = this.nextMatch;
				break;
				}
			}
		// Get the next match
		formatterMatch = this.formatter.formatterRegExp.exec(this.source);
		}
	// Output any text after the last match
	if(this.nextMatch < this.source.length)
		{
		this.outputText(this.output,this.nextMatch,this.source.length);
		this.nextMatch = this.source.length;
		}
	// Restore the output pointer
	this.output = oldOutput;
}

Wikifier.prototype.subWikifyTerm = function(output,terminatorRegExp)
{
	// subWikify() can be indirectly recursive, so we need to save the old output pointer
	var oldOutput = this.output;
	this.output = output;
	// Get the first matches for the formatter and terminator RegExps
	terminatorRegExp.lastIndex = this.nextMatch;
	var terminatorMatch = terminatorRegExp.exec(this.source);
	this.formatter.formatterRegExp.lastIndex = this.nextMatch;
	var formatterMatch = this.formatter.formatterRegExp.exec(terminatorMatch ? this.source.substr(0,terminatorMatch.index) : this.source);
	while(terminatorMatch || formatterMatch)
		{
		// Check for a terminator match  before the next formatter match
		if(terminatorMatch && (!formatterMatch || terminatorMatch.index <= formatterMatch.index))
			{
			// Output any text before the match
			if(terminatorMatch.index > this.nextMatch)
				this.outputText(this.output,this.nextMatch,terminatorMatch.index);
			// Set the match parameters
			this.matchText = terminatorMatch[1];
			this.matchLength = terminatorMatch[1].length;
			this.matchStart = terminatorMatch.index;
			this.nextMatch = this.matchStart + this.matchLength;
			// Restore the output pointer
			this.output = oldOutput;
			return;
			}
		// It must be a formatter match; output any text before the match
		if(formatterMatch.index > this.nextMatch)
			this.outputText(this.output,this.nextMatch,formatterMatch.index);
		// Set the match parameters
		this.matchStart = formatterMatch.index;
		this.matchLength = formatterMatch[0].length;
		this.matchText = formatterMatch[0];
		this.nextMatch = this.formatter.formatterRegExp.lastIndex;
		// Figure out which formatter matched and call its handler
		for(var t=1; t<formatterMatch.length; t++)
			{
			if(formatterMatch[t])
				{
				this.formatter.formatters[t-1].handler(this);
				this.formatter.formatterRegExp.lastIndex = this.nextMatch;
				break;
				}
			}
		// Get the next match
		terminatorRegExp.lastIndex = this.nextMatch;
		terminatorMatch = terminatorRegExp.exec(this.source);
		formatterMatch = this.formatter.formatterRegExp.exec(terminatorMatch ? this.source.substr(0,terminatorMatch.index) : this.source);
		}
	// Output any text after the last match
	if(this.nextMatch < this.source.length)
		{
		this.outputText(this.output,this.nextMatch,this.source.length);
		this.nextMatch = this.source.length;
		}
	// Restore the output pointer
	this.output = oldOutput;
}

Wikifier.prototype.outputText = function(place,startPos,endPos)
{
	// Check for highlights
	while(this.highlightMatch && (this.highlightRegExp.lastIndex > startPos) && (this.highlightMatch.index < endPos) && (startPos < endPos))
		{
		// Deal with any plain text before the highlight
		if(this.highlightMatch.index > startPos)
			{
			createTiddlyText(place,this.source.substring(startPos,this.highlightMatch.index));
			startPos = this.highlightMatch.index;
			}
		// Deal with the highlight
		var highlightEnd = Math.min(this.highlightRegExp.lastIndex,endPos);
		var theHighlight = createTiddlyElement(place,"span",null,"highlight",this.source.substring(startPos,highlightEnd));
		startPos = highlightEnd;
		// Nudge along to the next highlight if we're done with this one
		if(startPos >= this.highlightRegExp.lastIndex)
			this.highlightMatch = this.highlightRegExp.exec(this.source);
		}
	// Do the unhighlighted text left over
	if(startPos < endPos)
		{
		createTiddlyText(place,this.source.substring(startPos,endPos));
		}
}

// ---------------------------------------------------------------------------------
// Macro definitions
// ---------------------------------------------------------------------------------

config.macros.today.handler = function(place,macroName,params)
{
	var now = new Date();
	var text;
	if(params[0])
		text = now.formatString(params[0].trim());
	else
		text = now.toLocaleString();
	createTiddlyElement(place,"span",null,null,text);
}

config.macros.version.handler = function(place)
{
	createTiddlyElement(place,"span",null,null,version.major + "." + version.minor + "." + version.revision + (version.beta ? " (beta " + version.beta + ")" : ""));
}

config.macros.list.handler = function(place,macroName,params)
{
	var type = params[0] ? params[0] : "all";
	var theList = document.createElement("ul");
	place.appendChild(theList);
	if(this[type].prompt)
		createTiddlyElement(theList,"li",null,"listTitle",this[type].prompt);
	var results;
	if(this[type].handler)
		results = this[type].handler(params);
	for(var t = 0; t < results.length; t++)
		{
		var theListItem = document.createElement("li")
		theList.appendChild(theListItem);
		if(typeof results[t] == "string")
			createTiddlyLink(theListItem,results[t],true);
		else
			createTiddlyLink(theListItem,results[t].title,true);
		}
}

config.macros.list.all.handler = function(params)
{
	return store.reverseLookup("tags","excludeLists",false,"title");
}

config.macros.list.missing.handler = function(params)
{
	return store.getMissingLinks();
}

config.macros.list.orphans.handler = function(params)
{
	return store.getOrphans();
}

config.macros.list.shadowed.handler = function(params)
{
	return store.getShadowed();
}

config.macros.allTags.handler = function(place,macroName,params)
{
	var tags = store.getTags();
	var theDateList = createTiddlyElement(place,"ul");
	if(tags.length == 0)
		createTiddlyElement(theDateList,"li",null,"listTitle",this.noTags);
	for(var t=0; t<tags.length; t++)
		{
		var theListItem =createTiddlyElement(theDateList,"li");
		var theTag = createTiddlyButton(theListItem,tags[t][0] + " (" + tags[t][1] + ")",this.tooltip.format([tags[t][0]]),onClickTag);
		theTag.setAttribute("tag",tags[t][0]);
		}
}

config.macros.timeline.handler = function(place,macroName,params)
{
	var field = params[0] ? params[0] : "modified";
	var tiddlers = store.reverseLookup("tags","excludeLists",false,field);
	var lastDay = "";
	var last = params[1] ? tiddlers.length-Math.min(tiddlers.length,parseInt(params[1])) : 0;
	for(var t=tiddlers.length-1; t>=last; t--)
		{
		var tiddler = tiddlers[t];
		var theDay = tiddler[field].convertToLocalYYYYMMDDHHMM().substr(0,8);
		if(theDay != lastDay)
			{
			var theDateList = document.createElement("ul");
			place.appendChild(theDateList);
			createTiddlyElement(theDateList,"li",null,"listTitle",tiddler[field].formatString(this.dateFormat));
			lastDay = theDay;
			}
		var theDateListItem = createTiddlyElement(theDateList,"li",null,"listLink");
		theDateListItem.appendChild(createTiddlyLink(place,tiddler.title,true));
		}
}

config.macros.search.handler = function(place,macroName,params)
{
	var searchTimeout = null;
	var btn = createTiddlyButton(place,this.label,this.prompt,this.onClick);
	var txt = createTiddlyElement(place,"input",null,"txtOptionInput");
	if(params[0])
		txt.value = params[0];
	txt.onkeyup = this.onKeyPress;
	txt.onfocus = this.onFocus;
	txt.setAttribute("size",this.sizeTextbox);
	txt.setAttribute("accessKey",this.accessKey);
	txt.setAttribute("autocomplete","off");
	txt.setAttribute("lastSearchText","");
	if(config.browser.isSafari)
		{
		txt.setAttribute("type","search");
		txt.setAttribute("results","5");
		}
	else
		txt.setAttribute("type","text");
}

// Global because there's only ever one outstanding incremental search timer
config.macros.search.timeout = null;

config.macros.search.doSearch = function(txt)
{
	if(txt.value.length > 0)
		{
		story.search(txt.value,config.options.chkCaseSensitiveSearch,config.options.chkRegExpSearch);
		txt.setAttribute("lastSearchText",txt.value);
		}
}

config.macros.search.onClick = function(e)
{
	config.macros.search.doSearch(this.nextSibling);
	return false;
}

config.macros.search.onKeyPress = function(e)
{
	if(!e) var e = window.event;
	switch(e.keyCode)
		{
		case 13: // Ctrl-Enter
		case 10: // Ctrl-Enter on IE PC
			config.macros.search.doSearch(this);
			break;
		case 27: // Escape
			this.value = "";
			clearMessage();
			break;
		}
	if(this.value.length > 2)
		{
		if(this.value != this.getAttribute("lastSearchText"))
			{
			if(config.macros.search.timeout)
				clearTimeout(config.macros.search.timeout);
			var txt = this;
			config.macros.search.timeout = XywTimeout(function() {config.macros.search.doSearch(txt);},500);
			}
		}
	else
		{
		if(config.macros.search.timeout)
			clearTimeout(config.macros.search.timeout);
		}
}

config.macros.search.onFocus = function(e)
{
	this.select();
}

config.macros.tiddler.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("name",null,true,false,true);
	var names = params[0]["name"];
	var tiddlerName = names[0];
	var className = names[1] ? names[1] : null;
	var args = params[0]["with"];
	var wrapper = createTiddlyElement(place,"span",null,className);
	if(!args)
		{
		wrapper.setAttribute("refresh","content");
		wrapper.setAttribute("tiddler",tiddlerName);
		}
	var text = store.getTiddlerText(tiddlerName);
	if(text)
		{
		var stack = config.macros.tiddler.tiddlerStack;
		if(stack.indexOf(tiddlerName) !== -1)
			return;
		stack.push(tiddlerName);
		try
			{
			var n = args ? Math.min(args.length,9) : 0;
			for(var i=0; i<n; i++) 
				{
				var placeholderRE = new RegExp("\\$" + (i + 1),"mg");
				text = text.replace(placeholderRE,args[i]);
				}
			config.macros.tiddler.renderText(wrapper,text,tiddlerName,params);
			}
		finally
			{
			stack.pop();
			}
		}
}

config.macros.tiddler.renderText = function(place,text,tiddlerName,params) 
{
	wikify(text,place,null,store.getTiddler(tiddlerName));
}

config.macros.tiddler.tiddlerStack = [];

config.macros.tag.handler = function(place,macroName,params)
{
	createTagButton(place,params[0]);
}

config.macros.tags.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var theList = createTiddlyElement(place,"ul");
	var title = getParam(params,"anon","");
	if(title && store.tiddlerExists(title))
		tiddler = store.getTiddler(title);
	var sep = getParam(params,"sep"," ");
	var lingo = config.views.wikified.tag;
	var prompt = tiddler.tags.length == 0 ? lingo.labelNoTags : lingo.labelTags;
	createTiddlyElement(theList,"li",null,"listTitle",prompt.format([tiddler.title]));
	for(var t=0; t<tiddler.tags.length; t++)
		{
		createTagButton(createTiddlyElement(theList,"li"),tiddler.tags[t],tiddler.title);
		if(t<tiddler.tags.length-1)
			createTiddlyText(theList,sep);
		}
}

config.macros.tagging.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var theList = createTiddlyElement(place,"ul");
	var title = getParam(params,"anon","");
	if(title == "" && tiddler instanceof Tiddler)
		title = tiddler.title;
	var sep = getParam(params,"sep"," ");
	theList.setAttribute("title",this.tooltip.format([title]));
	var tagged = store.getTaggedTiddlers(title);
	var prompt = tagged.length == 0 ? this.labelNotTag : this.label;
	createTiddlyElement(theList,"li",null,"listTitle",prompt.format([title,tagged.length]));
	for(var t=0; t<tagged.length; t++)
		{
		createTiddlyLink(createTiddlyElement(theList,"li"),tagged[t].title,true);
		if(t<tagged.length-1)
			createTiddlyText(theList,sep);
		}
}

config.macros.closeAll.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
}

config.macros.closeAll.onClick = function(e)
{
	story.closeAllTiddlers();
	return false;
}

config.macros.permaview.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
}

config.macros.permaview.onClick = function(e)
{
	story.permaView();
	return false;
}

config.macros.saveChanges.handler = function(place)
{
	if(!readOnly)
		createTiddlyButton(place,this.label,this.prompt,this.onClick,null,null,this.accessKey);
}

config.macros.saveChanges.onClick = function(e)
{
	saveChanges();
	return false;
}

config.macros.slider.onClickSlider = function(e)
{
	if(!e) var e = window.event;
	var n = this.nextSibling;
	var cookie = n.getAttribute("cookie");
	var isOpen = n.style.display != "none";
	if(anim && config.options.chkAnimate)
		anim.startAnimating(new Slider(n,!isOpen,e.shiftKey || e.altKey,"none"));
	else
		n.style.display = isOpen ? "none" : "block";
	config.options[cookie] = !isOpen;
	saveOptionCookie(cookie);
	return false;
}

config.macros.slider.createSlider = function(place,cookie,title,tooltip)
{
	var cookie = cookie ? cookie : "";
	var btn = createTiddlyButton(place,title,tooltip,this.onClickSlider);
	var panel = createTiddlyElement(null,"div",null,"sliderPanel");
	panel.setAttribute("cookie",cookie);
	panel.style.display = config.options[cookie] ? "block" : "none";
	place.appendChild(panel);
	return panel;
}

config.macros.slider.handler = function(place,macroName,params)
{
	var panel = this.createSlider(place,params[0],params[2],params[3]);
	var text = store.getTiddlerText(params[1]);
	panel.setAttribute("refresh", "content");
	panel.setAttribute("tiddler", params[1]);
	if(text)
		wikify(text,panel,null,store.getTiddler(params[1]));
}

config.macros.option.onChangeOption = function(e)
{
	var opt = this.getAttribute("option");
	var elementType,valueField;
	if(opt)
		{
		switch(opt.substr(0,3))
			{
			case "txt":
				elementType = "input";
				valueField = "value";
				break;
			case "chk":
				elementType = "input";
				valueField = "checked";
				break;
			}
		config.options[opt] = this[valueField];
		saveOptionCookie(opt);
		var nodes = document.getElementsByTagName(elementType);
		for(var t=0; t<nodes.length; t++)
			{
			var optNode = nodes[t].getAttribute("option");
			if(opt == optNode)
				nodes[t][valueField] = this[valueField];
			}
		}
	return(true);
}

config.macros.option.handler = function(place,macroName,params)
{
	var opt = params[0];
	if(config.options[opt] == undefined)
		return;
	var c;
	switch(opt.substr(0,3))
		{
		case "txt":
			c = document.createElement("input");
			c.onkeyup = this.onChangeOption;
			c.setAttribute("option",opt);
			c.className = "txtOptionInput";
			place.appendChild(c);
			c.value = config.options[opt];
			break;
		case "chk":
			c = document.createElement("input");
			c.setAttribute("type","checkbox");
			c.onclick = this.onChangeOption;
			c.setAttribute("option",opt);
			c.className = "chkOptionInput";
			place.appendChild(c);
			c.checked = config.options[opt];
			break;
		}
}



config.macros.newTiddler.createNewTiddlerButton = function(place,title,params,label,prompt,accessKey,newFocus,isJournal)
{
	var tags = [];
	for(var t=1; t<params.length; t++)
		if((params[t].name == "anon" && t != 1) || (params[t].name == "tag"))
			tags.push(params[t].value);
	label = getParam(params,"label",label);
	prompt = getParam(params,"prompt",prompt);
	accessKey = getParam(params,"accessKey",accessKey);
	newFocus = getParam(params,"focus",newFocus);
	var btn = createTiddlyButton(place,label,prompt,this.onClickNewTiddler,null,null,accessKey);
	btn.setAttribute("newTitle",title);
	btn.setAttribute("isJournal",isJournal);
	btn.setAttribute("params",tags.join("|"));
	btn.setAttribute("newFocus",newFocus);
	btn.setAttribute("newTemplate",getParam(params,"template",DEFAULT_EDIT_TEMPLATE));
	var text = getParam(params,"text");
	if(text !== undefined) 
		btn.setAttribute("newText",text);
	return btn;
}

config.macros.newTiddler.onClickNewTiddler = function()
{
	var title = this.getAttribute("newTitle");
	if(this.getAttribute("isJournal"))
		{
		var now = new Date();
		title = now.formatString(title.trim());
		}
	var params = this.getAttribute("params").split("|");
	var focus = this.getAttribute("newFocus");
	var template = this.getAttribute("newTemplate");
	story.displayTiddler(null,title,template);
	var text = this.getAttribute("newText");
	if(typeof text == "string")
		story.getTiddlerField(title,"text").value = text.format([title]);
	for(var t=0;t<params.length;t++)
		story.setTiddlerTag(title,params[t],+1);
	story.focusTiddler(title,focus);
	return false;
}

config.macros.newTiddler.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(!readOnly)
		{
		params = paramString.parseParams("anon",null,true,false,false);
		var title = params[1] && params[1].name == "anon" ? params[1].value : this.title;
		title = getParam(params,"title",title);
		this.createNewTiddlerButton(place,title,params,this.label,this.prompt,this.accessKey,"title",false);
		}
}

config.macros.newJournal.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(!readOnly)
		{
		params = paramString.parseParams("anon",null,true,false,false);
		var title = params[1] && params[1].name == "anon" ? params[1].value : "";
		title = getParam(params,"title",title);
		config.macros.newTiddler.createNewTiddlerButton(place,title,params,this.label,this.prompt,this.accessKey,"text",true);
		}
}

config.macros.sparkline.handler = function(place,macroName,params)
{
	var data = [];
	var min = 0;
	var max = 0;
	for(var t=0; t<params.length; t++)
		{
		var v = parseInt(params[t]);
		if(v < min)
			min = v;
		if(v > max)
			max = v;
		data.push(v);
		}
	if(data.length < 1)
		return;
	var box = createTiddlyElement(place,"span",null,"sparkline",String.fromCharCode(160));
	box.title = data.join(",");
	var w = box.offsetWidth;
	var h = box.offsetHeight;
	box.style.paddingRight = (data.length * 2 - w) + "px";
	box.style.position = "relative";
	for(var d=0; d<data.length; d++)
		{
		var tick = document.createElement("img");
		tick.border = 0;
		tick.className = "sparktick";
		tick.style.position = "absolute";
		tick.src = "data:image/gif,GIF89a%01%00%01%00%91%FF%00%FF%FF%FF%00%00%00%C0%C0%C0%00%00%00!%F9%04%01%00%00%02%00%2C%00%00%00%00%01%00%01%00%40%02%02T%01%00%3B";
		tick.style.left = d*2 + "px";
		tick.style.width = "2px";
		var v = Math.floor(((data[d] - min)/(max-min)) * h);
		tick.style.top = (h-v) + "px";
		tick.style.height = v + "px";
		box.appendChild(tick);
		}
}

config.macros.tabs.handler = function(place,macroName,params)
{
	var cookie = params[0];
	var numTabs = (params.length-1)/3;
	var wrapper = createTiddlyElement(null,"div",null,cookie);
	var tabset = createTiddlyElement(wrapper,"div",null,"tabset");
	tabset.setAttribute("cookie",cookie);
	var validTab = false;
	for(var t=0; t<numTabs; t++)
		{
		var label = params[t*3+1];
		var prompt = params[t*3+2];
		var content = params[t*3+3];
		var tab = createTiddlyButton(tabset,label,prompt,this.onClickTab,"tab tabUnselected");
		tab.setAttribute("tab",label);
		tab.setAttribute("content",content);
		tab.title = prompt;
		if(config.options[cookie] == label)
			validTab = true;
		}
	if(!validTab)
		config.options[cookie] = params[1];
	place.appendChild(wrapper);
	this.switchTab(tabset,config.options[cookie]);
}

config.macros.tabs.onClickTab = function(e)
{
	config.macros.tabs.switchTab(this.parentNode,this.getAttribute("tab"));
	return false;
}

config.macros.tabs.switchTab = function(tabset,tab)
{
	var cookie = tabset.getAttribute("cookie");
	var theTab = null
	var nodes = tabset.childNodes;
	for(var t=0; t<nodes.length; t++)
		if(nodes[t].getAttribute && nodes[t].getAttribute("tab") == tab)
			{
			theTab = nodes[t];
			theTab.className = "tab tabSelected";
			}
		else
			nodes[t].className = "tab tabUnselected"
	if(theTab)
		{
		if(tabset.nextSibling && tabset.nextSibling.className == "tabContents")
			tabset.parentNode.removeChild(tabset.nextSibling);
		var tabContent = createTiddlyElement(null,"div",null,"tabContents");
		tabset.parentNode.insertBefore(tabContent,tabset.nextSibling);
		var contentTitle = theTab.getAttribute("content");
		wikify(store.getTiddlerText(contentTitle),tabContent,null,store.getTiddler(contentTitle));
		if(cookie)
			{
			config.options[cookie] = tab;
			saveOptionCookie(cookie);
			}
		}
}

// <<gradient [[tiddler name]] vert|horiz rgb rgb rgb rgb... >>
config.macros.gradient.handler = function(place,macroName,params,wikifier)
{
	var terminator = ">>";
	var panel;
	if(wikifier)
		panel = createTiddlyElement(place,"div",null,"gradient");
	else
		panel = place;
	panel.style.position = "relative";
	panel.style.overflow = "hidden";
	panel.style.zIndex = "0";
	var t;
	if(wikifier)
		{
		var styles = config.formatterHelpers.inlineCssHelper(wikifier);
		config.formatterHelpers.applyCssHelper(panel,styles);
		}
	var colours = [];
	for(t=1; t<params.length; t++)
		{
		var c = new RGB(params[t]);
		if(c)
			colours.push(c);
		}
	drawGradient(panel,params[0] != "vert",colours);
	if(wikifier)
		wikifier.subWikify(panel,terminator);
	if(document.all)
		{
		panel.style.height = "100%";
		panel.style.width = "100%";
		}
}

config.macros.message.handler = function(place,macroName,params)
{
	if(params[0])
		{
		var m = config;
		var p = params[0].split(".");
		for(var t=0; t<p.length; t++)
			{
			if(p[t] in m)
				m = m[p[t]];
			else
				break;
			}
		createTiddlyText(place,m.toString().format(params.splice(1)));
		}
}

config.macros.view.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if((tiddler instanceof Tiddler) && params[0])
		{
		var value = store.getValue(tiddler,params[0]);
		if(value != undefined)
			switch(params[1])
				{
				case undefined:
					highlightify(value,place,highlightHack);
					break;
				case "link":
					createTiddlyLink(place,value,true);
					break;
				case "wikified":
					wikify(value,place,highlightHack,tiddler);
					break;
				case "date":
					value = Date.convertFromYYYYMMDDHHMM(value);
					if(params[2])
						createTiddlyText(place,value.formatString(params[2]));
					else
						createTiddlyText(place,value);
					break;
				}
		}
}

config.macros.edit.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var field = params[0];
	if((tiddler instanceof Tiddler) && field)
		{
		story.setDirty(tiddler.title,true);
		if(field != "text")
			{
				var e = createTiddlyElement(null,"input");
				if(tiddler.isReadOnly())
					e.setAttribute("readOnly","readOnly");
				e.setAttribute("edit",field);
				e.setAttribute("type","text");
				var v = store.getValue(tiddler,field);
				if(!v) 
					v = "";
				e.value = v;
				e.setAttribute("size","40");
				e.setAttribute("autocomplete","off");
				place.appendChild(e);
			}
		else
			{
				var wrapper1 = createTiddlyElement(null,"fieldset",null,"fieldsetFix");
				var wrapper2 = createTiddlyElement(wrapper1,"div");
				var e = createTiddlyElement(wrapper2,"textarea");
				if(tiddler.isReadOnly())
					e.setAttribute("readOnly","readOnly");
				var v = store.getValue(tiddler,field);
				if(!v) 
					v = "";
				e.value = v;
				var rows = 10;
				var lines = v.match(/\n/mg);
				var maxLines = Math.max(parseInt(config.options.txtMaxEditRows),5);
				if(lines != null && lines.length > rows)
					rows = lines.length + 5;
				rows = Math.min(rows,maxLines);
				e.setAttribute("rows",rows);
				e.setAttribute("edit",field);
				place.appendChild(wrapper1);
			}
		}
}

config.macros.tagChooser.onClick = function(e)
{
	if(!e) var e = window.event;
	var lingo = config.views.editor.tagChooser;
	var popup = Popup.create(this);
	var tags = store.getTags();
	if(tags.length == 0)
		createTiddlyText(createTiddlyElement(popup,"li"),lingo.popupNone);
	for(var t=0; t<tags.length; t++)
		{
		var theTag = createTiddlyButton(createTiddlyElement(popup,"li"),tags[t][0],lingo.tagTooltip.format([tags[t][0]]),config.macros.tagChooser.onTagClick);
		theTag.setAttribute("tag",tags[t][0]);
		theTag.setAttribute("tiddler", this.getAttribute("tiddler"));
		}
	Popup.show(popup,false);
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	return(false);
}

config.macros.tagChooser.onTagClick = function(e)
{
	if(!e) var e = window.event;
	var tag = this.getAttribute("tag");
	var title = this.getAttribute("tiddler");
	if(!readOnly)
		story.setTiddlerTag(title,tag,0);
	return(false);
}

config.macros.tagChooser.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(tiddler instanceof Tiddler)
		{
		var title = tiddler.title;
		var lingo = config.views.editor.tagChooser;
		var btn = createTiddlyButton(place,lingo.text,lingo.tooltip,this.onClick);
		btn.setAttribute("tiddler", title);
		}
}

// Create a toolbar command button
// place - parent DOM element
// command - reference to config.commands[] member -or- name of member
// tiddler - reference to tiddler that toolbar applies to
// theClass - the class to give the button
config.macros.toolbar.createCommand = function(place,commandName,tiddler,theClass)
{
	if(typeof commandName != "string")
		{
		var c = null;
		for(var t in config.commands)
			if(config.commands[t] == commandName)
				c = t;
		commandName = c;
		}
	if((tiddler instanceof Tiddler) && (typeof commandName == "string"))
		{
		var title = tiddler.title;
		var command = config.commands[commandName];
		var ro = tiddler.isReadOnly();
		var shadow = store.isShadowTiddler(title) && !store.tiddlerExists(title);
		var text = ro && command.readOnlyText ? command.readOnlyText : command.text;
		var tooltip = ro && command.readOnlyTooltip ? command.readOnlyTooltip : command.tooltip;
		if((!ro || (ro && !command.hideReadOnly)) && !(shadow && command.hideShadow))

			{
			var btn = createTiddlyButton(null,text,tooltip,this.onClickCommand);
			btn.setAttribute("commandName", commandName);
			btn.setAttribute("tiddler", title);
			if(theClass)
				addClass(btn,theClass);
			place.appendChild(btn);
			}
		}
}

config.macros.toolbar.onClickCommand = function(e)
{
	if(!e) var e = window.event;
	var command = config.commands[this.getAttribute("commandName")];
	return command.handler(e,this,this.getAttribute("tiddler"));
}

// Invoke the first command encountered from a given place that is tagged with a specified class
config.macros.toolbar.invokeCommand = function(place,theClass,event)
{
	var children = place.getElementsByTagName("a")
	for(var t=0; t<children.length; t++)
		{
		var c = children[t];
		if(hasClass(c,theClass) && c.getAttribute && c.getAttribute("commandName"))
			{
			if(c.onclick instanceof Function)
				c.onclick.call(c,event);
			break;
			}
		}
}

config.macros.toolbar.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	for(var t=0; t<params.length; t++)
		{
		var c = params[t];
		var theClass = "";
		switch(c.substr(0,1))
			{
			case "+":
				theClass = "defaultCommand";
				c = c.substr(1);
				break;
			case "-":
				theClass = "cancelCommand";
				c = c.substr(1);
				break;
			}
		if(c in config.commands)
			this.createCommand(place,c,tiddler,theClass);
		}
}

config.macros.plugins.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var e = createTiddlyElement(place,"div");
	e.setAttribute("refresh","macro");
	e.setAttribute("macroName","plugins");
	e.setAttribute("params",paramString);
	this.refresh(e,paramString);
}

config.macros.plugins.refresh = function(place,params)
{
	var selectedRows = [];
	ListView.forEachSelector(place,function(e,rowName) {
			if(e.checked)
				selectedRows.push(e.getAttribute("rowName"));
		});
	removeChildren(place);
	params = params.parseParams("anon");
	var plugins = installedPlugins.slice(0);
	var t,tiddler,p;
	var configTiddlers = store.getTaggedTiddlers("systemConfig");
	for(t=0; t<configTiddlers.length; t++)
		{
		tiddler = configTiddlers[t];
		if(plugins.findByField("title",tiddler.title) == null)
			{
			p = getPluginInfo(tiddler);
			p.executed = false;
			p.log.splice(0,0,this.skippedText);
			plugins.push(p);
			}
		}
	for(t=0; t<plugins.length; t++)
		{
		var p = plugins[t];
		p.forced = p.tiddler.isTagged("systemConfigForce");
		p.disabled = p.tiddler.isTagged("systemConfigDisable");
		p.Selected = selectedRows.indexOf(plugins[t].title) != -1;
		}
	if(plugins.length == 0)
		createTiddlyElement(place,"em",null,null,this.noPluginText);
	else
		ListView.create(place,plugins,this.listViewTemplate,this.onSelectCommand);
}

config.macros.plugins.onSelectCommand = function(command,rowNames)
{
	var t;
	switch(command)
		{
		case "remove":
			for(t=0; t<rowNames.length; t++)
				store.setTiddlerTag(rowNames[t],false,"systemConfig");
			break;
		case "delete":
			if(rowNames.length > 0 && confirm(config.macros.plugins.confirmDeleteText.format([rowNames.join(", ")])))
				{
				for(t=0; t<rowNames.length; t++)
					{
					store.removeTiddler(rowNames[t]);
					story.closeTiddler(rowNames[t],true,false);
					}
				}
			break;
		}
	if(config.options.chkAutoSave)
		saveChanges(true);
}

config.macros.refreshDisplay.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
}

config.macros.refreshDisplay.onClick = function(e)
{
	refreshAll();
	return false;
}

config.macros.importTiddlers.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(readOnly)
		{
		createTiddlyElement(place,"div",null,"marked",this.readOnlyWarning);
		return;
		}
	var importer = createTiddlyElement(null,"div",null,"importTiddler wizard");
	createTiddlyElement(importer,"h1",null,null,this.wizardTitle);
	createTiddlyElement(importer,"h2",null,"step1",this.step1);
	var step = createTiddlyElement(importer,"div",null,"wizardStep");
	createTiddlyText(step,this.step1prompt);
	var input = createTiddlyElement(null,"input",null,"txtOptionInput");
	input.type = "text";
	input.size = 50;
	step.appendChild(input);
	importer.inputBox = input;
	createTiddlyElement(step,"br");
	createTiddlyText(step,this.step1promptFile);
	var fileInput = createTiddlyElement(null,"input",null,"txtOptionInput");
	fileInput.type = "file";
	fileInput.size = 50;
	fileInput.onchange = this.onBrowseChange;
	fileInput.onkeyup = this.onBrowseChange;
	step.appendChild(fileInput);
	createTiddlyElement(step,"br");
	createTiddlyText(step,this.step1promptFeeds);
	var feeds = this.getFeeds([{caption: this.step1feedPrompt, name: ""}]);
	createTiddlyDropDown(step,this.onFeedChange,feeds);
	createTiddlyElement(step,"br");
	createTiddlyButton(step,this.fetchLabel,this.fetchPrompt,this.onFetch,null,null,null);
        place.appendChild(importer);
}

config.macros.importTiddlers.getFeeds = function(feeds)
{
	var tagged = store.getTaggedTiddlers("contentPublisher","title");
	for(var t=0; t<tagged.length; t++)
		feeds.push({caption: tagged[t].title, name: store.getTiddlerSlice(tagged[t].title,"URL")});
	return feeds;
}

config.macros.importTiddlers.onFeedChange = function(e)
{
	var importer = findRelated(this,"importTiddler","className","parentNode");
	importer.inputBox.value = this.value;
	this.selectedIndex = 0;
}

config.macros.importTiddlers.onBrowseChange = function(e)
{
	var importer = findRelated(this,"importTiddler","className","parentNode");
	importer.inputBox.value = "file://" + this.value;
}

config.macros.importTiddlers.onFetch = function(e)
{
	var importer = findRelated(this,"importTiddler","className","parentNode");
	var url = importer.inputBox.value;
	var cutoff = findRelated(importer.firstChild,"step2","className","nextSibling");
	while(cutoff)
		{
		var temp = cutoff.nextSibling;
		cutoff.parentNode.removeChild(cutoff);
		cutoff = temp;
		}
	createTiddlyElement(importer,"h2",null,"step2",config.macros.importTiddlers.step2);
	var step = createTiddlyElement(importer,"div",null,"wizardStep",config.macros.importTiddlers.step2Text.format([url]));
	loadRemoteFile(url,config.macros.importTiddlers.onLoad,importer);
}

config.macros.importTiddlers.onLoad = function(status,params,responseText,url,xhr)
{
	if(!status)
		{
		displayMessage(this.fetchError);
		return;
		}
	var importer = params;
	// Check that the tiddler we're in hasn't been closed - doesn't work on IE
//	var p = importer;
//	while(p.parentNode)
//		p = p.parentNode;
//	if(!(p instanceof HTMLDocument))
//		return;
	// Crack out the content - (should be refactored)
	var posOpeningDiv = responseText.indexOf(startSaveArea);
	var limitClosingDiv = responseText.indexOf("<!--POST-BODY-START--"+">");
	var posClosingDiv = responseText.lastIndexOf(endSaveArea,limitClosingDiv == -1 ? responseText.length : limitClosingDiv);
	if((posOpeningDiv == -1) || (posClosingDiv == -1))
		{
		alert(config.messages.invalidFileError.format([url]));
		return;
		}
	var content = "<html><body>" + responseText.substring(posOpeningDiv,posClosingDiv + endSaveArea.length) + "</body></html>";
	// Create the iframe
	var iframe = document.createElement("iframe");
	iframe.style.display = "none";
	importer.insertBefore(iframe,importer.firstChild);
	var doc = iframe.document;
	if(iframe.contentDocument)
		doc = iframe.contentDocument; // For NS6
	else if(iframe.contentWindow)
		doc = iframe.contentWindow.document; // For IE5.5 and IE6
	// Put the content in the iframe
	doc.open();
	doc.writeln(content);
	doc.close();
	// Load the content into a TiddlyWiki() object
	var storeArea = doc.getElementById("storeArea");
	var importStore = new TiddlyWiki();
	importStore.loadFromDiv(storeArea,"store");
	// Get rid of the iframe
	iframe.parentNode.removeChild(iframe);
	// Extract data for the listview
	var tiddlers = [];
	importStore.forEachTiddler(function(title,tiddler)
		{
		var t = {};
		t.title = title;
		t.modified = tiddler.modified;
		t.modifier = tiddler.modifier;
		t.text = tiddler.text.substr(0,50);
		t.tags = tiddler.tags;
		tiddlers.push(t);
		});
	// Display the listview
	createTiddlyElement(importer,"h2",null,"step3",config.macros.importTiddlers.step3);
	var step = createTiddlyElement(importer,"div",null,"wizardStep");
	ListView.create(step,tiddlers,config.macros.importTiddlers.listViewTemplate,config.macros.importTiddlers.onSelectCommand);
	// Save the importer
	importer.store = importStore;
}

config.macros.importTiddlers.onSelectCommand = function(listView,command,rowNames)
{
	var importer = findRelated(listView,"importTiddler","className","parentNode");
	switch(command)
		{
		case "import":
			config.macros.importTiddlers.doImport(importer,rowNames);
			break;
		}
	if(config.options.chkAutoSave)
		saveChanges(true);
}

config.macros.importTiddlers.doImport = function(importer,rowNames)
{
	var theStore = importer.store;
	var overwrite = new Array();
	var t;
	for(t=0; t<rowNames.length; t++)
		{
		if(store.tiddlerExists(rowNames[t]))
			overwrite.push(rowNames[t]);
	}
	if(overwrite.length > 0)
		if(!confirm(this.confirmOverwriteText.format([overwrite.join(", ")])))
			return;
	for(t=0; t<rowNames.length; t++)
		{
		var inbound = theStore.fetchTiddler(rowNames[t]);
		store.saveTiddler(inbound.title, inbound.title, inbound.text, inbound.modifier, inbound.modified, inbound.tags);
		store.fetchTiddler(inbound.title).created = inbound.created;
		store.notify(rowNames[t],false);
		}
	store.notifyAll();
	store.setDirty(true);
	createTiddlyElement(importer,"h2",null,"step4",this.step4.format([rowNames.length]));
	var step = createTiddlyElement(importer,"div",null,"wizardStep");
	for(t=0; t<rowNames.length; t++)
		{
		createTiddlyLink(step,rowNames[t],true);
		createTiddlyElement(step,"br");
		}
	createTiddlyElement(importer,"h2",null,"step5",this.step5);
}
// ---------------------------------------------------------------------------------
// Menu and toolbar commands
// ---------------------------------------------------------------------------------

config.commands.closeTiddler.handler = function(event,src,title)
{
	story.closeTiddler(title,true,event.shiftKey || event.altKey);
	return false;
}

config.commands.closeOthers.handler = function(event,src,title)
{
	story.closeAllTiddlers(title);
	return false;
}

config.commands.editTiddler.handler = function(event,src,title)
{
	clearMessage();
	story.displayTiddler(null,title,DEFAULT_EDIT_TEMPLATE);
	story.focusTiddler(title,"text");
	return false;
}

config.commands.saveTiddler.handler = function(event,src,title)
{
	var newTitle = story.saveTiddler(title,event.shiftKey);
	if(newTitle)
	   story.displayTiddler(null,newTitle);
	return false;
}

config.commands.cancelTiddler.handler = function(event,src,title)
{
	if(story.hasChanges(title) && !readOnly)
		if(!confirm(this.warning.format([title])))
			return false;
	story.setDirty(title,false);
	story.displayTiddler(null,title);
	return false;
}

config.commands.deleteTiddler.handler = function(event,src,title)
{
	var deleteIt = true;
	if (config.options.chkConfirmDelete)
		deleteIt = confirm(this.warning.format([title]));
	if (deleteIt)
		{
		store.removeTiddler(title);
		story.closeTiddler(title,true,event.shiftKey || event.altKey);
		if(config.options.chkAutoSave)
			saveChanges();
		}
	return false;
}

config.commands.permalink.handler = function(event,src,title)
{
	var t = encodeURIComponent(String.encodeTiddlyLink(title));
	if(window.location.hash != t)
		window.location.hash = t;
	return false;
}

config.commands.references.handler = function(event,src,title)
{
	var popup = Popup.create(src);
	if(popup)
		{
		var references = store.getReferringTiddlers(title);
		var c = false;
		for(var r=0; r<references.length; r++)
			if(references[r].title != title && !references[r].isTagged("excludeLists"))
				{
				createTiddlyLink(createTiddlyElement(popup,"li"),references[r].title,true);
				c = true;
				}
		if(!c)
			createTiddlyText(createTiddlyElement(popup,"li",null,"disabled"),this.popupNone);
		}
	Popup.show(popup,false);
	event.cancelBubble = true;
	if (event.stopPropagation) event.stopPropagation();
	return false;
}

config.commands.jump.handler = function(event,src,title)
{
	var popup = Popup.create(src);
	if(popup)
		{
		story.forEachTiddler(function(title,element) {
			createTiddlyLink(createTiddlyElement(popup,"li"),title,true);
			});
		}
	Popup.show(popup,false);
	event.cancelBubble = true;
	if (event.stopPropagation) event.stopPropagation();
	return false;
}

// ---------------------------------------------------------------------------------
// Tiddler() object
// ---------------------------------------------------------------------------------

function Tiddler()
{
	this.title = null;
	this.text = null;
	this.modifier = null;
	this.modified = new Date();
	this.created = new Date();
	this.links = [];
	this.linksUpdated = false;
	this.tags = [];
	return this;
}

Tiddler.prototype.getLinks = function()
{
	if(this.linksUpdated==false)
		this.changed();
	return this.links;
}

// Format the text for storage in an RSS item
Tiddler.prototype.saveToRss = function(url)
{
	var s = [];
	s.push("<item>");
	s.push("<title" + ">" + this.title.htmlEncode() + "</title" + ">");
	s.push("<description>" + wikifyStatic(this.text,null,this).htmlEncode() + "</description>");
	for(var t=0; t<this.tags.length; t++)
		s.push("<category>" + this.tags[t] + "</category>");
	s.push("<link>" + url + "#" + encodeURIComponent(String.encodeTiddlyLink(this.title)) + "</link>");
	s.push("<pubDate>" + this.modified.toGMTString() + "</pubDate>");
	s.push("</item>");
	return(s.join("\n"));
}

// Change the text and other attributes of a tiddler
Tiddler.prototype.set = function(title,text,modifier,modified,tags,created,fields)
{
	this.assign(title,text,modifier,modified,tags,created,fields);
	this.changed();
	return this;
}

// Change the text and other attributes of a tiddler without triggered a tiddler.changed() call
Tiddler.prototype.assign = function(title,text,modifier,modified,tags,created,fields)
{
	if(title != undefined)
		this.title = title;
	if(text != undefined)
		this.text = text;
	if(modifier != undefined)
		this.modifier = modifier;
	if(modified != undefined)
		this.modified = modified;
	if(created != undefined)
		this.created = created;
	if(fields != undefined)
		this.fields = fields;
	if(tags != undefined)
		this.tags = (typeof tags == "string") ? tags.readBracketedList() : tags;
	else if(this.tags == undefined)
		this.tags = [];
	return this;
}

// Get the tags for a tiddler as a string (space delimited, using [[brackets]] for tags containing spaces)
Tiddler.prototype.getTags = function()
{
	return String.encodeTiddlyLinkList(this.tags);
}

// Test if a tiddler carries a tag
Tiddler.prototype.isTagged = function(tag)
{
	return this.tags.indexOf(tag) != -1;
}

// Static method to convert "\n" to newlines, "\s" to "\"
Tiddler.unescapeLineBreaks = function(text)
{
	return text ? text.unescapeLineBreaks() : "";
}

// Convert newlines to "\n", "\" to "\s"
Tiddler.prototype.escapeLineBreaks = function()
{
	return this.text.escapeLineBreaks();
}

// Updates the secondary information (like links[] array) after a change to a tiddler
Tiddler.prototype.changed = function()
{
	this.links = [];
	var t = this.autoLinkWikiWords() ? 0 : 1;
	var tiddlerLinkRegExp = t==0 ? config.textPrimitives.tiddlerAnyLinkRegExp : config.textPrimitives.tiddlerForcedLinkRegExp;
	tiddlerLinkRegExp.lastIndex = 0;
	var formatMatch = tiddlerLinkRegExp.exec(this.text);
	while(formatMatch)
		{
		if(t==0 && formatMatch[1] && formatMatch[1] != this.title) // wikiWordLink
			{
			if(formatMatch.index > 0)
				{
				var preRegExp = new RegExp(config.textPrimitives.unWikiLink+"|"+config.textPrimitives.anyLetter,"mg");
				preRegExp.lastIndex = formatMatch.index-1;
				var preMatch = preRegExp.exec(this.text);
				if(preMatch.index != formatMatch.index-1)
					this.links.pushUnique(formatMatch[1]);
				}
			else
				this.links.pushUnique(formatMatch[1]);
			}
		else if(formatMatch[2-t] && (store.tiddlerExists(formatMatch[3-t]) || store.isShadowTiddler(formatMatch[3-t]))) // titledBrackettedLink
			this.links.pushUnique(formatMatch[3-t]);
		else if(formatMatch[4-t] && formatMatch[4-t] != this.title) // brackettedLink
			this.links.pushUnique(formatMatch[4-t]);
		// Do not add link if match urlPattern (formatMatch[5-t])
		formatMatch = tiddlerLinkRegExp.exec(this.text);
		}
	this.linksUpdated = true;
	return;
}

Tiddler.prototype.getSubtitle = function()
{
	var theModifier = this.modifier;
	if(!theModifier)
		theModifier = config.messages.subtitleUnknown;
	var theModified = this.modified;
	if(theModified)
		theModified = theModified.toLocaleString();
	else
		theModified = config.messages.subtitleUnknown;
	return(config.messages.tiddlerLinkTooltip.format([this.title,theModifier,theModified]));
}

Tiddler.prototype.isReadOnly = function()
{
	return readOnly;
}

Tiddler.prototype.autoLinkWikiWords = function()
{
	return !(this.isTagged("systemConfig") || this.isTagged("excludeMissing"));
}

Tiddler.prototype.generateFingerprint = function()
{
	return "0x" + Crypto.hexSha1Str(this.text);
}

// ---------------------------------------------------------------------------------
// TiddlyWiki() object contains Tiddler()s
// ---------------------------------------------------------------------------------

function TiddlyWiki()
{
	var tiddlers = {}; // Hashmap by name of tiddlers
	this.tiddlersUpdated = false;
	this.namedNotifications = []; // Array of {name:,notify:} of notification functions
	this.notificationLevel = 0;
	this.slices = {}; // map tiddlerName->(map sliceName->sliceValue). Lazy.
	this.clear = function() {
		tiddlers = {};
		this.setDirty(false);
		};
	this.fetchTiddler = function(title) {
		return tiddlers[title];
		};
	this.deleteTiddler = function(title) {
		delete this.slices[title];
		delete tiddlers[title];
		};
	this.addTiddler = function(tiddler) {
		delete this.slices[tiddler.title];
		tiddlers[tiddler.title] = tiddler;
		};
	this.forEachTiddler = function(callback) {
		for(var t in tiddlers)
			{
			var tiddler = tiddlers[t];
			if(tiddler instanceof Tiddler)
				callback.call(this,t,tiddler);
			}
		};
}

// Set the dirty flag
TiddlyWiki.prototype.setDirty = function(dirty)
{
	this.dirty = dirty;
}

TiddlyWiki.prototype.isDirty = function()
{
	return this.dirty;
}

TiddlyWiki.prototype.suspendNotifications = function()
{
	this.notificationLevel--;
}

TiddlyWiki.prototype.resumeNotifications = function()
{
	this.notificationLevel++;
}

// Invoke the notification handlers for a particular tiddler
TiddlyWiki.prototype.notify = function(title,doBlanket)
{
	if(!this.notificationLevel)
		for(var t=0; t<this.namedNotifications.length; t++)
			{
			var n = this.namedNotifications[t];
			if((n.name == null && doBlanket) || (n.name == title))
				n.notify(title);
			}
}

// Invoke the notification handlers for all tiddlers
TiddlyWiki.prototype.notifyAll = function()
{
	if(!this.notificationLevel)
		for(var t=0; t<this.namedNotifications.length; t++)
			{
			var n = this.namedNotifications[t];
			if(n.name)
				n.notify(n.name);
			}
}

// Add a notification handler to a tiddler
TiddlyWiki.prototype.addNotification = function(title,fn)
{
	for (var i=0; i<this.namedNotifications.length; i++)
		if((this.namedNotifications[i].name == title) && (this.namedNotifications[i].notify == fn))
			return this;
	this.namedNotifications.push({name: title, notify: fn});
	return this;
}

TiddlyWiki.prototype.removeTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler)
		{
		this.deleteTiddler(title);
		this.notify(title,true);
		this.setDirty(true);
		}
}

TiddlyWiki.prototype.tiddlerExists = function(title)
{
	var t = this.fetchTiddler(title);
	return (t != undefined);
}

TiddlyWiki.prototype.isShadowTiddler = function(title)
{
	return typeof config.shadowTiddlers[title] == "string";
}

TiddlyWiki.prototype.getTiddler = function(title)
{
	var t = this.fetchTiddler(title);
	if(t != undefined)
		return t;
	else
		return null;
}

TiddlyWiki.prototype.getTiddlerText = function(title,defaultText)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler)
		return tiddler.text;
	if(!title)
		return defaultText;
	var pos = title.indexOf(config.textPrimitives.sliceSeparator);
	if(pos != -1)
		{
		var slice = this.getTiddlerSlice(title.substr(0,pos),title.substr(pos + config.textPrimitives.sliceSeparator.length));
		if(slice)
			return slice;
		}
	if(this.isShadowTiddler(title))
		return config.shadowTiddlers[title];
	if(defaultText != undefined)
		return defaultText;
	return null;
}

TiddlyWiki.prototype.slicesRE = /(?:[\'\/]*~?(\w+)[\'\/]*\:[\'\/]*\s*(.*?)\s*$)|(?:\|[\'\/]*~?(\w+)\:?[\'\/]*\|\s*(.*?)\s*\|)/gm

// @internal
TiddlyWiki.prototype.calcAllSlices = function(title) 
{
	var slices = {};
	var text = this.getTiddlerText(title,"");
	this.slicesRE.lastIndex = 0;
	do 
		{
			var m = this.slicesRE.exec(text);
			if (m) 
				{
					if (m[1])
						slices[m[1]] = m[2];
					else
						slices[m[3]] = m[4];
				}
		}
	while(m);
	return slices;
}

// Returns the slice of text of the given name
//#
//# A text slice is a substring in the tiddler's text that is defined
//# either like this
//#    aName:  textSlice
//# or
//#    |aName:| textSlice |
//# or
//#    |aName| textSlice |
//#
//# In the text the name (or name:) may be decorated with '' or //. I.e.
//# this would also a possible text slice:
//#
//#    |''aName:''| textSlice |
//#
//# @param name should only contain "word characters" (i.e. "a-ZA-Z_0-9")
//# @return [may be undefined] the (trimmed) text of the specified slice.
TiddlyWiki.prototype.getTiddlerSlice = function(title,sliceName)
{
	var slices = this.slices[title];
	if (!slices) {
		slices = this.calcAllSlices(title);
		this.slices[title] = slices;
	}
	return slices[sliceName];
}

// Build an hashmap of the specified named slices of a tiddler
TiddlyWiki.prototype.getTiddlerSlices = function(title,sliceNames)
{
	var r = {};
	for(var t=0; t<sliceNames.length; t++)
		{
		var slice = this.getTiddlerSlice(title,sliceNames[t]);
		if(slice)
			r[sliceNames[t]] = slice;
		}
	return r;
}

TiddlyWiki.prototype.getRecursiveTiddlerText = function(title,defaultText,depth)
{
	var bracketRegExp = new RegExp("(?:\\[\\[([^\\]]+)\\]\\])","mg");
	var text = this.getTiddlerText(title,null);
	if(text == null)
		return defaultText;
	var textOut = [];
	var lastPos = 0;
	do {
		var match = bracketRegExp.exec(text);
		if(match)
			{
			textOut.push(text.substr(lastPos,match.index-lastPos));
			if(match[1])
				{
				if(depth <= 0)
					textOut.push(match[1]);
				else
					textOut.push(this.getRecursiveTiddlerText(match[1],"[[" + match[1] + "]]",depth-1));
				}
			lastPos = match.index + match[0].length;
			}
		else
			textOut.push(text.substr(lastPos));
	} while(match);
	return(textOut.join(""));
}

TiddlyWiki.prototype.setTiddlerTag = function(title,status,tag)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler)
		{
		var t = tiddler.tags.indexOf(tag);
		if(t != -1)
			tiddler.tags.splice(t,1);
		if(status)
			tiddler.tags.push(tag);
		tiddler.changed();
		this.notify(title,true);
		this.setDirty(true);
		}
}

TiddlyWiki.prototype.saveTiddler = function(title,newTitle,newBody,modifier,modified,tags,fields)
{
	var tiddler = this.fetchTiddler(title);
	var created;
	if(tiddler)
		{
		created = tiddler.created; // Preserve created date
		this.deleteTiddler(title);
		}
	else
		{
		tiddler = new Tiddler();
		created = modified;
		}
	tiddler.set(newTitle,newBody,modifier,modified,tags,created,fields);
	this.addTiddler(tiddler);
	if(title != newTitle)
		this.notify(title,true);
	this.notify(newTitle,true);
	this.setDirty(true);
	return tiddler;
}

TiddlyWiki.prototype.createTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(!tiddler)
		{
		tiddler = new Tiddler();
		tiddler.title = title;
		this.addTiddler(tiddler);
		this.setDirty(true);
		}
	return tiddler;
}

// Load contents of a tiddlywiki from an HTML DIV
TiddlyWiki.prototype.loadFromDiv = function(src,idPrefix,noUpdate)
{
	this.idPrefix = idPrefix;
	var storeElem = (typeof src == "string") ? document.getElementById(src) : src;
	var tiddlers = this.getLoader().loadTiddlers(this,storeElem.childNodes);
	this.setDirty(false);
	if(!noUpdate)
		{
		for(var i = 0;i<tiddlers.length; i++)
			tiddlers[i].changed();
		}
}

TiddlyWiki.prototype.updateTiddlers = function()
{
	this.tiddlersUpdated = true;
	this.forEachTiddler(function(title,tiddler) {
		tiddler.changed();
		});
}

// Return all tiddlers formatted as an HTML string
TiddlyWiki.prototype.allTiddlersAsHtml = function()
{
	return store.getSaver().externalize(store);
}

// Return an array of tiddlers matching a search regular expression
TiddlyWiki.prototype.search = function(searchRegExp,sortField,excludeTag)
{
	var candidates = this.reverseLookup("tags",excludeTag,false);
	var results = [];
	for(var t=0; t<candidates.length; t++)
		{
		if((candidates[t].title.search(searchRegExp) != -1) || (candidates[t].text.search(searchRegExp) != -1))
			results.push(candidates[t]);
		}
	if(!sortField)
		sortField = "title";
	results.sort(function(a,b) {return a[sortField] < b[sortField] ? -1 : (a[sortField] == b[sortField] ? 0 : +1);});
	return results;
}

// Return an array of all the tags in use. Each member of the array is another array where [0] is the name of the tag and [1] is the number of occurances
TiddlyWiki.prototype.getTags = function()
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		for(var g=0; g<tiddler.tags.length; g++)
			{
			var tag = tiddler.tags[g];
			var f = false;
			for(var c=0; c<results.length; c++)
				if(results[c][0] == tag)
					{
					f = true;
					results[c][1]++;
					}
			if(!f)
				results.push([tag,1]);
			}
		});
	results.sort(function(a,b) {return a[0].toLowerCase() < b[0].toLowerCase() ? -1 : (a[0].toLowerCase() == b[0].toLowerCase() ? 0 : +1);});
	return results;
}

// Return an array of the tiddlers that are tagged with a given tag
TiddlyWiki.prototype.getTaggedTiddlers = function(tag,sortField)
{
	return this.reverseLookup("tags",tag,true,sortField);
}

// Return an array of the tiddlers that link to a given tiddler
TiddlyWiki.prototype.getReferringTiddlers = function(title,unusedParameter,sortField)
{
	if(!this.tiddlersUpdated)
		this.updateTiddlers();
	return this.reverseLookup("links",title,true,sortField);
}

// Return an array of the tiddlers that do or do not have a specified entry in the specified storage array (ie, "links" or "tags")
// lookupMatch == true to match tiddlers, false to exclude tiddlers
TiddlyWiki.prototype.reverseLookup = function(lookupField,lookupValue,lookupMatch,sortField)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		var f = !lookupMatch;
		for(var lookup=0; lookup<tiddler[lookupField].length; lookup++)
			if(tiddler[lookupField][lookup] == lookupValue)
				f = lookupMatch;
		if(f)
			results.push(tiddler);
		});
	if(!sortField)
		sortField = "title";
	results.sort(function(a,b) {return a[sortField] < b[sortField] ? -1 : (a[sortField] == b[sortField] ? 0 : +1);});
	return results;
}

// Return the tiddlers as a sorted array
TiddlyWiki.prototype.getTiddlers = function(field,excludeTag)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		if(excludeTag == undefined || !tiddler.isTagged(excludeTag))
			results.push(tiddler);
		});
	if(field)
		results.sort(function(a,b) {return a[field] < b[field] ? -1 : (a[field] == b[field] ? 0 : +1);});
	return results;
}

// Return array of names of tiddlers that are referred to but not defined
TiddlyWiki.prototype.getMissingLinks = function(sortField)
{
	if(!this.tiddlersUpdated)
		this.updateTiddlers();
	var results = [];
	this.forEachTiddler(function (title,tiddler) {
		for(var n=0; n<tiddler.links.length;n++)
			{
			var link = tiddler.links[n];
			if(this.fetchTiddler(link) == null && !this.isShadowTiddler(link))
				results.pushUnique(link);
			}
		});
	results.sort();
	return results;
}

// Return an array of names of tiddlers that are defined but not referred to
TiddlyWiki.prototype.getOrphans = function()
{
	var results = [];
	this.forEachTiddler(function (title,tiddler) {
		if(this.getReferringTiddlers(title).length == 0 && !tiddler.isTagged("excludeLists"))
			results.push(title);
		});
	results.sort();
	return results;
}

// Return an array of names of all the shadow tiddlers
TiddlyWiki.prototype.getShadowed = function()
{
	var results = [];
	for(var t in config.shadowTiddlers)
		if(typeof config.shadowTiddlers[t] == "string")
			results.push(t);
	results.sort();
	return results;
}

// Resolves a Tiddler reference or tiddler title into a Tiddler object, or null if it doesn't exist
TiddlyWiki.prototype.resolveTiddler = function(tiddler) 
{
	var t = (typeof tiddler == 'string') ? this.getTiddler(tiddler) : tiddler;
	return t instanceof Tiddler ? t : null;
}

TiddlyWiki.prototype.getLoader = function() 
{
	if (!this.loader) 
		this.loader = new TW21Loader();
	return this.loader;
}
 
TiddlyWiki.prototype.getSaver = function() 
{
	if (!this.saver) 
		this.saver = new TW21Saver();
	return this.saver;
}

// Returns true if path is a valid field name (path),
// i.e. a sequence of identifiers, separated by '.'
TiddlyWiki.isValidFieldName = function (name) {
	var match = /[a-zA-Z_]\w*(\.[a-zA-Z_]\w*)*/.exec(name);
	return match && (match[0] == name);
}

// Throws an exception when name is not a valid field name.
TiddlyWiki.checkFieldName = function(name) {
	if (!TiddlyWiki.isValidFieldName(name))
		throw config.messages.invalidFieldName.format([name]);
}

function StringFieldAccess(n, readOnly) {
	this.set = readOnly 
		? function(t,v) {if (v != t[n]) throw config.messages.fieldCannotBeChanged.format([n]);}
		: function(t,v) {if (v != t[n]) {t[n] = v; return true;}};
	this.get = function(t) {return t[n];};
}

function DateFieldAccess(n) {
	this.set = function(t,v) {
			var d = v instanceof Date ? v : Date.convertFromYYYYMMDDHHMM(v); 
			if (d != t[n]) {
				t[n] = d; return true;
			}
		};
	this.get = function(t)   {return t[n].convertToYYYYMMDDHHMM();}
}

function LinksFieldAccess(n) {
	this.set = function(t,v) {
			var s = (typeof v == "string") ? v.readBracketedList() : v; 
			if (s.toString() != t[n].toString()) {
				t[n] = s; return true;
			}
		};
	this.get = function(t)   {return String.encodeTiddlyLinkList(t[n]);}
}

TiddlyWiki.standardFieldAccess = {
	// The set functions return true when setting the data has changed the value.
	
	"title":    new StringFieldAccess("title", true),
	// Handle the "tiddler" field name as the title
	"tiddler":  new StringFieldAccess("title", true),
	
	"text":     new StringFieldAccess("text"),
	"modifier": new StringFieldAccess("modifier"),
	"modified": new DateFieldAccess("modified"),
	"created":  new DateFieldAccess("created"),
	"tags":     new LinksFieldAccess("tags")
};

TiddlyWiki.isStandardField = function(name) {
	return TiddlyWiki.standardFieldAccess[name] != undefined;
}

// Sets the value of the given field of the tiddler to the value. 
// Setting an ExtendedField's value to null or undefined removes the field. 
// Setting a namespace to undefined removes all fields of that namespace.
// The fieldName is case-insensitive.
// All values will be converted to a string value.
TiddlyWiki.prototype.setValue = function(tiddler, fieldName, value) {
	TiddlyWiki.checkFieldName(fieldName);
	var t = this.resolveTiddler(tiddler);
	if (!t)
		return;
		
	fieldName = fieldName.toLowerCase();

	var isRemove = (value === undefined) || (value === null);

	if (!t.fields) 
		t.fields = {};
		
	var accessor = TiddlyWiki.standardFieldAccess[fieldName];
	if (accessor) {
		if (isRemove)
			// don't remove StandardFields
			return;
		var h = TiddlyWiki.standardFieldAccess[fieldName];
		if (!h.set(t, value))
			return;

	} else {
		var oldValue = t.fields[fieldName];
		
		if (isRemove) {
			if (oldValue !== undefined) {
				// deletes a single field
				delete t.fields[fieldName];
			} else {
				// no concrete value is defined for the fieldName
				// so we guess this is a namespace path.
				
				// delete all fields in a namespace
				var re = new RegExp('^'+fieldName+'\\.');
				var dirty = false;
				for (var n in t.fields) {
					if (n.match(re)) {
						delete t.fields[n];
						dirty = true;
					}
				}
				if (!dirty)
					return
			}
				
		} else {
			// the "normal" set case. value is defined (not null/undefined)
			// For convenience provide a nicer conversion Date->String
 			value = value instanceof Date 
				? value.convertToYYYYMMDDHHMMSSMMM() 
				: String(value);
			if (oldValue == value) 
				return;
			t.fields[fieldName] = value;
		}
	}
	
	// When we are here the tiddler/store really was changed.
	this.notify(t.title,true);
	if (!fieldName.match(/^temp\./))
		this.setDirty(true);
}

// Returns the value of the given field of the tiddler. 
// The fieldName is case-insensitive.
// Will only return String values (or undefined).
TiddlyWiki.prototype.getValue = function(tiddler, fieldName) {
	var t = this.resolveTiddler(tiddler);
	if (!t)
		return undefined;

	fieldName = fieldName.toLowerCase();

	var accessor = TiddlyWiki.standardFieldAccess[fieldName];
	if (accessor) {
		return accessor.get(t);
	}
	
	return t.fields ? t.fields[fieldName] : undefined;
}

// Calls the callback function for every field in the tiddler.
//
// When callback function returns a non-false value the iteration stops 
// and that value is returned. 
//
// The order of the fields is not defined.
// 
// @param callback a function(tiddler, fieldName, value). 
// 
TiddlyWiki.prototype.forEachField = function(tiddler, callback, onlyExtendedFields) {
	var t = this.resolveTiddler(tiddler);
	if (!t)
		return undefined;
	
	if (t.fields) {
		for (var n in t.fields) {
			var result = callback(t, n, t.fields[n]);
			if (result)
				return result;
		}
	}
	
	if (onlyExtendedFields)
		return undefined;

	for (var n in TiddlyWiki.standardFieldAccess) {
		if (n == "tiddler")
			// even though the "title" field can also be referenced through the name "tiddler"
			// we only visit this field once.
			continue;
			
		var result = callback(t, n, TiddlyWiki.standardFieldAccess[n].get(t));
		if (result)
			return result;
	}

	return undefined;
};
// ---------------------------------------------------------------------------------
// Story functions
// ---------------------------------------------------------------------------------

// A story is a HTML div containing a sequence of tiddlers that can be manipulated
// container - id of containing element
// idPrefix - string prefix prepended to title to make ids for tiddlers in this story
function Story(container,idPrefix)
{
	this.container = container;
	this.idPrefix = idPrefix;
	this.highlightRegExp = null;
}

// Iterate through all the tiddlers in a story
// fn - callback function to be called for each tiddler. Arguments are:
//		tiddler - reference to Tiddler object
//		element - reference to tiddler display element
Story.prototype.forEachTiddler = function(fn)
{
	var place = document.getElementById(this.container);
	if(!place)
		return;
	var e = place.firstChild;
	while(e)
		{
		var n = e.nextSibling;
		var title = e.getAttribute("tiddler");
		fn.call(this,title,e);
		e = n;
		}
}

// Display several tiddlers given their titles in an array. Parameters same as displayTiddler(), except:
// titles - array of string titles
Story.prototype.displayTiddlers = function(srcElement,titles,template,animate,slowly)
{
	for(var t = titles.length-1;t>=0;t--)
		this.displayTiddler(srcElement,titles[t],template,animate,slowly);
}

// Display a given tiddler with a given template. If the tiddler is already displayed but with a different
// template, it is switched to the specified template
// srcElement - reference to element from which this one is being opened -or-
//              special positions "top", "bottom"
// title - title of tiddler to display
// template - the name of the tiddler containing the template -or-
//			  one of the constants DEFAULT_VIEW_TEMPLATE and DEFAULT_EDIT_TEMPLATE -or-
//			  null or undefined to indicate the current template if there is one, DEFAULT_VIEW_TEMPLATE if not
// animate - whether to perform animations
// slowly - whether to perform animations in slomo
Story.prototype.displayTiddler = function(srcElement,title,template,animate,slowly)
{
	var place = document.getElementById(this.container);
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem)
		this.refreshTiddler(title,template);
	else
		{
		var before = this.positionTiddler(srcElement);
		tiddlerElem = this.createTiddler(place,before,title,template);
		}
	if(srcElement && typeof srcElement !== "string")
		{
		if(anim && config.options.chkAnimate && (animate == undefined || animate == true))
			anim.startAnimating(new Cascade(title,srcElement,tiddlerElem,slowly),new Scroller(tiddlerElem,slowly));
		else
			window.scrollTo(0,ensureVisible(tiddlerElem));
		}
}

// Figure out the appropriate position for a newly opened tiddler
// srcElement - reference to the element containing the link to the tiddler -or-
//              special positions "top", "bottom"
// returns - reference to the tiddler that the new one should appear before (null for the bottom of the story)
Story.prototype.positionTiddler = function(srcElement)
{
	var place = document.getElementById(this.container);
	var before;
	if(typeof srcElement == "string")
		{
		switch(srcElement)
			{
			case "top":
				before = place.firstChild;
				break;
			case "bottom":
				before = null;
				break;
			}
		}
	else
		{
		var after = this.findContainingTiddler(srcElement);
		if(after == null)
			before = place.firstChild;
		else if(after.nextSibling)
			before = after.nextSibling;
		else
			before = null;
		}
	return before;
}

// Create a tiddler frame at the appropriate place in a story column
// place - reference to parent element
// before - null, or reference to element before which to insert new tiddler
// title - title of new tiddler
// template - the name of the tiddler containing the template or one of the constants DEFAULT_VIEW_TEMPLATE and DEFAULT_EDIT_TEMPLATE
Story.prototype.createTiddler = function(place,before,title,template)
{
	var tiddlerElem = createTiddlyElement(null,"div",this.idPrefix + title,"tiddler");
	tiddlerElem.setAttribute("refresh","tiddler");
	place.insertBefore(tiddlerElem,before);
	this.refreshTiddler(title,template);
	return tiddlerElem;
}

// Overridable for choosing the name of the template to apply for a tiddler
Story.prototype.chooseTemplateForTiddler = function(title,template)
{
	if(!template)
		template = DEFAULT_VIEW_TEMPLATE;
	if(template == DEFAULT_VIEW_TEMPLATE || template == DEFAULT_EDIT_TEMPLATE)
		template = config.tiddlerTemplates[template];
	return template;
}

// Overridable for extracting the text of a template from a tiddler
Story.prototype.getTemplateForTiddler = function(title,template,tiddler)
{
	return store.getRecursiveTiddlerText(template,null,10);
}

// Apply a template to an existing tiddler if it is not already displayed using that template
// title - title of tiddler to update
// template - the name of the tiddler containing the template or one of the constants DEFAULT_VIEW_TEMPLATE and DEFAULT_EDIT_TEMPLATE
// force - if true, forces the refresh even if the template hasn't changedd
Story.prototype.refreshTiddler = function(title,template,force)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem)
		{
		if(tiddlerElem.getAttribute("dirty") == "true" && !force)
			return tiddlerElem;
		template = this.chooseTemplateForTiddler(title,template);
		var currTemplate = tiddlerElem.getAttribute("template");
		if((template != currTemplate) || force)
			{
			var tiddler = store.getTiddler(title);
			if(!tiddler)
				{
				tiddler = new Tiddler();
				if(store.isShadowTiddler(title))
					tiddler.set(title,store.getTiddlerText(title),config.views.wikified.shadowModifier,version.date,[],version.date);
				else
					{
					var text = template=="EditTemplate"
								? config.views.editor.defaultText.format([title])
								: config.views.wikified.defaultText.format([title]);
					tiddler.set(title,text,config.views.wikified.defaultModifier,version.date,[],version.date);
					}
				}
			tiddlerElem.setAttribute("tags",tiddler.tags.join(" "));
			tiddlerElem.setAttribute("tiddler",title);
			tiddlerElem.setAttribute("template",template);
			var me = this;
			tiddlerElem.onmouseover = this.onTiddlerMouseOver;
			tiddlerElem.onmouseout = this.onTiddlerMouseOut;
			tiddlerElem.ondblclick = this.onTiddlerDblClick;
			tiddlerElem[window.event?"onkeydown":"onkeypress"] = this.onTiddlerKeyPress;
			var html = this.getTemplateForTiddler(title,template,tiddler);
			tiddlerElem.innerHTML = html;
			applyHtmlMacros(tiddlerElem,tiddler);
			if(store.getTaggedTiddlers(title).length > 0)
				addClass(tiddlerElem,"isTag");
			else
				removeClass(tiddlerElem,"isTag");
			if(!store.tiddlerExists(title))
				{
				if(store.isShadowTiddler(title))
					addClass(tiddlerElem,"shadow");
				else
					addClass(tiddlerElem,"missing");
				}
			else
				{
				removeClass(tiddlerElem,"shadow");
				removeClass(tiddlerElem,"missing");
				}
			}
		}
	return tiddlerElem;
}

// Refresh all tiddlers in the Story
Story.prototype.refreshAllTiddlers = function() 
{
	var place = document.getElementById(this.container);
	var e = place.firstChild;
	if(!e)
		return;
	this.refreshTiddler(e.getAttribute("tiddler"),e.getAttribute("template"),true);
	while((e = e.nextSibling) != null) 
		this.refreshTiddler(e.getAttribute("tiddler"),e.getAttribute("template"),true);
}

// Default tiddler onmouseover/out event handlers
Story.prototype.onTiddlerMouseOver = function(e)
{
	if(window.addClass instanceof Function)
		addClass(this,"selected");
}

Story.prototype.onTiddlerMouseOut = function(e)
{
	if(window.removeClass instanceof Function)
		removeClass(this,"selected");
}

// Default tiddler ondblclick event handler
Story.prototype.onTiddlerDblClick = function(e)
{
	if(!e) var e = window.event;
	var theTarget = resolveTarget(e);
	if(theTarget && theTarget.nodeName.toLowerCase() != "input" && theTarget.nodeName.toLowerCase() != "textarea")
		{
		if(document.selection && document.selection.empty)
			document.selection.empty();
		config.macros.toolbar.invokeCommand(this,"defaultCommand",e);
		e.cancelBubble = true;
		if (e.stopPropagation) e.stopPropagation();
		return true;
		}
	else
		return false;
}

Story.prototype.onTiddlerKeyPress = function(e)
{
	if(!e) var e = window.event;
	clearMessage();
	var consume = false; 
	var title = this.getAttribute("tiddler");
	var target = resolveTarget(e);
	switch(e.keyCode)
		{
		case 9: // Tab
			if(config.options.chkInsertTabs && target.tagName.toLowerCase() == "textarea")
				{
				replaceSelection(target,String.fromCharCode(9));
				consume = true; 
				}
			if(config.isOpera)
				{
				target.onblur = function()
					{
					this.focus();
					this.onblur = null;
					}
				}
			break;
		case 13: // Ctrl-Enter
		case 10: // Ctrl-Enter on IE PC
		case 77: // Ctrl-Enter is "M" on some platforms
			if(e.ctrlKey)
				{
				blurElement(this);
				config.macros.toolbar.invokeCommand(this,"defaultCommand",e);
				consume = true;
				}
			break; 
		case 27: // Escape
			blurElement(this);
			config.macros.toolbar.invokeCommand(this,"cancelCommand",e);
			consume = true;
			break;
		}
	e.cancelBubble = consume;
	if(consume)
		{
		if(e.stopPropagation) e.stopPropagation(); // Stop Propagation
		e.returnValue = true; // Cancel The Event in IE
		if(e.preventDefault ) e.preventDefault(); // Cancel The Event in Moz
		}
	return(!consume);
};

// Returns the specified field (input or textarea element) in a tiddler, otherwise the first edit field it finds
// or null if it found no edit field at all
Story.prototype.getTiddlerField = function(title,field)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	var e = null;
	if(tiddlerElem != null)
		{
		var children = tiddlerElem.getElementsByTagName("*");
		for (var t=0; t<children.length; t++)
			{
			var c = children[t];
			if(c.tagName.toLowerCase() == "input" || c.tagName.toLowerCase() == "textarea")
				{
				if(!e)
					e = c;
				if(c.getAttribute("edit") == field)
					e = c;
				}
			}
		}
	return e;
}

// Focus a specified tiddler. Attempts to focus the specified field, otherwise the first edit field it finds
Story.prototype.focusTiddler = function(title,field)
{
	var e = this.getTiddlerField(title,field);
	if(e)
		{
		e.focus();
		e.select();
		}
}

// Ensures that a specified tiddler does not have the focus
Story.prototype.blurTiddler = function(title)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem != null && tiddlerElem.focus && tiddlerElem.blur)
		{
		tiddlerElem.focus();
		tiddlerElem.blur();
		}
}

// Adds a specified value to the edit controls (if any) of a particular
// array-formatted field of a particular tiddler (eg "tags")
//  title - name of tiddler
//  tag - value of field, without any [[brackets]]
//  mode - +1 to add the tag, -1 to remove it, 0 to toggle it
//  field - name of field (eg "tags")
Story.prototype.setTiddlerField = function(title,tag,mode,field)
{
	var c = story.getTiddlerField(title,field);

	var tags = c.value.readBracketedList();
	tags.setItem(tag,mode);
	c.value = String.encodeTiddlyLinkList(tags);
}

// The same as setTiddlerField but preset to the "tags" field
Story.prototype.setTiddlerTag = function(title,tag,mode)
{
	Story.prototype.setTiddlerField(title,tag,mode,"tags");
}

// Close a specified tiddler
// title - name of tiddler to close
// animate - whether to perform animations
// slowly - whether to perform animations in slomo
Story.prototype.closeTiddler = function(title,animate,slowly)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem != null)
		{
		clearMessage();
		this.scrubTiddler(tiddlerElem);
		if(anim && config.options.chkAnimate && animate)
			anim.startAnimating(new Slider(tiddlerElem,false,slowly,"all"));
		else
			tiddlerElem.parentNode.removeChild(tiddlerElem);
		}
}

// Scrub IDs from a tiddler. This is so that the 'ghost' of a tiddler while it is being closed
// does not interfere with things
// tiddler - reference to the tiddler element
Story.prototype.scrubTiddler = function(tiddlerElem)
{
	tiddlerElem.id = null;
}

// Set the 'dirty' flag of a tiddler
// title - title of tiddler to change
// dirty - new boolean status of flag
Story.prototype.setDirty = function(title,dirty)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem != null)
		tiddlerElem.setAttribute("dirty",dirty ? "true" : "false");
}

// Is a particular tiddler dirty (with unsaved changes)?
Story.prototype.isDirty = function(title)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem != null)
		return tiddlerElem.getAttribute("dirty") == "true";
	return null;
}

// Determine whether any open tiddler are dirty
Story.prototype.areAnyDirty = function()
{
	var r = false;
	this.forEachTiddler(function(title,element) {
		if(this.isDirty(title))
			r = true;
		});
	return r;
}

// Close all tiddlers in the story
Story.prototype.closeAllTiddlers = function(exclude)
{
	clearMessage();
	this.forEachTiddler(function(title,element) {
		if((title != exclude) && element.getAttribute("dirty") != "true")
			this.closeTiddler(title);
		});
	window.scrollTo(0,0);
}

// Check if there are any tiddlers in the story
Story.prototype.isEmpty = function()
{
	var place = document.getElementById(this.container);
	return(place && place.firstChild == null);
}

// Perform a search and display the result
// text - text to search for
// useCaseSensitive - true for case sensitive matching
// useRegExp - true to interpret text as a RegExp
Story.prototype.search = function(text,useCaseSensitive,useRegExp)
{
	this.closeAllTiddlers();
	highlightHack = new RegExp(useRegExp ?	 text : text.escapeRegExp(),useCaseSensitive ? "mg" : "img");
	var matches = store.search(highlightHack,"title","excludeSearch");
	var titles = [];
	for(var t=matches.length-1; t>=0; t--)
		titles.push(matches[t].title);
	this.displayTiddlers(null,titles);
	highlightHack = null;
	var q = useRegExp ? "/" : "'";
	if(matches.length > 0)
		displayMessage(config.macros.search.successMsg.format([titles.length.toString(),q + text + q]));
	else
		displayMessage(config.macros.search.failureMsg.format([q + text + q]));
}

// Determine if the specified element is within a tiddler in this story
// e - reference to an element
// returns: reference to a tiddler element or null if none
Story.prototype.findContainingTiddler = function(e)
{
	while(e && !hasClass(e,"tiddler"))
		e = e.parentNode;
	return(e);
}

// Gather any saveable fields from a tiddler element
// e - reference to an element to scan recursively
// fields - object to contain gathered field values
Story.prototype.gatherSaveFields = function(e,fields)
{
	if(e && e.getAttribute)
		{
		var f = e.getAttribute("edit");
		if(f)
			fields[f] = e.value.replace(/\r/mg,"");;
		if(e.hasChildNodes())
			{
			var c = e.childNodes;
			for(var t=0; t<c.length; t++)
				this.gatherSaveFields(c[t],fields)
			}
		}
}

// Determine whether a tiddler has any edit fields, and if so if their values have been changed
// title - name of tiddler
Story.prototype.hasChanges = function(title)
{
	var e = document.getElementById(this.idPrefix + title);
	if(e != null)
		{
		var fields = {};
		this.gatherSaveFields(e,fields);
		var tiddler = store.fetchTiddler(title);
		if (!tiddler)
			return false;
		for(var n in fields)
			if (store.getValue(title,n) != fields[n])
				return true;
		}
	return false;
}

// Save any open edit fields of a tiddler and updates the display as necessary
// title - name of tiddler
// minorUpdate - true if the modified date shouldn't be updated
// returns: title of saved tiddler, or null if not saved
Story.prototype.saveTiddler = function(title,minorUpdate)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem != null)
		{
		var fields = {};
		this.gatherSaveFields(tiddlerElem,fields);
		var newTitle = fields.title ? fields.title : title;
		if(store.tiddlerExists(newTitle) && newTitle != title)
			{
			if(confirm(config.messages.overwriteWarning.format([newTitle.toString()])))
				this.closeTiddler(newTitle,false,false);
			else
				return null;
			}
		tiddlerElem.id = this.idPrefix + newTitle;
		tiddlerElem.setAttribute("tiddler",newTitle);
		tiddlerElem.setAttribute("template",DEFAULT_VIEW_TEMPLATE);
		tiddlerElem.setAttribute("dirty","false");
		if(config.options.chkForceMinorUpdate)
			minorUpdate = !minorUpdate;
		var newDate = new Date();
		store.saveTiddler(title,newTitle,fields.text,config.options.txtUserName,minorUpdate ? undefined : newDate,fields.tags);
		for (var n in fields) 
			if (!TiddlyWiki.isStandardField(n))
				store.setValue(newTitle,n,fields[n]);
		if(config.options.chkAutoSave)
			saveChanges();
		return newTitle;
		}
	return null;
}

Story.prototype.permaView = function()
{
	var links = [];
	this.forEachTiddler(function(title,element) {
		links.push(String.encodeTiddlyLink(title));
		});
	var t = encodeURIComponent(links.join(" "));
	if(t == "")
		t = "#";
	if(window.location.hash != t)
		window.location.hash = t;
}

// ---------------------------------------------------------------------------------
// Message area
// ---------------------------------------------------------------------------------

function getMessageDiv()
{
	var msgArea = document.getElementById("messageArea");
	if(!msgArea)
		return null;
	if(!msgArea.hasChildNodes())
		createTiddlyButton(createTiddlyElement(msgArea,"div",null,"messageToolbar"),
			config.messages.messageClose.text,
			config.messages.messageClose.tooltip,
			clearMessage);
	msgArea.style.display = "block";
	return createTiddlyElement(msgArea,"div");
}

function displayMessage(text,linkText)
{
	var e = getMessageDiv();
	if(!e)
		{
		alert(text);
		return;
		}
	if(linkText)
		{
		var link = createTiddlyElement(e,"a",null,null,text);
		link.href = linkText;
		link.target = "_blank";
		}
	else
		e.appendChild(document.createTextNode(text));
}

function clearMessage()
{
	var msgArea = document.getElementById("messageArea");
	if(msgArea)
		{
		removeChildren(msgArea);
		msgArea.style.display = "none";
		}
	return false;
}

// ---------------------------------------------------------------------------------
// Refresh mechanism
// ---------------------------------------------------------------------------------

config.refreshers = {
	link: function(e,changeList)
		{
		var title = e.getAttribute("tiddlyLink");
		refreshTiddlyLink(e,title);
		return true;
		},
	
	tiddler: function(e,changeList)
		{
		var title = e.getAttribute("tiddler");
		var template = e.getAttribute("template");
		if(changeList && changeList.indexOf(title) != -1 && !story.isDirty(title))
			story.refreshTiddler(title,template,true);
		else
			refreshElements(e,changeList);
		return true;
		},

	content: function(e,changeList)
		{
		var title = e.getAttribute("tiddler");
		var force = e.getAttribute("force");
		if(force != null || changeList == null || changeList.indexOf(title) != -1)
			{
			removeChildren(e);
			wikify(store.getTiddlerText(title,title),e);
			return true;
			}
		else
			return false;
		},

	macro: function(e,changeList)
		{
		var macro = e.getAttribute("macroName");
		var params = e.getAttribute("params");
		if(macro)
			macro = config.macros[macro];
		if(macro && macro.refresh)
			macro.refresh(e,params);
		return true;
		}
};

function refreshElements(root,changeList)
{
	var nodes = root.childNodes;
	for(var c=0; c<nodes.length; c++)
		{
		var e = nodes[c],type;
		if(e.getAttribute)
			type = e.getAttribute("refresh");
		else
			type = null;
		var refresher = config.refreshers[type];
		var refreshed = false;
		if(refresher != undefined)
			refreshed = refresher(e,changeList);
		if(e.hasChildNodes() && !refreshed)
			refreshElements(e,changeList);
		}
}

function applyHtmlMacros(root,tiddler)
{
	var e = root.firstChild;
	while(e)
		{
		var nextChild = e.nextSibling;
		if(e.getAttribute)
			{
			var macro = e.getAttribute("macro");
			if(macro)
				{
				var params = "";
				var p = macro.indexOf(" ");
				if(p != -1)
					{
					params = macro.substr(p+1);
					macro = macro.substr(0,p);
					}
				invokeMacro(e,macro,params,null,tiddler);
				}
			}
		if(e.hasChildNodes())
			applyHtmlMacros(e,tiddler);
		e = nextChild;
		}
}

function refreshPageTemplate(title)
{
	var stash = createTiddlyElement(document.body,"div");
	stash.style.display = "none";
	var display = document.getElementById("tiddlerDisplay");
	var nodes,t;
	if(display)
		{
		nodes = display.childNodes;
		for(t=nodes.length-1; t>=0; t--)
			stash.appendChild(nodes[t]);
		}
	var wrapper = document.getElementById("contentWrapper");
	if(!title)
		title = "PageTemplate";
	var html = store.getRecursiveTiddlerText(title,null,10);
	wrapper.innerHTML = html;
	applyHtmlMacros(wrapper);
	refreshElements(wrapper);
	display = document.getElementById("tiddlerDisplay");
	removeChildren(display);
	if(!display)
		display = createTiddlyElement(wrapper,"div","tiddlerDisplay");
	nodes = stash.childNodes;
	for(t=nodes.length-1; t>=0; t--)
		display.appendChild(nodes[t]);
	stash.parentNode.removeChild(stash);
}

function refreshDisplay(hint)
{
	var e = document.getElementById("contentWrapper");
	if(typeof hint == "string")
		hint = [hint];
	refreshElements(e,hint);
}

function refreshPageTitle()
{
	document.title = wikifyPlain("SiteTitle") + " - " + wikifyPlain("SiteSubtitle");
}

function refreshStyles(title)
{
	setStylesheet(title == null ? "" : store.getRecursiveTiddlerText(title,"",10),title);
}

function refreshColorPalette(title)
{
	if(!startingUp)
		refreshAll();
}

function refreshAll()
{
	refreshPageTemplate();
	refreshDisplay();
	refreshStyles("StyleSheetLayout");
	refreshStyles("StyleSheetColors");
	refreshStyles("StyleSheet");
	refreshStyles("StyleSheetPrint");
}

// ---------------------------------------------------------------------------------
// Options cookie stuff
// ---------------------------------------------------------------------------------

function loadOptionsCookie()
{
	if(safeMode)
		return;
	var cookies = document.cookie.split(";");
	for(var c=0; c<cookies.length; c++)
		{
		var p = cookies[c].indexOf("=");
		if(p != -1)
			{
			var name = cookies[c].substr(0,p).trim();
			var value = cookies[c].substr(p+1).trim();
			switch(name.substr(0,3))
				{
				case "txt":
					config.options[name] = unescape(value);
					break;
				case "chk":
					config.options[name] = value == "true";
					break;
				}
			}
		}
}

function saveOptionCookie(name)
{
	if(safeMode)
		return;
	var c = name + "=";
	switch(name.substr(0,3))
		{
		case "txt":
			c += escape(config.options[name].toString());
			break;
		case "chk":
			c += config.options[name] ? "true" : "false";
			break;
		}
	c += "; expires=Fri, 1 Jan 2038 12:00:00 UTC; path=/";
	document.cookie = c;
}

// ---------------------------------------------------------------------------------
// Saving
// ---------------------------------------------------------------------------------

var saveUsingSafari = false;

var startSaveArea = '<div id="' + 'storeArea">'; // Split up into two so that indexOf() of this source doesn't find it
var endSaveArea = '</d' + 'iv>';

// If there are unsaved changes, force the user to confirm before exitting
function confirmExit()
{
	hadConfirmExit = true;
	if((store && store.isDirty && store.isDirty()) || (story && story.areAnyDirty && story.areAnyDirty()))
		return config.messages.confirmExit;
}

// Give the user a chance to save changes before exitting
function checkUnsavedChanges()
{
	if(store && store.isDirty && store.isDirty() && window.hadConfirmExit === false)
		{
		if(confirm(config.messages.unsavedChangesWarning))
			saveChanges();
		}
}

function updateMarkupBlock(s,blockName,tiddlerName)
{
	return s.replaceChunk(
			"<!--%0-START-->".format([blockName]),
			"<!--%0-END-->".format([blockName]),
			"\n" + store.getRecursiveTiddlerText(tiddlerName,"") + "\n");
}

// Save this tiddlywiki with the pending changes
function saveChanges(onlyIfDirty)
{
	if(onlyIfDirty && !store.isDirty())
		return;
	clearMessage();
	// Get the URL of the document
	var originalPath = document.location.toString();
	// Check we were loaded from a file URL
	if(originalPath.substr(0,5) != "file:")
		{
		alert(config.messages.notFileUrlError);
		if(store.tiddlerExists(config.messages.saveInstructions))
			story.displayTiddler(null,config.messages.saveInstructions);
		return;
		}
	var localPath = getLocalPath(originalPath);
	// Load the original file
	var original = loadFile(localPath);
	if(original == null)
		{
		alert(config.messages.cantSaveError);
		if(store.tiddlerExists(config.messages.saveInstructions))
			story.displayTiddler(null,config.messages.saveInstructions);
		return;
		}
	// Locate the storeArea div's
	var posOpeningDiv = original.indexOf(startSaveArea);
	var limitClosingDiv = original.indexOf("<!--POST-BODY-START--"+">");
	var posClosingDiv = original.lastIndexOf(endSaveArea,limitClosingDiv == -1 ? original.length : limitClosingDiv);
	if((posOpeningDiv == -1) || (posClosingDiv == -1))
		{
		alert(config.messages.invalidFileError.format([localPath]));
		return;
		}
	// Save the backup
	if(config.options.chkSaveBackups)
		{
		var backupPath = getBackupPath(localPath);
		var backup = saveFile(backupPath,original);
		if(backup)
			displayMessage(config.messages.backupSaved,"file://" + backupPath);
		else
			alert(config.messages.backupFailed);
		}
	// Save Rss
	if(config.options.chkGenerateAnRssFeed)
		{
		var rssPath = localPath.substr(0,localPath.lastIndexOf(".")) + ".xml";
		var rssSave = saveFile(rssPath,convertUnicodeToUTF8(generateRss()));
		if(rssSave)
			displayMessage(config.messages.rssSaved,"file://" + rssPath);
		else
			alert(config.messages.rssFailed);
		}
	// Save empty template
	if(config.options.chkSaveEmptyTemplate)
		{
		var emptyPath,p;
		if((p = localPath.lastIndexOf("/")) != -1)
			emptyPath = localPath.substr(0,p) + "/empty.html";
		else if((p = localPath.lastIndexOf("\\")) != -1)
			emptyPath = localPath.substr(0,p) + "\\empty.html";
		else
			emptyPath = localPath + ".empty.html";
		var empty = original.substr(0,posOpeningDiv + startSaveArea.length) + original.substr(posClosingDiv);
		var emptySave = saveFile(emptyPath,empty);
		if(emptySave)
			displayMessage(config.messages.emptySaved,"file://" + emptyPath);
		else
			alert(config.messages.emptyFailed);
		}
	var save;
	try 
		{
		// Save new file
		var revised = original.substr(0,posOpeningDiv + startSaveArea.length) + "\n" +
					convertUnicodeToUTF8(store.allTiddlersAsHtml()) + "\n" +
					original.substr(posClosingDiv);
		var newSiteTitle = convertUnicodeToUTF8((wikifyPlain("SiteTitle") + " - " + wikifyPlain("SiteSubtitle")).htmlEncode());
		revised = revised.replaceChunk("<title"+">","</title"+">"," " + newSiteTitle + " ");
		revised = updateMarkupBlock(revised,"PRE-HEAD","MarkupPreHead");
		revised = updateMarkupBlock(revised,"POST-HEAD","MarkupPostHead");
		revised = updateMarkupBlock(revised,"PRE-BODY","MarkupPreBody");
		revised = updateMarkupBlock(revised,"POST-BODY","MarkupPostBody");
		save = saveFile(localPath,revised);
		}
	catch (e) 
		{
		showException(e);
		}
	if(save)
		{
		displayMessage(config.messages.mainSaved,"file://" + localPath);
		store.setDirty(false);
		}
	else
		alert(config.messages.mainFailed);
}

function getLocalPath(originalPath)
{
	// Remove any location or query part of the URL
	var argPos = originalPath.indexOf("?");
	if(argPos != -1)
		originalPath = originalPath.substr(0,argPos);
	var hashPos = originalPath.indexOf("#");
	if(hashPos != -1)
		originalPath = originalPath.substr(0,hashPos);
	// Convert file://localhost/ to file:///
	if(originalPath.indexOf("file://localhost/") == 0)
		originalPath = "file://" + originalPath.substr(16);
	// Convert to a native file format assuming
	// "file:///x:/path/path/path..." - pc local file --> "x:\path\path\path..."
	// "file://///server/share/path/path/path..." - FireFox pc network file --> "\\server\share\path\path\path..."
	// "file:///path/path/path..." - mac/unix local file --> "/path/path/path..."
	// "file://server/share/path/path/path..." - pc network file --> "\\server\share\path\path\path..."
	var localPath;
	if(originalPath.charAt(9) == ":") // pc local file
		localPath = unescape(originalPath.substr(8)).replace(new RegExp("/","g"),"\\");
	else if(originalPath.indexOf("file://///") == 0) // FireFox pc network file
		localPath = "\\\\" + unescape(originalPath.substr(10)).replace(new RegExp("/","g"),"\\");
	else if(originalPath.indexOf("file:///") == 0) // mac/unix local file
		localPath = unescape(originalPath.substr(7));
	else if(originalPath.indexOf("file:/") == 0) // mac/unix local file
		localPath = unescape(originalPath.substr(5));
	else // pc network file
		localPath = "\\\\" + unescape(originalPath.substr(7)).replace(new RegExp("/","g"),"\\");
	return localPath;
}

function getBackupPath(localPath)
{
	var backSlash = true;
	var dirPathPos = localPath.lastIndexOf("\\");
	if(dirPathPos == -1)
		{
		dirPathPos = localPath.lastIndexOf("/");
		backSlash = false;
		}
	var backupFolder = config.options.txtBackupFolder;
	if(!backupFolder || backupFolder == "")
		backupFolder = ".";
	var backupPath = localPath.substr(0,dirPathPos) + (backSlash ? "\\" : "/") + backupFolder + localPath.substr(dirPathPos);
	backupPath = backupPath.substr(0,backupPath.lastIndexOf(".")) + "." + (new Date()).convertToYYYYMMDDHHMMSSMMM() + ".html";
	return backupPath;
}

function generateRss()
{
	var s = [];
	var d = new Date();
	var u = store.getTiddlerText("SiteUrl");
	// Assemble the header
	s.push("<" + "?xml version=\"1.0\"?" + ">");
	s.push("<rss version=\"2.0\">");
	s.push("<channel>");
	s.push("<title" + ">" + wikifyPlain("SiteTitle").htmlEncode() + "</title" + ">");
	if(u)
		s.push("<link>" + u.htmlEncode() + "</link>");
	s.push("<description>" + wikifyPlain("SiteSubtitle").htmlEncode() + "</description>");
	s.push("<language>en-us</language>");
	s.push("<copyright>Copyright " + d.getFullYear() + " " + config.options.txtUserName.htmlEncode() + "</copyright>");
	s.push("<pubDate>" + d.toGMTString() + "</pubDate>");
	s.push("<lastBuildDate>" + d.toGMTString() + "</lastBuildDate>");
	s.push("<docs>http://blogs.law.harvard.edu/tech/rss</docs>");
	s.push("<generator>TiddlyWiki " + version.major + "." + version.minor + "." + version.revision + "</generator>");
	// The body
	var tiddlers = store.getTiddlers("modified","excludeLists");
	var n = config.numRssItems > tiddlers.length ? 0 : tiddlers.length-config.numRssItems;
	for (var t=tiddlers.length-1; t>=n; t--)
		s.push(tiddlers[t].saveToRss(u));
	// And footer
	s.push("</channel>");
	s.push("</rss>");
	// Save it all
	return s.join("\n");
}


// UTF-8 encoding rules:
// 0x0000 - 0x007F:	0xxxxxxx
// 0x0080 - 0x07FF:	110xxxxx 10xxxxxx
// 0x0800 - 0xFFFF:	1110xxxx 10xxxxxx 10xxxxxx

function convertUTF8ToUnicode(u)
{
	if(window.netscape == undefined)
		return manualConvertUTF8ToUnicode(u);
	else
		return mozConvertUTF8ToUnicode(u);
}

function manualConvertUTF8ToUnicode(utf)
{
	var uni = utf;
	var src = 0;
	var dst = 0;
	var b1, b2, b3;
	var c;
	while(src < utf.length)
		{
		b1 = utf.charCodeAt(src++);
		if(b1 < 0x80)
			dst++;
		else if(b1 < 0xE0)
			{
			b2 = utf.charCodeAt(src++);
			c = String.fromCharCode(((b1 & 0x1F) << 6) | (b2 & 0x3F));
			uni = uni.substring(0,dst++).concat(c,utf.substr(src));
			}
		else
			{
			b2 = utf.charCodeAt(src++);
			b3 = utf.charCodeAt(src++);
			c = String.fromCharCode(((b1 & 0xF) << 12) | ((b2 & 0x3F) << 6) | (b3 & 0x3F));
			uni = uni.substring(0,dst++).concat(c,utf.substr(src));
			}
	}
	return(uni);
}

function mozConvertUTF8ToUnicode(u)
{
	try
		{
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);
		converter.charset = "UTF-8";
		}
	catch(e)
		{
		return manualConvertUTF8ToUnicode(u);
		} // fallback
	var s = converter.ConvertToUnicode(u);
	var fin = converter.Finish();
	return (fin.length > 0) ? s+fin : s;
}

function convertUnicodeToUTF8(s)
{
	if(window.netscape == undefined)
		return manualConvertUnicodeToUTF8(s);
	else
		return mozConvertUnicodeToUTF8(s);
}

function manualConvertUnicodeToUTF8(s)
{
	var re = /[^\u0000-\u007F]/g ;
	return s.replace(re, function($0) {return("&#" + $0.charCodeAt(0).toString() + ";");})
}

function mozConvertUnicodeToUTF8(s)
{
	try
		{
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);
		converter.charset = "UTF-8";
		}
	catch(e)
		{
		return manualConvertUnicodeToUTF8(s);
		} // fallback
	var u = converter.ConvertFromUnicode(s);
	var fin = converter.Finish();
	if(fin.length > 0)
		return u + fin;
	else
		return u;
}

function saveFile(fileUrl, content)
{
	var r = null;
	if((r == null) || (r == false))
		r = mozillaSaveFile(fileUrl, content);
	if((r == null) || (r == false))
		r = ieSaveFile(fileUrl, content);
	if((r == null) || (r == false))
		r = javaSaveFile(fileUrl, content);
	return(r);
}

function loadFile(fileUrl)
{
	var r = null;
	if((r == null) || (r == false))
		r = mozillaLoadFile(fileUrl);
	if((r == null) || (r == false))
		r = ieLoadFile(fileUrl);
	if((r == null) || (r == false))
		r = javaLoadFile(fileUrl);
	return(r);
}

// Returns null if it can't do it, false if there's an error, true if it saved OK
function ieSaveFile(filePath, content)
{
	try
		{
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		}
	catch(e)
		{
		//alert("Exception while attempting to save\n\n" + e.toString());
		return(null);
		}
	var file = fso.OpenTextFile(filePath,2,-1,0);
	file.Write(content);
	file.Close();
	return(true);
}

// Returns null if it can't do it, false if there's an error, or a string of the content if successful
function ieLoadFile(filePath)
{
	try
		{
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		var file = fso.OpenTextFile(filePath,1);
		var content = file.ReadAll();
		file.Close();
		}
	catch(e)
		{
		//alert("Exception while attempting to load\n\n" + e.toString());
		return(null);
		}
	return(content);
}

// Returns null if it can't do it, false if there's an error, true if it saved OK
function mozillaSaveFile(filePath, content)
{
	if(window.Components)
		try
			{
			netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
			var file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
			file.initWithPath(filePath);
			if (!file.exists())
				file.create(0, 0664);
			var out = Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);
			out.init(file, 0x20 | 0x02, 00004,null);
			out.write(content, content.length);
			out.flush();
			out.close();
			return(true);
			}
		catch(e)
			{
			//alert("Exception while attempting to save\n\n" + e);
			return(false);
			}
	return(null);
}

// Returns null if it can't do it, false if there's an error, or a string of the content if successful
function mozillaLoadFile(filePath)
{
	if(window.Components)
		try
			{
			netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
			var file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
			file.initWithPath(filePath);
			if (!file.exists())
				return(null);
			var inputStream = Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream);
			inputStream.init(file, 0x01, 00004, null);
			var sInputStream = Components.classes["@mozilla.org/scriptableinputstream;1"].createInstance(Components.interfaces.nsIScriptableInputStream);
			sInputStream.init(inputStream);
			return(sInputStream.read(sInputStream.available()));
			}
		catch(e)
			{
			//alert("Exception while attempting to load\n\n" + e);
			return(false);
			}
	return(null);
}

function javaUrlToFilename(url)
{
	var f = "//localhost";
	if(url.indexOf(f) == 0)
		return url.substring(f.length);
	var i = url.indexOf(":");
	if(i > 0)
		return url.substring(i-1);
	return url;
}

function javaSaveFile(filePath, content)
{
	try
		{
		if(document.applets["TiddlySaver"])
			return document.applets["TiddlySaver"].saveFile(javaUrlToFilename(filePath),"UTF-8",content);
		}
	catch(e)
		{
		}
	try
		{
		var s = new java.io.PrintStream(new java.io.FileOutputStream(javaUrlToFilename(filePath)));
		s.print(content);
		s.close();
		}
	catch(e)
		{
		return null;
		}
	return true;
}

function javaLoadFile(filePath)
{
	try
		{
	if(document.applets["TiddlySaver"])
		return String(document.applets["TiddlySaver"].loadFile(javaUrlToFilename(filePath),"UTF-8"));
		}
	catch(e)
		{
		}
	var content = [];
	try
		{
		var r = new java.io.BufferedReader(new java.io.FileReader(javaUrlToFilename(filePath)));
		var line;
		while ((line = r.readLine()) != null)
			content.push(new String(line));
		r.close();
		}
	catch(e)
		{
		return null;
		}
	return content.join("\n");
}


// ---------------------------------------------------------------------------------
// Remote HTTP requests
// ---------------------------------------------------------------------------------

// Load a file over http
//   url - the source url
//   callback - function to call when there's a response
//   params - parameter object that gets passed to the callback for storing it's state
// Return value is the underlying XMLHttpRequest object, or 'null' if there was an error
// Callback function is called like this:
//   callback(status,params,responseText,xhr)
//     status - true if OK, false if error
//     params - the parameter object provided to loadRemoteFile()
//     responseText - the text of the file
//     xhr - the underlying XMLHttpRequest object
function loadRemoteFile(url,callback,params)
{
	// Get an xhr object
	var x;
	try
		{
		x = new XMLHttpRequest(); // Modern
		}
	catch(e)
		{
		try
			{
			x = new ActiveXObject("Msxml2.XMLHTTP"); // IE 6
			}
		catch (e)
			{
			return null;
			}
		}
	// Install callback
	x.onreadystatechange = function()
		{
		if (x.readyState == 4)
			{
			if ((x.status == 0 || x.status == 200) && callback)
				{
				callback(true,params,x.responseText,url,x);
			}
			else
				callback(false,params,null,url,x);
			}
		}
	// Send request
	if(window.netscape && window.netscape.security && document.location.protocol.indexOf("http") == -1)
		window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
	try
		{
		url = url + (url.indexOf("?") < 0 ? "?" : "&") + "nocache=" + Math.random();
		x.open("GET",url,true);
		if (x.overrideMimeType)
			x.overrideMimeType("text/html");
		x.send(null);
		}
	catch (e)
		{
		alert("Error in send " + e);
		return null;
		}
	return x;
}
// ---------------------------------------------------------------------------------
// TiddlyWiki-specific utility functions
// ---------------------------------------------------------------------------------

function createTiddlyButton(theParent,theText,theTooltip,theAction,theClass,theId,theAccessKey)
{
	var theButton = document.createElement("a");
	if(theAction)
		{
		theButton.onclick = theAction;
		theButton.setAttribute("href","javascript:;");
		}
	if(theTooltip)
		theButton.setAttribute("title",theTooltip);
	if(theText)
		theButton.appendChild(document.createTextNode(theText));
	if(theClass)
		theButton.className = theClass;
	else
		theButton.className = "button";
	if(theId)
		theButton.id = theId;
	if(theParent)
		theParent.appendChild(theButton);
	if(theAccessKey)
		theButton.setAttribute("accessKey",theAccessKey);
	return(theButton);
}

function createTiddlyLink(place,title,includeText,theClass,isStatic)
{
	var text = includeText ? title : null;
	var i = getTiddlyLinkInfo(title,theClass)
	var btn;
	if(isStatic)
		btn = createExternalLink(place,"#" + title);
	else
		btn = createTiddlyButton(place,text,i.subTitle,onClickTiddlerLink,i.classes);
	btn.setAttribute("refresh","link");
	btn.setAttribute("tiddlyLink",title);
	return(btn);
}

function refreshTiddlyLink(e,title)
{
	var i = getTiddlyLinkInfo(title,e.className);
	e.className = i.classes;
	e.title = i.subTitle;
}

function getTiddlyLinkInfo(title,currClasses)
{
	var classes = currClasses ? currClasses.split(" ") : [];
	classes.pushUnique("tiddlyLink");
	var tiddler = store.fetchTiddler(title);
	var subTitle;
	if(tiddler)
		{
		subTitle = tiddler.getSubtitle();
		classes.pushUnique("tiddlyLinkExisting");
		classes.remove("tiddlyLinkNonExisting");
		classes.remove("shadow");
		}
	else
		{
		classes.remove("tiddlyLinkExisting");
		classes.pushUnique("tiddlyLinkNonExisting");
		if(store.isShadowTiddler(title))
			{
			subTitle = config.messages.shadowedTiddlerToolTip.format([title]);
			classes.pushUnique("shadow");
			}
		else
			{
			subTitle = config.messages.undefinedTiddlerToolTip.format([title]);
			classes.remove("shadow");
			}
		}
	return {classes: classes.join(" "), subTitle: subTitle};
}

function createExternalLink(place,url)
{
	var theLink = document.createElement("a");
	theLink.className = "externalLink";
	theLink.href = url;
	theLink.title = config.messages.externalLinkTooltip.format([url]);
	if(config.options.chkOpenInNewWindow)
		theLink.target = "_blank";
	place.appendChild(theLink);
	return(theLink);
}

// Event handler for clicking on a tiddly link
function onClickTiddlerLink(e)
{
	if (!e) var e = window.event;
	var theTarget = resolveTarget(e);
	var theLink = theTarget;
	var title = null;
	do {
		title = theLink.getAttribute("tiddlyLink");
		theLink = theLink.parentNode;
	} while(title == null && theLink != null);
	if(title)
		{
		var toggling = e.metaKey || e.ctrlKey;
		if(config.options.chkToggleLinks)
			toggling = !toggling;
		var opening;
		if(toggling && document.getElementById("tiddler" + title))
			story.closeTiddler(title,true,e.shiftKey || e.altKey);
		else
			story.displayTiddler(theTarget,title,null,true,e.shiftKey || e.altKey);
		}
	clearMessage();
	return(false);
}

// Create a button for a tag with a popup listing all the tiddlers that it tags
function createTagButton(place,tag,excludeTiddler)
{
	var theTag = createTiddlyButton(place,tag,config.views.wikified.tag.tooltip.format([tag]),onClickTag);
	theTag.setAttribute("tag",tag);
	if(excludeTiddler)
		theTag.setAttribute("tiddler",excludeTiddler);
	return(theTag);
}

// Event handler for clicking on a tiddler tag
function onClickTag(e)
{
	if (!e) var e = window.event;
	var theTarget = resolveTarget(e);
	var popup = Popup.create(this);
	var tag = this.getAttribute("tag");
	var title = this.getAttribute("tiddler");
	if(popup && tag)
		{
		var tagged = store.getTaggedTiddlers(tag);
		var titles = [];
		var li,r;
		for(r=0;r<tagged.length;r++)
			if(tagged[r].title != title)
				titles.push(tagged[r].title);
		var lingo = config.views.wikified.tag;
		if(titles.length > 0)
			{
			var openAll = createTiddlyButton(createTiddlyElement(popup,"li"),lingo.openAllText.format([tag]),lingo.openAllTooltip,onClickTagOpenAll);
			openAll.setAttribute("tag",tag);
			createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
			for(r=0; r<titles.length; r++)
				{
				createTiddlyLink(createTiddlyElement(popup,"li"),titles[r],true);
				}
			}
		else
			createTiddlyText(createTiddlyElement(popup,"li",null,"disabled"),lingo.popupNone.format([tag]));
		createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
		var h = createTiddlyLink(createTiddlyElement(popup,"li"),tag,false);
		createTiddlyText(h,lingo.openTag.format([tag]));
		}
	Popup.show(popup,false);
	e.cancelBubble = true;
	if (e.stopPropagation) e.stopPropagation();
	return(false);
}

// Event handler for 'open all' on a tiddler popup
function onClickTagOpenAll(e)
{
	if (!e) var e = window.event;
	var tag = this.getAttribute("tag");
	var tagged = store.getTaggedTiddlers(tag);
	var titles = [];
	for(var t=0; t<tagged.length; t++)
		titles.push(tagged[t].title);
	story.displayTiddlers(this,titles);
	return(false);
}

function onClickError(e)
{
	if (!e) var e = window.event;
	var popup = Popup.create(this);
	var lines = this.getAttribute("errorText").split("\n");
	for(var t=0; t<lines.length; t++)
		createTiddlyElement(popup,"li",null,null,lines[t]);
	Popup.show(popup,false);
	e.cancelBubble = true;
	if (e.stopPropagation) e.stopPropagation();
	return false;
}

function createTiddlyDropDown(place,onchange,options)
{
	var sel = createTiddlyElement(place,"select");
	sel.onchange = onchange;
	for(var t=0; t<options.length; t++)
		{
		var e = createTiddlyElement(sel,"option",null,null,options[t].caption);
		e.value = options[t].name;
		}
}

function createTiddlyError(place,title,text)
{
	var btn = createTiddlyButton(place,title,null,onClickError,"errorButton");
	if (text) btn.setAttribute("errorText",text);
}

function merge(dst,src,preserveExisting)
{
	for (p in src)
		if (!preserveExisting || dst[p] === undefined)
			dst[p] = src[p];
	return dst;
}

// Returns a string containing the description of an exception, optionally prepended by a message
function exceptionText(e, message)
{
	var s = e.description ? e.description : e.toString();
	return message ? "%0:\n%1".format([message, s]) : s;
}

// Displays an alert of an exception description with optional message
function showException(e, message)
{
	alert(exceptionText(e, message));
}

// ---------------------------------------------------------------------------------
// Animation engine
// ---------------------------------------------------------------------------------

function Animator()
{
	this.running = 0; // Incremented at start of each animation, decremented afterwards. If zero, the interval timer is disabled
	this.timerID = 0; // ID of the timer used for animating
	this.animations = []; // List of animations in progress
	return this;
}

// Start animation engine
Animator.prototype.startAnimating = function() // Variable number of arguments
{
	for(var t=0; t<arguments.length; t++)
		this.animations.push(arguments[t]);
	if(this.running == 0)
		{
		var me = this;
		this.timerID = window.XywInterval(function() {me.doAnimate(me);},5);
		}
	this.running += arguments.length;
}

// Perform an animation engine tick, calling each of the known animation modules
Animator.prototype.doAnimate = function(me)
{
	var a = 0;
	while(a < me.animations.length)
		{
		var animation = me.animations[a];
		if(animation.tick())
			a++;
		else
			{
			me.animations.splice(a,1);
			if(--me.running == 0)
				window.clearInterval(me.timerID);
			}
		}
}

// Map a 0..1 value to 0..1, but slow down at the start and end
Animator.slowInSlowOut = function(progress)
{
	return(1-((Math.cos(progress * Math.PI)+1)/2));
}

// ---------------------------------------------------------------------------------
// Cascade animation
// ---------------------------------------------------------------------------------

function Cascade(text,startElement,targetElement,slowly)
{
	var winWidth = findWindowWidth();
	var winHeight = findWindowHeight();
	this.elements = [];
	this.startElement = startElement;
	this.startLeft = findPosX(this.startElement);
	this.startTop = findPosY(this.startElement);
	this.startWidth = Math.min(this.startElement.offsetWidth,winWidth);
	this.startHeight = Math.min(this.startElement.offsetHeight,winHeight);
	this.targetElement = targetElement;
	targetElement.style.position = "relative";
	targetElement.style.zIndex = 2;
	this.targetLeft = findPosX(this.targetElement);
	this.targetTop = findPosY(this.targetElement);
	this.targetWidth = Math.min(this.targetElement.offsetWidth,winWidth);
	this.targetHeight = Math.min(this.targetElement.offsetHeight,winHeight);
	this.progress = -1;
	this.steps = slowly ? config.cascadeSlow : config.cascadeFast;
	this.text = text;
	this.tick();
	return this;
}

Cascade.prototype.tick = function()
{
	this.progress++;
	if(this.progress >= this.steps)
		{
		while(this.elements.length > 0)
			this.removeTail();
		this.targetElement.style.position = "static";
		this.targetElement.style.zIndex = "";
		return false;
		}
	else
		{
		if(this.elements.length > 0 && this.progress > config.cascadeDepth)
			this.removeTail();
		if(this.progress < (this.steps - config.cascadeDepth))
			{
			var f = Animator.slowInSlowOut(this.progress/(this.steps - config.cascadeDepth - 1));
			var e = createTiddlyElement(document.body,"div",null,"cascade",this.text);
			e.style.zIndex = 1;
			e.style.left = this.startLeft + (this.targetLeft-this.startLeft) * f + "px";
			e.style.top = this.startTop + (this.targetTop-this.startTop) * f + "px";
			e.style.width = this.startWidth + (this.targetWidth-this.startWidth) * f + "px";
			e.style.height = this.startHeight + (this.targetHeight-this.startHeight) * f + "px";
			e.style.display = "block";
			this.elements.push(e);
			}
		return true;
		}
}

Cascade.prototype.removeTail = function()
{
	var e = this.elements[0];
	e.parentNode.removeChild(e);
	this.elements.shift();
}

// ---------------------------------------------------------------------------------
// Scroller animation
// ---------------------------------------------------------------------------------

function Scroller(targetElement,slowly)
{
	this.targetElement = targetElement;
	this.startScroll = findScrollY();
	this.targetScroll = ensureVisible(targetElement);
	this.progress = 0;
	this.step = slowly ? config.animSlow : config.animFast;
	return this;
}

Scroller.prototype.tick = function()
{
	this.progress += this.step;
	if(this.progress > 1)
		{
		window.scrollTo(0,this.targetScroll);
		return false;
		}
	else
		{
		var f = Animator.slowInSlowOut(this.progress);
		window.scrollTo(0,this.startScroll + (this.targetScroll-this.startScroll) * f);
		return true;
		}
}

// ---------------------------------------------------------------------------------
// Slider animation
// ---------------------------------------------------------------------------------

// deleteMode - "none", "all" [delete target element and it's children], [only] "children" [but not the target element]
function Slider(element,opening,slowly,deleteMode)
{
	this.element = element;
	element.style.display = "block";
	this.deleteMode = deleteMode;
	this.element.style.height = "auto";
	this.realHeight = element.offsetHeight;
	this.opening = opening;
	this.step = slowly ? config.animSlow : config.animFast;
	if(opening)
		{
		this.progress = 0;
		element.style.height = "0px";
		element.style.display = "block";
		}
	else
		{
		this.progress = 1;
		this.step = -this.step;
		}
	element.style.overflow = "hidden";
	return this;
}

Slider.prototype.stop = function()
{
	if(this.opening)
		{
		this.element.style.height = "auto";
		this.element.style.opacity = 1;
		this.element.style.filter = "alpha(opacity:100)";
		}
	else
		{
		switch(this.deleteMode)
			{
			case "none":
				this.element.style.display = "none";
				break;
			case "all":
				this.element.parentNode.removeChild(this.element);
				break;
			case "children":
				removeChildren(this.element);
				break;
			}
		}
}

Slider.prototype.tick = function()
{
	this.progress += this.step;
	if(this.progress < 0 || this.progress > 1)
		{
		this.stop();
		return false;
		}
	else
		{
		var f = Animator.slowInSlowOut(this.progress);
		var h = this.realHeight * f;
		this.element.style.height = h + "px";
		this.element.style.opacity = f;
		this.element.style.filter = "alpha(opacity:" + f * 100 +")";
		return true;
		}
}

// ---------------------------------------------------------------------------------
// Popup menu
// ---------------------------------------------------------------------------------

var Popup = {
	stack: [] // Array of objects with members root: and popup:
	};

Popup.create = function(root)
{
	Popup.remove();
	var popup = createTiddlyElement(document.body,"ol","popup","popup");
	Popup.stack.push({root: root, popup: popup});
	return popup;
}

Popup.onDocumentClick = function(e)
{
	if (!e) var e = window.event;
	var target = resolveTarget(e);
	if(e.eventPhase == undefined)
		Popup.remove();
	else if(e.eventPhase == Event.BUBBLING_PHASE || e.eventPhase == Event.AT_TARGET)
		Popup.remove();
	return true;
}

Popup.show = function(unused,slowly)
{
	var curr = Popup.stack[Popup.stack.length-1];
	var rootLeft = findPosX(curr.root);
	var rootTop = findPosY(curr.root);
	var rootHeight = curr.root.offsetHeight;
	var popupLeft = rootLeft;
	var popupTop = rootTop + rootHeight;
	var popupWidth = curr.popup.offsetWidth;
	var winWidth = findWindowWidth();
	if(popupLeft + popupWidth > winWidth)
		popupLeft = winWidth - popupWidth;
	curr.popup.style.left = popupLeft + "px";
	curr.popup.style.top = popupTop + "px";
	curr.popup.style.display = "block";
	addClass(curr.root,"highlight");
	if(anim && config.options.chkAnimate)
		anim.startAnimating(new Scroller(curr.popup,slowly));
	else
		window.scrollTo(0,ensureVisible(curr.popup));
}

Popup.remove = function()
{
	if(Popup.stack.length > 0)
		{
		Popup.removeFrom(0);
		}
}

Popup.removeFrom = function(from)
{
	for(var t=Popup.stack.length-1; t>=from; t--)
		{
		var p = Popup.stack[t];
		removeClass(p.root,"highlight");
		p.popup.parentNode.removeChild(p.popup);
		}
	Popup.stack = Popup.stack.slice(0,from);
}

// ---------------------------------------------------------------------------------
// ListView gadget
// ---------------------------------------------------------------------------------

var ListView = {};

// Create a listview
//   place - where in the DOM tree to insert the listview
//   listObject - array of objects to be included in the listview
//   listTemplate - template for the listview
//   callback - callback for a command being selected
//   className - optional classname for the <table> element
ListView.create = function(place,listObject,listTemplate,callback,className)
{
	var table = createTiddlyElement(place,"table",null,className ? className : "listView");
	var thead = createTiddlyElement(table,"thead");
	var r = createTiddlyElement(thead,"tr");
	for(var t=0; t<listTemplate.columns.length; t++)
		{
		var columnTemplate = listTemplate.columns[t];
		var c = createTiddlyElement(r,"th");
		var colType = ListView.columnTypes[columnTemplate.type];
		if(colType && colType.createHeader)
			colType.createHeader(c,columnTemplate,t);
		}
	var tbody = createTiddlyElement(table,"tbody");
	for(var rc=0; rc<listObject.length; rc++)
		{
		rowObject = listObject[rc];
		r = createTiddlyElement(tbody,"tr");
		for(var c=0; c<listTemplate.rowClasses.length; c++)
			{
			if(rowObject[listTemplate.rowClasses[c].field])
				addClass(r,listTemplate.rowClasses[c].className);
			}
		rowObject.rowElement = rowObject;
		rowObject.colElements = {};
		for(var cc=0; cc<listTemplate.columns.length; cc++)
			{
			var c = createTiddlyElement(r,"td");
			var columnTemplate = listTemplate.columns[cc];
			var field = columnTemplate.field;
			var colType = ListView.columnTypes[columnTemplate.type];
			if(colType && colType.createItem)
				colType.createItem(c,rowObject,field,columnTemplate,cc,rc);
			rowObject.colElements[field] = c;
			}
		}
	if(callback && listTemplate.actions)
		createTiddlyDropDown(place,ListView.getCommandHandler(callback),listTemplate.actions);
	if(callback && listTemplate.buttons)
		{
		for(t=0; t<listTemplate.buttons.length; t++)
			{
			var a = listTemplate.buttons[t];
			if(a && a.name != "")
				createTiddlyButton(place,a.caption,null,ListView.getCommandHandler(callback,a.name,a.allowEmptySelection));
			}
		}
	return table;
}

ListView.getCommandHandler = function(callback,name,allowEmptySelection)
{
	return function(e)
		{
		var view = findRelated(this,"TABLE",null,"previousSibling");
		var tiddlers = [];
		ListView.forEachSelector(view,function(e,rowName) {
					if(e.checked)
						tiddlers.push(rowName);
					});
		if(tiddlers.length == 0 && !allowEmptySelection)
			alert(config.messages.nothingSelected);
		else
			{
			if(this.nodeName.toLowerCase() == "select")
				{
				callback(view,this.value,tiddlers);
				this.selectedIndex = 0;
				}
			else
				callback(view,name,tiddlers);
			}
		};
}

// Invoke a callback for each selector checkbox in the listview
//   view - <table> element of listView
//   callback(checkboxElement,rowName)
//     where
//       checkboxElement - DOM element of checkbox
//       rowName - name of this row as assigned by the column template
//   result: true if at least one selector was checked
ListView.forEachSelector = function(view,callback)
{
	var checkboxes = view.getElementsByTagName("input");
	var hadOne = false;
	for(var t=0; t<checkboxes.length; t++)
		{
		var cb = checkboxes[t];
		if(cb.getAttribute("type") == "checkbox")
			{
			var rn = cb.getAttribute("rowName");
			if(rn)
				{
				callback(cb,rn);
				hadOne = true;
				}
			}
		}
	return hadOne;
}

ListView.columnTypes = {};

ListView.columnTypes.String = {
	createHeader: function(place,columnTemplate,col)
		{
			createTiddlyText(place,columnTemplate.title);
		},
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				createTiddlyText(place,v);
		}
};

ListView.columnTypes.Date = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				createTiddlyText(place,v.formatString(columnTemplate.dateFormat));
		}
};

ListView.columnTypes.StringList = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				{
				for(var t=0; t<v.length; t++)
					{
					createTiddlyText(place,v[t]);
					createTiddlyElement(place,"br");
					}
				}
		}
};

ListView.columnTypes.Selector = {
	createHeader: function(place,columnTemplate,col)
		{
			createTiddlyCheckbox(place,null,false,this.onHeaderChange);
		},
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var e = createTiddlyCheckbox(place,null,listObject[field],null);
			e.setAttribute("rowName",listObject[columnTemplate.rowName]);
		},
	onHeaderChange: function(e)
		{
			var state = this.checked;
			var view = findRelated(this,"TABLE");
			if(!view)
				return;
			ListView.forEachSelector(view,function(e,rowName) {
								e.checked = state;
							});
		}
};

ListView.columnTypes.Tags = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var tags = listObject[field];
			createTiddlyText(place,String.encodeTiddlyLinkList(tags));
		}
};

ListView.columnTypes.Boolean = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			if(listObject[field] == true)
				createTiddlyText(place,columnTemplate.trueText);
			if(listObject[field] == false)
				createTiddlyText(place,columnTemplate.falseText);
		}
};

ListView.columnTypes.TagCheckbox = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var e = createTiddlyCheckbox(place,null,listObject[field],this.onChange);
			e.setAttribute("tiddler",listObject.title);
			e.setAttribute("tag",columnTemplate.tag);
		},
	onChange : function(e)
		{
			var tag = this.getAttribute("tag");
			var tiddler = this.getAttribute("tiddler");
			store.setTiddlerTag(tiddler,this.checked,tag);
		}
};

ListView.columnTypes.TiddlerLink = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				{
				var link = createTiddlyLink(place,listObject[columnTemplate.tiddlerLink],false,null);
				createTiddlyText(link,listObject[field]);
				}
		}
};
// ---------------------------------------------------------------------------------
// Augmented methods for the JavaScript Number(), Array(), String() and Date() objects
// ---------------------------------------------------------------------------------

// Clamp a number to a range
Number.prototype.clamp = function(min,max)
{
	var c = this;
	if(c < min)
		c = min;
	if(c > max)
		c = max;
	return c;
}

// Add indexOf function if browser does not support it
if(!Array.indexOf) {
Array.prototype.indexOf = function(item,from)
{
	if(!from)
		from = 0;
	for(var i=from; i<this.length; i++)
		if(this[i] === item)
			return i;
	return -1;
}}

// Find an entry in a given field of the members of an array
Array.prototype.findByField = function(field,value)
{
	for(var t=0; t<this.length; t++)
		if(this[t][field] == value)
			return t;
	return null;
}

// Return whether an entry exists in an array
Array.prototype.contains = function(item)
{
	return this.indexOf(item) != -1;
};

// Adds, removes or toggles a particular value within an array
//  value - value to add
//  mode - +1 to add value, -1 to remove value, 0 to toggle it
Array.prototype.setItem = function(value,mode)
{
	var p = this.indexOf(value);
	if(mode == 0)
		mode = (p == -1) ? +1 : -1;
	if(mode == +1)
		{
		if(p == -1)
			this.push(value);
		}
	else if(mode == -1)
		{
		if(p != -1)
			this.splice(p,1);
		}
}

// Return whether one of a list of values exists in an array
Array.prototype.containsAny = function(items)
{
	for(var i=0; i<items.length; i++)
		if (this.indexOf(items[i]) != -1)
			return true;
	return false;
};

// Return whether all of a list of values exists in an array
Array.prototype.containsAll = function(items)
{
	for (var i = 0; i<items.length; i++)
		if (this.indexOf(items[i]) == -1)
			return false;
	return true;
};

// Push a new value into an array only if it is not already present in the array. If the optional unique parameter is false, it reverts to a normal push
Array.prototype.pushUnique = function(item,unique)
{
	if(unique != undefined && unique == false)
		this.push(item);
	else
		{
		if(this.indexOf(item) == -1)
			this.push(item);
		}
}

Array.prototype.remove = function(item)
{
	var p = this.indexOf(item);
	if(p != -1)
		this.splice(p,1);
}

// Get characters from the right end of a string
String.prototype.right = function(n)
{
	if(n < this.length)
		return this.slice(this.length-n);
	else
		return this;
}

// Trim whitespace from both ends of a string
String.prototype.trim = function()
{
	return this.replace(/^\s*|\s*$/g,"");
}

// Convert a string from a CSS style property name to a JavaScript style name ("background-color" -> "backgroundColor")
String.prototype.unDash = function()
{
	var s = this.split("-");
	if(s.length > 1)
		for(var t=1; t<s.length; t++)
			s[t] = s[t].substr(0,1).toUpperCase() + s[t].substr(1);
	return s.join("");
}

// Substitute substrings from an array into a format string that includes '%1'-type specifiers
String.prototype.format = function(substrings)
{
	var subRegExp = /(?:%(\d+))/mg;
	var currPos = 0;
	var r = [];
	do {
		var match = subRegExp.exec(this);
		if(match && match[1])
			{
			if(match.index > currPos)
				r.push(this.substring(currPos,match.index));
			r.push(substrings[parseInt(match[1])]);
			currPos = subRegExp.lastIndex;
			}
	} while(match);
	if(currPos < this.length)
		r.push(this.substring(currPos,this.length));
	return r.join("");
}

// Escape any special RegExp characters with that character preceded by a backslash
String.prototype.escapeRegExp = function()
{
	var s = "\\^$*+?()=!|,{}[].";
	var c = this;
	for(var t=0; t<s.length; t++)
		c = c.replace(new RegExp("\\" + s.substr(t,1),"g"),"\\" + s.substr(t,1));
	return c;
}

// Convert "\" to "\s", newlines to "\n" (and remove carriage returns)
String.prototype.escapeLineBreaks = function()
{
	return this.replace(/\\/mg,"\\s").replace(/\n/mg,"\\n").replace(/\r/mg,"");
}

// Convert "\n" to newlines, "\b" to " ", "\s" to "\" (and remove carriage returns)
String.prototype.unescapeLineBreaks = function()
{
	return this.replace(/\\n/mg,"\n").replace(/\\b/mg," ").replace(/\\s/mg,"\\").replace(/\r/mg,"");
}

// Convert & to "&amp;", < to "&lt;", > to "&gt;" and " to "&quot;"
String.prototype.htmlEncode = function()
{
	return(this.replace(/&/mg,"&amp;").replace(/</mg,"&lt;").replace(/>/mg,"&gt;").replace(/\"/mg,"&quot;"));
}

// Convert "&amp;" to &, "&lt;" to <, "&gt;" to > and "&quot;" to "
String.prototype.htmlDecode = function()
{
	return(this.replace(/&amp;/mg,"&").replace(/&lt;/mg,"<").replace(/&gt;/mg,">").replace(/&quot;/mg,"\""));
}

// Parse a space-separated string of name:value parameters where:
//   - the name or the value can be optional (in which case separate defaults are used instead)
//     - in case of ambiguity, a lone word is taken to be a value
//     - if 'cascadeDefaults' is set to true, then the defaults are modified by updated by each specified name or value
//     - name prefixes are not allowed if the 'noNames' parameter is true
//   - if both the name and value are present they must be separated by a colon
//   - the name and the value may both be quoted with single- or double-quotes, double-square brackets
//   - names or values quoted with {{double-curly braces}} are evaluated as a JavaScript expression
//     - as long as the 'allowEval' parameter is true
// The result is an array of objects:
//   result[0] = object with a member for each parameter name, value of that member being an array of values
//   result[1..n] = one object for each parameter, with 'name' and 'value' members
String.prototype.parseParams = function(defaultName,defaultValue,allowEval,noNames,cascadeDefaults)
{
	var parseToken = function(match,p)
		{
		var n;
		if(match[p]) // Double quoted
			n = match[p];
		else if(match[p+1]) // Single quoted
			n = match[p+1];
		else if(match[p+2]) // Double-square-bracket quoted
			n = match[p+2];
		else if(match[p+3]) // Double-brace quoted
			try
				{
				n = match[p+3];
				if(allowEval)
					n = window.eval(n);
				}
			catch(e)
				{
				throw "Unable to evaluate {{" + match[p+3] + "}}: " + exceptionText(e);
				}
		else if(match[p+4]) // Unquoted
			n = match[p+4];
		else if(match[p+5]) // empty quote
			n = "";
		return n;
		};
	var r = [{}];
	var dblQuote = "(?:\"((?:(?:\\\\\")|[^\"])+)\")";
	var sngQuote = "(?:'((?:(?:\\\\\')|[^'])+)')";
	var dblSquare = "(?:\\[\\[((?:\\s|\\S)*?)\\]\\])";
	var dblBrace = "(?:\\{\\{((?:\\s|\\S)*?)\\}\\})";
	var unQuoted = noNames ? "([^\"'\\s]\\S*)" : "([^\"':\\s][^\\s:]*)";
	var emptyQuote = "((?:\"\")|(?:''))";
	var skipSpace = "(?:\\s*)";
	var token = "(?:" + dblQuote + "|" + sngQuote + "|" + dblSquare + "|" + dblBrace + "|" + unQuoted + "|" + emptyQuote + ")";
	var re = noNames
		? new RegExp(token,"mg")
		: new RegExp(skipSpace + token + skipSpace + "(?:(\\:)" + skipSpace + token + ")?","mg");
	var params = [];
	do {
		var match = re.exec(this);
		if(match)
			{
			var n = parseToken(match,1);
			if(noNames)
				r.push({name: "", value: n});
			else
				{
				var v = parseToken(match,8);
				if(v == null && defaultName)
					{
					v = n;
					n = defaultName;
					}
				else if(v == null && defaultValue)
					v = defaultValue;
				r.push({name: n, value: v});
				if(cascadeDefaults)
					{
					defaultName = n;
					defaultValue = v;
					}
				}
			}
	} while(match);
	// Summarise parameters into first element
	for(var t=1; t<r.length; t++)
		{
		if(r[0][r[t].name])
			r[0][r[t].name].push(r[t].value);
		else
			r[0][r[t].name] = [r[t].value];
		}
	return r;
}

// Process a string list of macro parameters into an array. Parameters can be quoted with "", '',
// [[]], {{ }} or left unquoted (and therefore space-separated). Double-braces {{}} results in
// an *evaluated* parameter: e.g. {{config.options.txtUserName}} results in the current user's name.
String.prototype.readMacroParams = function()
{
	var p = this.parseParams("list",null,true,true);
	var n = [];
	for(var t=1; t<p.length; t++)
		n.push(p[t].value);
	return n;
}

// Process a string list of unique tiddler names into an array. Tiddler names that have spaces in them must be [[bracketed]]
String.prototype.readBracketedList = function(unique)
{
	var p = this.parseParams("list",null,false,true);
	var n = [];
	for(var t=1; t<p.length; t++)
		n.pushUnique(p[t].value,unique);
	return n;
}

// Returns array with start and end index of chunk between given start and end marker, or undefined.
String.prototype.getChunkRange = function(start,end) 
{
	var s = this.indexOf(start);
	if(s != -1)
		{
		s += start.length;
		var e = this.indexOf(end,s);
		if(e != -1)
			return [s, e];
		}
}

// Replace a chunk of a string given start and end markers
String.prototype.replaceChunk = function(start,end,sub)
{
	var r = this.getChunkRange(start,end);
	return r 
		? this.substring(0,r[0]) + sub + this.substring(r[1])
		: this;
}

// Returns a chunk of a string between start and end markers, or undefined
String.prototype.getChunk = function(start,end)
{
	var r = this.getChunkRange(start,end);
	if (r)
		return this.substring(r[0],r[1]);
}


// Static method to bracket a string with double square brackets if it contains a space
String.encodeTiddlyLink = function(title)
{
	if(title.indexOf(" ") == -1)
		return(title);
	else
		return("[[" + title + "]]");
}

// Static method to encodeTiddlyLink for every item in an array and join them with spaces
String.encodeTiddlyLinkList = function(list)
{
	if(list)
		{
		var results = [];
		for(var t=0; t<list.length; t++)
			results.push(String.encodeTiddlyLink(list[t]));
		return results.join(" ");
		}
	else
		return "";
}

// Static method to left-pad a string with 0s to a certain width
String.zeroPad = function(n,d)
{
	var s = n.toString();
	if(s.length < d)
		s = "000000000000000000000000000".substr(0,d-s.length) + s;
	return(s);
}

String.prototype.startsWith = function(prefix) 
{
	return !prefix || this.substring(0,prefix.length) == prefix;
}

// Returns the first value of the given named parameter.
//#
//# @param params
//#         as returned by parseParams or null/undefined
//# @return [may be null/undefined]
//#
function getParam(params, name, defaultValue) {
	if (!params)
		return defaultValue;
	var p = params[0][name];
	return p ? p[0] : defaultValue;
}

// Returns the first value of the given boolean named parameter.
//#
//# @param params
//#         as returned by parseParams or null/undefined
//#
function getFlag(params, name, defaultValue) {
	return !!getParam(params, name, defaultValue);
} 
	
// Substitute date components into a string
Date.prototype.formatString = function(template)
{
	var t = template.replace(/0hh12/g,String.zeroPad(this.getHours12(),2));
	t = t.replace(/hh12/g,this.getHours12());
	t = t.replace(/0hh/g,String.zeroPad(this.getHours(),2));
	t = t.replace(/hh/g,this.getHours());
	t = t.replace(/0mm/g,String.zeroPad(this.getMinutes(),2));
	t = t.replace(/mm/g,this.getMinutes());
	t = t.replace(/0ss/g,String.zeroPad(this.getSeconds(),2));
	t = t.replace(/ss/g,this.getSeconds());
	t = t.replace(/[ap]m/g,this.getAmPm().toLowerCase());
	t = t.replace(/[AP]M/g,this.getAmPm().toUpperCase());
	t = t.replace(/wYYYY/g,this.getYearForWeekNo());
	t = t.replace(/wYY/g,String.zeroPad(this.getYearForWeekNo()-2000,2));
	t = t.replace(/YYYY/g,this.getFullYear());
	t = t.replace(/YY/g,String.zeroPad(this.getFullYear()-2000,2));
	t = t.replace(/MMM/g,config.messages.dates.months[this.getMonth()]);
	t = t.replace(/mmm/g,config.messages.dates.shortMonths[this.getMonth()]);
	t = t.replace(/0MM/g,String.zeroPad(this.getMonth()+1,2));
	t = t.replace(/MM/g,this.getMonth()+1);
	t = t.replace(/0WW/g,String.zeroPad(this.getWeek(),2));
	t = t.replace(/WW/g,this.getWeek());
	t = t.replace(/DDD/g,config.messages.dates.days[this.getDay()]);
	t = t.replace(/ddd/g,config.messages.dates.shortDays[this.getDay()]);
	t = t.replace(/0DD/g,String.zeroPad(this.getDate(),2));
	t = t.replace(/DDth/g,this.getDate()+this.daySuffix());
	t = t.replace(/DD/g,this.getDate());
	return t;
}

Date.prototype.getWeek = function()
{
	var dt = new Date(this.getTime());
	var d = dt.getDay();
	if (d==0) d=7;// JavaScript Sun=0, ISO Sun=7
	dt.setTime(dt.getTime()+(4-d)*86400000);// shift day to Thurs of same week to calculate weekNo
	var n = Math.floor((dt.getTime()-new Date(dt.getFullYear(),0,1)+3600000)/86400000); 
	return Math.floor(n/7)+1;
}

Date.prototype.getYearForWeekNo = function()
{
	var dt = new Date(this.getTime());
	var d = dt.getDay();
	if (d==0) d=7;// JavaScript Sun=0, ISO Sun=7
	dt.setTime(dt.getTime()+(4-d)*86400000);// shift day to Thurs of same week
	return dt.getFullYear();
}

Date.prototype.getHours12 = function()
{
	var h = this.getHours();
	return h > 12 ? h-12 : ( h > 0 ? h : 12 );
}

Date.prototype.getAmPm = function()
{
	return this.getHours() >= 12 ? "pm" : "am";
}

Date.prototype.daySuffix = function()
{
	var num = this.getDate();
	if (num >= 11 && num <= 13) return "th";
	else if (num.toString().substr(-1)=="1") return "st";
	else if (num.toString().substr(-1)=="2") return "nd";
	else if (num.toString().substr(-1)=="3") return "rd";
	return "th";
}

// Convert a date to local YYYYMMDDHHMM string format
Date.prototype.convertToLocalYYYYMMDDHHMM = function()
{
	return(String.zeroPad(this.getFullYear(),4) + String.zeroPad(this.getMonth()+1,2) + String.zeroPad(this.getDate(),2) + String.zeroPad(this.getHours(),2) + String.zeroPad(this.getMinutes(),2));
}

// Convert a date to UTC YYYYMMDDHHMM string format
Date.prototype.convertToYYYYMMDDHHMM = function()
{
	return(String.zeroPad(this.getUTCFullYear(),4) + String.zeroPad(this.getUTCMonth()+1,2) + String.zeroPad(this.getUTCDate(),2) + String.zeroPad(this.getUTCHours(),2) + String.zeroPad(this.getUTCMinutes(),2));
}

// Convert a date to UTC YYYYMMDD.HHMMSSMMM string format
Date.prototype.convertToYYYYMMDDHHMMSSMMM = function()
{
	return(String.zeroPad(this.getUTCFullYear(),4) + String.zeroPad(this.getUTCMonth()+1,2) + String.zeroPad(this.getUTCDate(),2) + "." + String.zeroPad(this.getUTCHours(),2) + String.zeroPad(this.getUTCMinutes(),2) + String.zeroPad(this.getUTCSeconds(),2) + String.zeroPad(this.getUTCMilliseconds(),4));
}

// Static method to create a date from a UTC YYYYMMDDHHMM format string
Date.convertFromYYYYMMDDHHMM = function(d)
{
	var theDate = new Date(Date.UTC(parseInt(d.substr(0,4),10),
							parseInt(d.substr(4,2),10)-1,
							parseInt(d.substr(6,2),10),
							parseInt(d.substr(8,2),10),
							parseInt(d.substr(10,2),10),0,0));
	return(theDate);
}

// ---------------------------------------------------------------------------------
// Crypto functions and associated conversion routines
// ---------------------------------------------------------------------------------

// Crypto "namespace"
function Crypto() {}

// Convert a string to an array of big-endian 32-bit words
Crypto.strToBe32s = function(str)
{
	var be = Array();
	var len = Math.floor(str.length/4);
	var i, j;
	for(i=0, j=0; i<len; i++, j+=4)
		{
		be[i] = ((str.charCodeAt(j)&0xff) << 24)|((str.charCodeAt(j+1)&0xff) << 16)|((str.charCodeAt(j+2)&0xff) << 8)|(str.charCodeAt(j+3)&0xff);
		}
	while (j<str.length)
		{
		be[j>>2] |= (str.charCodeAt(j)&0xff)<<(24-(j*8)%32);
		j++;
		}
	return be;
}

// Convert an array of big-endian 32-bit words to a string
Crypto.be32sToStr = function(be)
{
	var str = "";
	for(var i=0;i<be.length*32;i+=8)
		str += String.fromCharCode((be[i>>5]>>>(24-i%32)) & 0xff);
	return str;
}

// Convert an array of big-endian 32-bit words to a hex string
Crypto.be32sToHex = function(be)
{
	var hex = "0123456789ABCDEF";
	var str = "";
	for(var i=0;i<be.length*4;i++)
		str += hex.charAt((be[i>>2]>>((3-i%4)*8+4))&0xF) + hex.charAt((be[i>>2]>>((3-i%4)*8))&0xF);
	return str;
}

// Return, in hex, the SHA-1 hash of a string
Crypto.hexSha1Str = function(str)
{
	return Crypto.be32sToHex(Crypto.sha1Str(str));
}

// Return the SHA-1 hash of a string
Crypto.sha1Str = function(str)
{
	return Crypto.sha1(Crypto.strToBe32s(str),str.length);
}

// Calculate the SHA-1 hash of an array of blen bytes of big-endian 32-bit words
Crypto.sha1 = function(x,blen)
{
	// Add 32-bit integers, wrapping at 32 bits
	//# Uses 16-bit operations internally to work around bugs in some JavaScript interpreters.
	add32 = function(a,b)
	{
		var lsw = (a&0xFFFF)+(b&0xFFFF);
		var msw = (a>>16)+(b>>16)+(lsw>>16);
		return (msw<<16)|(lsw&0xFFFF);
	};
	// Add five 32-bit integers, wrapping at 32 bits
	//# Uses 16-bit operations internally to work around bugs in some JavaScript interpreters.
	add32x5 = function(a,b,c,d,e)
	{
		var lsw = (a&0xFFFF)+(b&0xFFFF)+(c&0xFFFF)+(d&0xFFFF)+(e&0xFFFF);
		var msw = (a>>16)+(b>>16)+(c>>16)+(d>>16)+(e>>16)+(lsw>>16);
		return (msw<<16)|(lsw&0xFFFF);
	};
	// Bitwise rotate left a 32-bit integer by 1 bit
	rol32 = function(n)
	{
		return (n>>>31)|(n<<1);
	};

	var len = blen*8;
	// Append padding so length in bits is 448 mod 512
	x[len>>5] |= 0x80 << (24-len%32);
	// Append length
	x[((len+64>>9)<<4)+15] = len;
	var w = Array(80);

	var k1 = 0x5A827999;
	var k2 = 0x6ED9EBA1;
	var k3 = 0x8F1BBCDC;
	var k4 = 0xCA62C1D6;

	var h0 = 0x67452301;
	var h1 = 0xEFCDAB89;
	var h2 = 0x98BADCFE;
	var h3 = 0x10325476;
	var h4 = 0xC3D2E1F0;

	for(var i=0;i<x.length;i+=16)
		{
		var j,t;
		var a = h0;
		var b = h1;
		var c = h2;
		var d = h3;
		var e = h4;
		for(j = 0;j<16;j++)
			{
			w[j] = x[i+j];
			t = add32x5(e,(a>>>27)|(a<<5),d^(b&(c^d)),w[j],k1);
			e=d; d=c; c=(b>>>2)|(b<<30); b=a; a = t;
			}
		for(j=16;j<20;j++)
			{
			w[j] = rol32(w[j-3]^w[j-8]^w[j-14]^w[j-16]);
			t = add32x5(e,(a>>>27)|(a<<5),d^(b&(c^d)),w[j],k1);
			e=d; d=c; c=(b>>>2)|(b<<30); b=a; a = t;
			}
		for(j=20;j<40;j++)
			{
			w[j] = rol32(w[j-3]^w[j-8]^w[j-14]^w[j-16]);
			t = add32x5(e,(a>>>27)|(a<<5),b^c^d,w[j],k2);
			e=d; d=c; c=(b>>>2)|(b<<30); b=a; a = t;
			}
		for(j=40;j<60;j++)
			{
			w[j] = rol32(w[j-3]^w[j-8]^w[j-14]^w[j-16]);
			t = add32x5(e,(a>>>27)|(a<<5),(b&c)|(d&(b|c)),w[j],k3);
			e=d; d=c; c=(b>>>2)|(b<<30); b=a; a = t;
			}
		for(j=60;j<80;j++)
			{
			w[j] = rol32(w[j-3]^w[j-8]^w[j-14]^w[j-16]);
			t = add32x5(e,(a>>>27)|(a<<5),b^c^d,w[j],k4);
			e=d; d=c; c=(b>>>2)|(b<<30); b=a; a = t;
			}

		h0 = add32(h0,a);
		h1 = add32(h1,b);
		h2 = add32(h2,c);
		h3 = add32(h3,d);
		h4 = add32(h4,e);
		}
	return Array(h0,h1,h2,h3,h4);
}

// ---------------------------------------------------------------------------------
// RGB colour object
// ---------------------------------------------------------------------------------

// Construct an RGB colour object from a '#rrggbb', '#rgb' or 'rgb(n,n,n)' string or from separate r,g,b values
function RGB(r,g,b)
{
	this.r = 0;
	this.g = 0;
	this.b = 0;
	if(typeof r == "string")
		{
		if(r.substr(0,1) == "#")
			{
			if(r.length == 7)
				{
				this.r = parseInt(r.substr(1,2),16)/255;
				this.g = parseInt(r.substr(3,2),16)/255;
				this.b = parseInt(r.substr(5,2),16)/255;
				}
			else
				{
				this.r = parseInt(r.substr(1,1),16)/15;
				this.g = parseInt(r.substr(2,1),16)/15;
				this.b = parseInt(r.substr(3,1),16)/15;
				}
			}
		else
			{
			var rgbPattern = /rgb\s*\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/ ;
			var c = r.match(rgbPattern);
			if (c)
				{
				this.r = parseInt(c[1],10)/255;
				this.g = parseInt(c[2],10)/255;
				this.b = parseInt(c[3],10)/255;
				}
			}
		}
	else
		{
		this.r = r;
		this.g = g;
		this.b = b;
		}
	return this;
}

// Mixes this colour with another in a specified proportion
// c = other colour to mix
// f = 0..1 where 0 is this colour and 1 is the new colour
// Returns an RGB object
RGB.prototype.mix = function(c,f)
{
	return new RGB(this.r + (c.r-this.r) * f,this.g + (c.g-this.g) * f,this.b + (c.b-this.b) * f);
}

// Return an rgb colour as a #rrggbb format hex string
RGB.prototype.toString = function()
{
	var r = this.r.clamp(0,1);
	var g = this.g.clamp(0,1);
	var b = this.b.clamp(0,1);
	return("#" + ("0" + Math.floor(r * 255).toString(16)).right(2) +
				 ("0" + Math.floor(g * 255).toString(16)).right(2) +
				 ("0" + Math.floor(b * 255).toString(16)).right(2));
}

// ---------------------------------------------------------------------------------
// DOM utilities - many derived from www.quirksmode.org
// ---------------------------------------------------------------------------------

function drawGradient(place,horiz,colours)
{
	for(var t=0; t<= 100; t+=2)
		{
		var bar = document.createElement("div");
		place.appendChild(bar);
		bar.style.position = "absolute";
		bar.style.left = horiz ? t + "%" : 0;
		bar.style.top = horiz ? 0 : t + "%";
		bar.style.width = horiz ? (101-t) + "%" : "100%";
		bar.style.height = horiz ? "100%" : (101-t) + "%";
		bar.style.zIndex = -1;
		var f = t/100;
		var p = f*(colours.length-1);
		bar.style.backgroundColor = colours[Math.floor(p)].mix(colours[Math.ceil(p)],p-Math.floor(p)).toString();
		}
}

function createTiddlyText(theParent,theText)
{
	return theParent.appendChild(document.createTextNode(theText));
}

function createTiddlyCheckbox(theParent,caption,checked,onChange)
{
	var cb = document.createElement("input");
	cb.setAttribute("type","checkbox");
	cb.onclick = onChange;
	theParent.appendChild(cb);
	cb.checked = checked;
	cb.className = "chkOptionInput";
	if(caption)
		wikify(caption,theParent);
	return cb;
}

function createTiddlyElement(theParent,theElement,theID,theClass,theText)
{
	var e = document.createElement(theElement);
	if(theClass != null)
		e.className = theClass;
	if(theID != null)
		e.setAttribute("id",theID);
	if(theText != null)
		e.appendChild(document.createTextNode(theText));
	if(theParent != null)
		theParent.appendChild(e);
	return(e);
}

// Add an event handler
// Thanks to John Resig, via QuirksMode
function addEvent(obj,type,fn)
{
	if(obj.attachEvent)
		{
		obj['e'+type+fn] = fn;
		obj[type+fn] = function(){obj['e'+type+fn](window.event);}
		obj.attachEvent('on'+type,obj[type+fn]);
		}
	else
		obj.addEventListener(type,fn,false);
}

// Remove  an event handler
// Thanks to John Resig, via QuirksMode
function removeEvent(obj,type,fn)
{
	if(obj.detachEvent)
		{
		obj.detachEvent('on'+type,obj[type+fn]);
		obj[type+fn] = null;
		}
	else
		obj.removeEventListener(type,fn,false);
}

function addClass(e,theClass)
{
	var currClass = e.className.split(" ");
	if(currClass.indexOf(theClass) == -1)
		e.className += " " + theClass;
}

function removeClass(e,theClass)
{
	var currClass = e.className.split(" ");
	var i = currClass.indexOf(theClass);
	while(i != -1)
		{
		currClass.splice(i,1);
		i = currClass.indexOf(theClass);
		}
	e.className = currClass.join(" ");
}

function hasClass(e,theClass)
{
	if(e.className)
		{
		if(e.className.split(" ").indexOf(theClass) != -1)
			return true;
		}
	return false;
}

// Find the closest relative with a given property value (property defaults to tagName, relative defaults to parentNode)
function findRelated(e,value,name,relative)
{
	name = name ? name : "tagName";
	relative = relative ? relative : "parentNode";
	if(name == "className")
		{
		while(e && !hasClass(e,value))
			{
			e = e[relative];
			}
		}
	else
		{
		while(e && e[name] != value)
			{
			e = e[relative];
			}
		}
	return e;
}

// Resolve the target object of an event
function resolveTarget(e)
{
	var obj;
	if (e.target)
		obj = e.target;
	else if (e.srcElement)
		obj = e.srcElement;
	if (obj.nodeType == 3) // defeat Safari bug
		obj = obj.parentNode;
	return(obj);
}

// Return the content of an element as plain text with no formatting
function getPlainText(e)
{
	var text = "";
	if(e.innerText)
		text = e.innerText;
	else if(e.textContent)
		text = e.textContent;
	return text;
}

// Get the scroll position for window.scrollTo necessary to scroll a given element into view
function ensureVisible(e)
{
	var posTop = findPosY(e);
	var posBot = posTop + e.offsetHeight;
	var winTop = findScrollY();
	var winHeight = findWindowHeight();
	var winBot = winTop + winHeight;
	if(posTop < winTop)
		return(posTop);
	else if(posBot > winBot)
		{
		if(e.offsetHeight < winHeight)
			return(posTop - (winHeight - e.offsetHeight));
		else
			return(posTop);
		}
	else
		return(winTop);
}

// Get the current width of the display window
function findWindowWidth()
{
	return(window.innerWidth ? window.innerWidth : document.documentElement.clientWidth);
}

// Get the current height of the display window
function findWindowHeight()
{
	return(window.innerHeight ? window.innerHeight : document.documentElement.clientHeight);
}

// Get the current horizontal page scroll position
function findScrollX()
{
	return(window.scrollX ? window.scrollX : document.documentElement.scrollLeft);
}

// Get the current vertical page scroll position
function findScrollY()
{
	return(window.scrollY ? window.scrollY : document.documentElement.scrollTop);
}

function findPosX(obj)
{
	var curleft = 0;
	while (obj.offsetParent)
		{
		curleft += obj.offsetLeft;
		obj = obj.offsetParent;
		}
	return curleft;
}

function findPosY(obj)
{
	var curtop = 0;
	while (obj.offsetParent)
		{
		curtop += obj.offsetTop;
		obj = obj.offsetParent;
		}
	return curtop;
}

// Blur a particular element
function blurElement(e)
{
	if(e != null && e.focus && e.blur)
		{
		e.focus();
		e.blur();
		}
}

// Create a non-breaking space
function insertSpacer(place)
{
	var e = document.createTextNode(String.fromCharCode(160));
	if(place)
		place.appendChild(e);
	return e;
}

// Remove all children of a node
function removeChildren(e)
{
	while(e.hasChildNodes())
		e.removeChild(e.firstChild);
}

// Add a stylesheet, replacing any previous custom stylesheet
function setStylesheet(s,id)
{
	if(!id)
		id = "customStyleSheet";
	var n = document.getElementById(id);
	if(document.createStyleSheet) // Test for IE's non-standard createStyleSheet method
		{
		if(n)
			n.parentNode.removeChild(n);
		// This failed without the &nbsp;
		document.getElementsByTagName("head")[0].insertAdjacentHTML("beforeEnd","&nbsp;<style id='" + id + "'>" + s + "</style>");
		}
	else
		{
		if(n)
			n.replaceChild(document.createTextNode(s),n.firstChild);
		else
			{
			var n = document.createElement("style");
			n.type = "text/css";
			n.id = id;
			n.appendChild(document.createTextNode(s));
			document.getElementsByTagName("head")[0].appendChild(n);
			}
		}
}

// Replace the current selection of a textarea or text input and scroll it into view

function replaceSelection(e,text)
{
	if (e.setSelectionRange)
		{
		var oldpos = e.selectionStart + 1;
		e.value = e.value.substr(0,e.selectionStart) + text + e.value.substr(e.selectionStart);
		e.setSelectionRange( oldpos, oldpos);
		var linecount = e.value.split('\n').length;
		var thisline = e.value.substr(0,e.selectionStart).split('\n').length-1;
		e.scrollTop = Math.floor((thisline-e.rows/2)*e.scrollHeight/linecount);
		}
	else if (document.selection)
		{
		var range = document.selection.createRange();
		if (range.parentElement() == e)
			{
			var isCollapsed = range.text == "";
			range.text = text;
			 if (!isCollapsed)
				{
				range.moveStart('character', -text.length);
				range.select();
				}
			}
		}
}

// Returns the text of the given (text) node, possibly merging subsequent text nodes
function getNodeText(e)
{
	var t = ""; 
	while (e && e.nodeName == "#text")
		{
		t += e.nodeValue;
		e = e.nextSibling;
		}
	return t;
}
//# -------------------------
//# LoaderBase: A (abstract) storage loader that loads the tiddlers from a list of HTML elements.
//# The format of the elements is defined by subclasses of this loader through the internalizeTiddler implementation.
//# Subclasses must implement:
//# 			function getTitle(store, e)
//#
//# store must implement:
//# 			function createTiddler(title).
//#

function LoaderBase()
{
}

LoaderBase.prototype.loadTiddler = function(store,e,tiddlers)
{
	var title = this.getTitle(store, e);
	if (title)
		{
		var tiddler = store.createTiddler(title);
		this.internalizeTiddler(store, tiddler, title, e);
		tiddlers.push(tiddler);
		}
}

LoaderBase.prototype.loadTiddlers = function(store,nodes)
{
	var tiddlers = [];
	for (var t = 0; t < nodes.length; t++)
		{
		try
			{
			this.loadTiddler(store, nodes[t], tiddlers);
			}
		catch(e)
			{
			showException(e, config.messages.tiddlerLoadError.format([this.getTitle(store, nodes[t])]));
			}
		}
	return tiddlers;
}
	
//# -------------------------
//# SaverBase: a (abstract) storage saver that externalizes all tiddlers into a string, 
//# with every tiddler individually externalized (using this.externalizeTiddler) and joined with newlines 
//# Subclasses must implement:
//# 			function externalizeTiddler(store, tiddler)
//#
//# store must implement:
//# 			function getTiddlers(sortByFieldName)
//#

function SaverBase()
{
}

SaverBase.prototype.externalize = function(store) 
{
	var results = [];
	var tiddlers = store.getTiddlers("title");
	for (var t = 0; t < tiddlers.length; t++)
		results.push(this.externalizeTiddler(store, tiddlers[t]));
	return results.join("\n");
}
//--------------------------------
// TW21Loader (inherits from LoaderBase)

function TW21Loader() {};

TW21Loader.prototype = new LoaderBase();

TW21Loader.prototype.getTitle = function(store, e) {
	var title = null;
	if(e.getAttribute)
		title = e.getAttribute("tiddler");
	if(!title && e.id) {	
		var lenPrefix = store.idPrefix.length;
		if (e.id.substr(0,lenPrefix) == store.idPrefix)
			title = e.id.substr(lenPrefix);
	}
	return title;
}

TW21Loader.prototype.internalizeTiddler = function(store, tiddler, title, data) {
	var text = getNodeText(data.firstChild).unescapeLineBreaks();
	var modifier = data.getAttribute("modifier");
	var modified = Date.convertFromYYYYMMDDHHMM(data.getAttribute("modified"));
	var c = data.getAttribute("created");
	var created = c ? Date.convertFromYYYYMMDDHHMM(c) : modified;
	var tags = data.getAttribute("tags");
	var fields = {};
	var attrs = data.attributes;
	for(var i = attrs.length-1; i >= 0; i--) {
		var name = attrs[i].name;
		if (attrs[i].specified && !TiddlyWiki.isStandardField(name)) {
			fields[name] = attrs[i].value.unescapeLineBreaks();
		}
	}
	tiddler.assign(title,text,modifier,modified,tags,created, fields);
	return tiddler;
};

//--------------------------------
// TW21Saver (inherits from SaverBase)

function TW21Saver() {};

TW21Saver.prototype = new SaverBase();

TW21Saver.prototype.externalizeTiddler = function(store, tiddler) 
{
	try {
		var extendedFieldAttributes = "";
		store.forEachField(tiddler, 
			function(tiddler, fieldName, value) {
				// don't store stuff from the temp namespace
				if (!fieldName.match(/^temp\./))
					extendedFieldAttributes += ' %0="%1"'.format([fieldName, value.escapeLineBreaks().htmlEncode()]);
			}, true);
		return '<div tiddler="%0" modifier="%1" modified="%2" created="%3" tags="%4"%6>%5</div>'.format([
				tiddler.title.htmlEncode(),
				tiddler.modifier.htmlEncode(),
				tiddler.modified.convertToYYYYMMDDHHMM(),
				tiddler.created.convertToYYYYMMDDHHMM(),
				tiddler.getTags().htmlEncode(),
				tiddler.escapeLineBreaks().htmlEncode(),
				extendedFieldAttributes
			]);
	} catch (e) {
		throw exceptionText(e, config.messages.tiddlerSaveError.format([tiddler.title]));
	}
}

// ---------------------------------------------------------------------------------
// Deprecated code
// ---------------------------------------------------------------------------------

// @Deprecated: Use createElementAndWikify and this.termRegExp instead
config.formatterHelpers.charFormatHelper = function(w)
{
	w.subWikify(createTiddlyElement(w.output,this.element),this.terminator);
}

// @Deprecated: Use enclosedTextHelper and this.lookaheadRegExp instead
config.formatterHelpers.monospacedByLineHelper = function(w)
{
	var lookaheadRegExp = new RegExp(this.lookahead,"mg");
	lookaheadRegExp.lastIndex = w.matchStart;
	var lookaheadMatch = lookaheadRegExp.exec(w.source);
	if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
		{
		var text = lookaheadMatch[1];
		if(config.browser.isIE)
			text = text.replace(/\n/g,"\r");
		createTiddlyElement(w.output,"pre",null,null,text);
		w.nextMatch = lookaheadRegExp.lastIndex;
		}
}

// @Deprecated: Use <br> or <br /> instead of <<br>>
config.macros.br.handler = function(place)
{
	createTiddlyElement(place,"br");
}

// Find an entry in an array. Returns the array index or null
// @Deprecated: Use indexOf instead
Array.prototype.find = function(item)
{
	var i = this.indexOf(item);
	return i == -1 ? null : i;
}

// Load a tiddler from an HTML DIV. The caller should make sure to later call Tiddler.changed()
// @Deprecated: Use store.getLoader().internalizeTiddler instead
Tiddler.prototype.loadFromDiv = function(divRef,title)
{
	return store.getLoader().internalizeTiddler(store,this,title,divRef);
}

// Format the text for storage in an HTML DIV
// @Deprecated Use store.getSaver().externalizeTiddler instead.
Tiddler.prototype.saveToDiv = function()
{
	return store.getSaver().externalizeTiddler(store,this);
}

// @Deprecated: Use store.allTiddlersAsHtml() instead
function allTiddlersAsHtml()
{
	return store.allTiddlersAsHtml();
}

// @Deprecated: Use refreshPageTemplate instead
function applyPageTemplate(title)
{
	refreshPageTemplate(title);
}

// @Deprecated: Use story.displayTiddlers instead
function displayTiddlers(srcElement,titles,template,unused1,unused2,animate,slowly)
{
	story.displayTiddlers(srcElement,titles,template,animate,slowly);
}

// @Deprecated: Use story.displayTiddler instead
function displayTiddler(srcElement,title,template,unused1,unused2,animate,slowly)
{
	story.displayTiddler(srcElement,title,template,animate,slowly);
}

// @Deprecated: Use functions on right hand side directly instead
var createTiddlerPopup = Popup.create;
var scrollToTiddlerPopup = Popup.show;
var hideTiddlerPopup = Popup.remove;

// @Deprecated: Use right hand side directly instead
var regexpBackSlashEn = new RegExp("\\\\n","mg");
var regexpBackSlash = new RegExp("\\\\","mg");
var regexpBackSlashEss = new RegExp("\\\\s","mg");
var regexpNewLine = new RegExp("\n","mg");
var regexpCarriageReturn = new RegExp("\r","mg");
// ---------------------------------------------------------------------------------
// End of scripts
// ---------------------------------------------------------------------------------
//]]>
</script>
<style type="text/css">

#saveTest {
	display: none;
}

.zoomer {
	display: none;
}

#messageArea {
	display: none;
}

#copyright {
	display: none;
}

.popup {
	position: absolute;
}

#storeArea {
	display: none;
	margin: 4em 10em 3em;
}

#storeArea div {
 padding: 0.5em;
 margin: 1em 0em 0em 0em;
 border-color: #f0f0f0 #606060 #404040 #d0d0d0; 
 border-style: solid; 
 border-width: 2px;
 overflow: auto;
}

#javascriptWarning {
	width: 100%;
	text-align: center;
	font-weight: bold;
	background-color: #dd1100;
	color: #fff;
	padding:1em 0em; 
}

</style>
<!--POST-HEAD-START-->

<!--POST-HEAD-END-->


<script type="text/javascript">
// <![CDATA[
// Begin Ad Muncher helper script
XywXx();
// End Ad Muncher helper script
// ]]>
</script>

</head>
<body AdMchaaa="if(window.checkUnsavedChanges) checkUnsavedChanges();">

<script type="text/javascript">
// Begin Ad Muncher helper script
XywXso(1,"main();");
// End Ad Muncher helper script
</script>


<!--PRE-BODY-START-->

<!--PRE-BODY-END-->
	<script type="text/javascript">
//<![CDATA[
if (useJavaSaver)
	document.write("<applet style='position:absolute;left:-1px' name='TiddlySaver' code='TiddlySaver.class' archive='TiddlySaver.jar' width='1' height='1'></applet>");
//]]>
	</script>
	<div id="copyright">
	Welcome to TiddlyWiki by Jeremy Ruston, Copyright &copy; 2006 Osmosoft Limited
	</div>
	<noscript>
		<div id="javascriptWarning">This page requires JavaScript to function properly</div>
	</noscript>
	<div id="saveTest"></div>
	<div id="contentWrapper"></div>
	<div id="contentStash"></div>
	<div id="storeArea">
<div tiddler="20 March 2009" modifier="YourName" modified="200903202055" created="200903202051" tags="News">Uploaded revised Attachment to Another Person to scribd,com and Free Downloads</div>
<div tiddler="A Survey of Paramattha Dhammas" modifier="AlanWeller" modified="200704150604" created="200704102335" tags="abhidhamma sujin">A Survey of Paramattha Dhammas\n\nAuthor Sujin Boriharnwanaket\n\nTranslator Nina van Gorkom\n\nPublisher: Zolag\n\nISBN :1-897633-21-1\n\nTitle: A Survey of Paramattha Dhammas\n\nPublication Date: 7/5/2006\n\nLanguage: English\n\nBook Type: 5.5 x 8.5 in or 216 x 140 mm (Demy 8vo) Blue Cloth\n\nPage Count: 480 pages\n\nPrice United Kingdom 21.95 GBP. United States 34.95 US Dollars\nBook Description\n\nA Survey of Paramattha Dhammas is a guide to the development of the Buddha's path of wisdom, covering all aspects of human life and human behaviour, good and bad. This study explains that right understanding is indispensable for mental development, the development of calm as well as the development of insight The author describes in detail all mental phenomena (citta and cetasika), and physical phenomena (rupa) and explains the processes of mental phenomena that experience objects through the sense-doors and the mind-door. The last chapters are in the form of questions and answers and deal with the problems one may face in the development of insight. For precision many Pali terms are used but nevertheless the book could be appreciated by both beginners and as well as those who have more background knowledge.\nContents\n\nPart 1 General Introduction\n\n * Chapter 1: the Scriptures and Their Commentaries\n * Chapter 2: The Buddha\n * Chapter 3: Exposition of Paramattha Dhammas 1 (Citta and Cetasika)\n * Chapter 4: Exposition of Paramattha Dhammas 11 (Rupas-matter)\n * Chapter 5: Exposition of Paramattha Dhammas 111 (Nibbana)\n * Chapter 6: Different Aspects of the Paramattha dhammas\n\nPart 11 Citta\n\n * Chapter 7: General Introduction\n * Chapter 8: Citta Knows an Object\n * Chapter 9: A Process of Citta\n * Chapter 10: Functions of Citta\n * Chapter 11: The Duration of Different Proccesses\n * Chapter 12: The Nature of Javana Citta\n * Chapter 13: The Ephemeral Experience of Objects\n * Chapter 14: The Cycle of Birth and Death\n * Chapter 15: The nature of Vipaka\n * Chapter 16: Citta and Cetasika\n * Chapter 17: Cittas of the Sense Sphere\n * Chapter 18: Planes of Existance\n * Chapter 19: Feelings\n * Chapter 20: Associated Dhammas\n * Chapter 21: Roots\n * Chapter 22: Sobhana and Asobhana\n * Chapter 23: The World\n * Chapter 24: The Variegated Nature of Citta\n\nPart 111 Concepts\n\n * Chapter 25: Concepts 1\n * Chapter 26: Concepts 11\n * Chapter 27: Concepts 111\n\nPart 1V The Development of Samatha\n\n * Chapter 28: The Development of Samatha\n * Chapter 29: Factors Leading to Enlightenment\n * Chapter 30: The Stages of Vipassana\n * Chapter 31: Different Kinds of Purity\n * Chapter 32: The Three Kinds of Full Understanding\n * Chapter 33: The Three Attainments\n\nPart V1 Dialogue on Vipassana\n\n * Chapter 34: The Natural Way of development\n * Chapter 35: The Characteristic of Dukkha\n * Chapter 36: The Meaning of Anatta\n\nAppendices\n\n * Appendix 1: Citta\n * Appendix 11: Cetasika\n * Appendix 111: Rupa\n * Questions With Regard to the Appendices</div>
<div tiddler="ADL Press Release" modifier="AlanWeller" modified="200704150603" created="200704102315" tags="abhidhamma gorkom beginner">Press Release\n\nfor release: June 1997\nAbhidhamma in Daily Life\n\nBy Nina van Gorkom\n\n!!!Reality made Real\nWe live mostly in a changing world of ideas. We are caught up in concepts. What is real and important can be lost as we strive to compete. Abhidhamma in Daily Life goes straight to the heart of Buddhist doctrine. It defines what is real with the aim of freeing us from the daily rat race.\n\nThe purpose of the book is to give a fundamental understanding of the five senses: seeing, hearing, touching, tasting, smelling and the all important sixth sense, the mind. Only when we truly understand these six senses can we begin to comprehend what is important and truly real.\n\nAbhidhamma in Daily Life shows us how to apply the basic precepts of Buddhist teaching in our daily life which will impact not only on ourselves, but also on those around us. It cuts through the complexities of the original text, the Pali Tipitaka, simplifying the scriptures without losing their meaning. Many Pali terms are used, but they are defined as they are introduced making it suitable for the beginner as well as practising Buddhists.\n\nAbhidhamma in Daily Life is a vital key for unlocking the deep meaning of the Buddha's teachings and the Buddhist way of life.\n\nAbhidhamma in Daily Life\n\nBy Nina van Gorkom\n\nISBN 1 897633 17 3, 272 pages, paperback, 135mm x 216mm, price 11.95, US $17.95. Published August 5th 1997 by Triple Gem Press. </div>
<div tiddler="Abhidhamma in Daily Life" modifier="AlanWeller" modified="200704150554" created="200704102310" tags="abhidhamma gorkom">Abhidhamma in Daily Life is an exposition of absolute realities in detail. Abhidhamma means higher doctrine and the book's purpose is to encourage the right application of Buddhism in order to eradicate wrong view and eventually all defilements. Many terms in Pali the language of early Buddhism are used and are defined as they are introduced. the book is therefore suitable for beginners as well as practicing Buddhists. It is detailed and precise and an invaluable aid to unlocking the deep meaning of the entire Buddhist canon and applying the theory to our daily lives for the benefit of ourselves and others.\n\n!Product Details\n \n * Paperback: 272 pages\n * Publisher: Triple Gem Press; 3rd Rev edition (July 1997)\n * Language: English\n * ISBN 10: 1897633173\n * ISBN 13: 978-1897633175\n * Product Dimensions: 8.5 x 5.3 x 0.9 inches\n!Contents\n\n[Chapter1] The Four Paramattha Dhammas\n[Chapter 2] The Five Khandhas\n[Chapter 3] Different Aspects Of Citta\n[Chapter 4] The Characteristic Of Lobha\n[Chapter 5] Different Degrees Of Lobha\n[Chapter 6] The Characteristic Of Dosa\n[Chapter 7] Ignorance\n[Chapter 8] Ahetuka Cittas\n[Chapter 9] The Ahetuka Cittas Which Are Unknown In Daily Life\n[Chapter 10] The First Citta In Life\n[Chapter 11] Different Types Of Patisandhi- Citta\n[Chapter 12] The Function Of Bhavanga\n[Chapter 13] Functions Of Citta In The Sense Door Process And In The Mind Door Process\n[Chapter 14] The Function Of Javana\n[Chapter 15] The Functions Of Tadarammana And Cuti\n[Chapter 16] Objects And Doors\n[Chapter 17] Doors And Physical Bases Of Citta\n[Chapter 18] Elements\n[Chapter 19] The Sobhana Cittas In Our Life\n[Chapter 20] Planes Of Existence\n[Chapter 21] Samatha\n[Chapter 22] Jhanacittas\n[Chapter 23] Lokuttara Cittas\n[Chapter 24] Enlightenment</div>
<div tiddler="AbhidhammaindailylifeCorrections" modifier="AlanWeller" modified="200707061430" created="200707061430" tags="">Abhidhamma in Daily lIfe, corrections.\nFrom:\nNina van Gorkom \nDate:\nFri, 13 Oct 2006 20:15:42 +0200\n\nA few corrections to make:\nCh 3, p. 28, cittas instead of citta: &lt; Through the mind-door citta are able to experience all kinds of objects. There can be only one citta at a time and citta can experience only one object at a time.\nWe may understand in theory that a citta which sees has a characteristic which is different from a citta which hears,...&gt;\nCh 7, p. 61: \nWhen we study the Abhidhamma we learn that moha arises with all akusala cittas. Lobha-mla-cittas have moha and lobha as roots; dosa-mla-cittas have moha and lobha as roots. There are two types of akusala citta which have moha as their only root, these are moha-mla-cittas.\n\nchange lobha into dosa. \n\nCh 11, p. 97\n\nThe santraa-citta which is kusala vipka, accompanied by upekkh, can, apart from the function of investigating in a sense-door process, also perform the function of paisandhi in human and heavenly planes.\nChange into: in the human plane and in the lowest heavenly plane.\nCh 12, p. 107, a typo: \nThere are still some bhavanga-cittas arising and falling away before the paca-dvrvajjana-citta (five-door-adverting consciosness) adverts to the sound through the ear-door and hearing arises\n\nchange consciosness into consciousness. \n\nCh 11, p. 110:\n\n1. bhavanga-calana (vibrating bhavanga)\nbhavangupaccheda (arrest-bhavanga)\n\n2. mano-dvrvajjana-citta (mind-door-adverting-\nconsciousness)\n\n3. seven akusala or kusala cittas (or, for the arahat: kiriyacittas)\n \nIt is better to leave out numbers 1,2,3. Without numbers. \nIn my download the footnotes were lost, but yoou have them in PDF?\n</div>
<div tiddler="About" modifier="YourName" modified="200902191050" created="200704091831" tags="">[&gt;img[http://www.zolag.co.uk/sarnethm.jpg]]\nGREETINGS and a BIG WAVE to all SURFERS. Zolag are publishers of Buddhist books and articles. Currently we have eight books in print and on this site thousands of pages of books and articles for free download. \n\n-enjoy.\n\nPicture: A rainy day in Sarneth, India-the birth place of Buddhism\n</div>
<div tiddler="AlanWeller" modifier="YourName" modified="200704141038" created="200704140657" tags="">Alan Weller, author of Zolag</div>
<div tiddler="Audio" modifier="YourName" modified="200704132026" created="200704132026" tags="">Audio Files\n</div>
<div tiddler="Beginners" modifier="AlanWeller" modified="200704150622" created="200704102255" tags="beginner">Go to articles on this site tagged for the beginner by selecting beginner from the grey box on the right.</div>
<div tiddler="Book Ordering" modifier="YourName" modified="200904071153" created="200704151701" tags="">All books can be ordered from:\nWisdom Books\n25 Stanley Road\nIlford\nEssex\nIG1 1RW\nEngland\nhttp://www.wisdom-books.com/</div>
<div tiddler="Books in Print" modifier="AlanWeller" modified="200810280952" created="200704102250" tags="">[[The Buddha's Path]]\n[[Buddhism in Daily Life]]\n[[Abhidhamma in Daily Life]] [[ADL Press Release]]\n[[The World in the Buddhist Sense]]\n[[Metta: Loving kindness in Buddhism]]\n[[The Perfections Leading to Enlightenment]]\n[[A Survey of Paramattha Dhammas]]\n[[Taking Refuge in Buddhism]]\n[[Cetasikas]]\n[[The Buddhist Teaching on Physical Phenomena]]\n\n[[Book Ordering]]</div>
<div tiddler="Buddhism in Daily Life" modifier="AlanWeller" modified="200704150553" created="200704102304" tags="beginner gorkom">By Nina van Gorkom ISBN 1 897633 16 5, 192 pages, paperback, 135mm x 210mm, price  7.95, $ 11.95, available now.\n!Key Points:\n\n * Demonstrates the way in which Buddhist teachings can be applied to daily life.\n * Addresses the question of why we suffer and the solution to suffering.\n * Analyses the benefits of correct Buddhist practice.\n * Illustrates with many quotes from the original scriptures (The Pali Tipitaka).\n * Facilitates the understanding of conventional truth and absolute truth.\n\n!Description:\nA general introduction to the main ideas of Theravada Buddhism. The purpose of this book is to help the reader gain insight into the Buddhist scriptures and the way in which the teachings can be used to benefit both ourselves and others in everyday life. Several chapters are written in the form of question and answer, inspired by questions posed by ordinary people who were confronted with difficulties in the practical application of the teachings. The book will be an invaluable aid for those individuals who wish to develop the Buddhist path to true understanding. Suitable for both practising Buddhists and newcomers to the teachings.\n!Contents:\nGeneral Aspects, Right Understanding in Daily Life, Wholsome Deeds , Mental Development, The Buddha , The Dhamma, The Sangha, Death, Life, The Development Of Calm, Vipassana, The Eightfold Path, Factors of The Eightfold Path, Right Effort, Right Mindfulness, Right Concentration, The Greatest Blessings.</div>
<div tiddler="Can the religion be separated into different groups e.g. denominations and if so what are the main groups and what are the main differences between them?" modifier="YourName" modified="200704141033" created="200704141033" tags="">The religion is separated into different groups. \n\nThe main groups are : Theravada buddhism from south east Asia, Zen from Japan, Tantric buddhism from Tibet. Theravada can be characterised as practical and straightforward whereas Tibetan and Zen are elaborate, speculative, poetic and mystical.\n\n</div>
<div tiddler="Can there be a free will?" modifier="AlanWeller" modified="200904100828" created="200704140655" tags="">From the Buddha's Path chapter 3, page 41.\n\nIt is inevitable that questions arise with regard to the implication of the truth of non-self in ones life. People generally have questions as to the existence of a free will. If there is no self, only empty phenomena which appear and disappear, can there be a free will, can one have a free choice in the taking of decisions in life? Are a free will and self-control not essential elements of human life? The truth of non-self seems to imply that ones whole life is determined, even predestined, by conditions. The answer is that a free will presupposes a lasting personality who can exert power over his will. Since there is no self, merely impermanent phenomena arising because of conditions, there is no free will independent of conditions. The will or desire to act can be wholesome at one moment and unwholesome at another moment. When there is anger, there is volition which is unwholesome, and it can instigate words of anger. When there is generosity, there is volition which is wholesome, it can motivate deeds of generosity. There can be the decision to do particular things, such as the development of generosity or of understanding, but there is no person who decides to do this. There are different moments of decision arising because of different conditions. What one decides to do depends on past accumulations of wholesomeness and unwholesomeness, on ones education, on the friends one associates with. It may be felt that, since accumulations of wholesomeness and unwholesomeness in the past condition ones actions, speech and thoughts today, one would be a helpless victim of these accumulated conditions. What is the sense of life if everything is determined. So long as there is clinging to a concept of self there is enslavement, no freedom. When understanding is developed which can eliminate the clinging to a self one becomes really free. Also the development of understanding is conditioned, it is conditioned by previous moments of understanding, by association with someone who can explain the Dhamma, by the study of the Buddhist teachings. Whatever we think or do is dependent on conditions which operate in our life in an intricate way. The seventh book of the Abhidhamma deals entirely with the different conditions for all mental and physical phenomena of life, with the aim to help people to have more understanding of these conditions. Even freedom is dependent on conditions. The more understanding of realities develops, the more will there be the letting go of clinging to the importance of self, the clinging to wrong perceptions of reality. Eventually all defilements can be eradicated by right understanding and is this not what can be called the highest freedom? </div>
<div tiddler="CetasikaCorrections" modifier="AlanWeller" modified="200707061426" created="200707061425" tags="">&gt;I have a correction in Cetasikas, Book, p. 66, in footnote 2, at the end.\n&gt; (Manasikaara):\n&gt; The other kind of citta which is manasikaara is the\n&gt; mano-dvaaraavajjana-citta ( the mind-door adverting-consciousness). It\n&gt; performs in a sense-door process the function of determining, votthapana,\n&gt; and in the mind-door process it adverts to the object through the\n&gt;mind-door.\n&gt; This citta is succeeded by javana cittas and it is called 'controller of the javanas'.</div>
<div tiddler="Cetasikas" modifier="AlanWeller" modified="200704150550" created="200704150550" tags="abhidhamma gorkom">First edition, author: Nina van Gorkom, ISBN 1897633 18 1, 416 pages, 216mm x 135mm, hardback, price 24, Publication date 1st April 1999.\n!Description:\nCetasika means 'belonging to the mind'. It is a mental factor which accompanies consciousness (citta) and experiences an object. There are 52 cetasikas. This book gives an outline of each of these 52 cetasikas and shows the relationship they have with each other. It will help the student have more understanding of the intricate operations of the mind enabling the development of good qualities and the eventual eradicatication of all defilements. It will help to understand that citta and cetasika act according to their own conditions and that an abiding agent (soul or self) is not to be found. The book assumes some previous knowlege of Buddhism.\nKey Points:\n\n * Helps to understand the deepest motives of our behaviour\n * Helps with both the development of insight and of calm\n * Uses Pali terms for precision of understanding\n * Illustrates with many quotes from the original scriptures (The Pali Tipitaka) and commentaries\n * The detailed analytical approach makes it unique to the field of Buddhist Publishing \n\n!Contents:\nPreface*Introduction*\n\nPart I: The Universals:\n\nChapter I: Contact (phassa)*Chapter 2: Feeling (vedan)*Chapter 3: Perception (sa) *Chapter 4: Volition (cetan)*Chapter 5: Volition in the Cycle of Birth and Death*Chapter 6: Concentration (ekaggat)*Chapter 7: Vitality (jvitindriya) and Attention (manasikra)\n\nPart II: The Particulars (Pakiak)\n\nChapter 8: Applied thinking (vitakka), sustained thinking (vicra)*Chapter 9: Determination (adhimokkha) and Energy (viriya)* Chapter 10: Right Effort of the eightfold Path*Chapter 11: Enthusiasm (pti)*Chapter 12: Zeal (chanda)\n\nPart III: Akusala Cetasikas\n\nChapter 13 : Introduction*Chapter 14: Ignorance, Shamelessness, Recklessness and Restlessness*Chapter 15: Attachment (lobha)*Chapter 16: Wrong View (dihi)*Chapter 17: Conceit (mna)*Chapter 18: Aversion (dosa)*Chapter 19: Envy (iss), Stinginess (macchariya), Regret (kukkucca)*Chapter 20: Sloth (thna), Torpor (middha) and Doubt (vicikicch)*Chapter 21: Different Groups of Defilements Part I*Chapter 22: Different Groups of Defilements Part II*Chapter 23: Different Groups of Defilements Part III\n\nPart IV: Beautiful Cetasikas (Sobhana Cetasikas)\n\nChapter 24: Introduction*Chapter 25: Confidence (saddh)*Chapter 26: Mindfulness (sati)*Chapter 27: Moral Shame and Fear of Blame (hiri and ottappa)*Chapter 28: Non-Attachment (alobha)*Chapter 29: Non-Aversion (adosa)*Chapter 30: Equanimity (tatramajjhattat)*Chapter 31: Six Pairs of Beautiful Cetasikas; tranquillity of body, kya-passaddhi; tranquillity of mind, citta-passaddhi; lightness of cetasikas, kya-lahut; lightness of citta, citta-lahut; pliancy of cetasikas, kya-mudut; pliancy of citta, citta-mudut; wieldiness of cetasikas, kya-kammaat; wieldiness of citta, citta-kammaat; proficiency of cetasikas, kya-pguat; proficiency of citta, citta-pguat; uprightness of cetasika, kya-ujukat; uprightness of citta, citta-ujukat*Chapter 32: The Three Abstinences (virati-cetasikas); abstinence from wrong speech, vaci-duccarita virati; abstinence from wrong action, kya-duccarita virati; abstinence from wrong livelihood, jva-duccarita virati*Chapter 33: Compassion (karu) and Sympathetic Joy (mudit)*Chapter 34: Understanding (pa) Chapter 35: The Stages of Insight Chapter 36: Wholesome Deeds\n\nAppendix 1: Appendix to Chapter 2, Feelings*Appendix 2: Appendix to chapter 5* Appendix 3: Appendix to Chapter 8*Appendix 4: Appendix to Chapter 9* Appendix 5: Appendix to Chapter 11*Appendix 6: Appendix to chapter 12* Appendix 7: Appendix to Chapter 20, Summary of Akusala Cetasikas *Appendix 8: Appendix to chapter 31, Nineteen Sobhana Cetasikas which accompany each Sobhana Citta: Six Sobhana Cetasikas which do not accompany each Sobhana Citta*Appendix 9: The Stages of Insight Three stages of tender insight (tarua vipassan)*Glossary*Index </div>
<div tiddler="Cleanup" modifier="YourName" modified="200901271857" created="200901271856" tags="Pali">%This sed script cleans up a Latex document exported by OpenOffice\ns/\s\sbigskip//g\ns/\s\stextrm//g\ns/\s\stextmd//g\ns/\s\stextit//g\ns/\s\sforeignlanguage{english}//g\ns/\s\stextup//g\ns/\s\stextcolor{black}//g\ns/{//g\ns/}//g</div>
<div tiddler="ConditionsCorrections" modifier="AlanWeller" modified="200707061432" created="200707061432" tags="">Dear Alan,\nI omitted no 5 in Ch 6. :5. The four Great Elements condition the derived rpas by dependence-condition. \nI do not know whether you can correct this? \nNina. \n\n\n\nChapter 6\n\n\nDependence-Condition (Nissaya-Paccaya)\n\n\nThe dependence-condition, nissaya-paccaya, refers to realities which condition other realities by being their support or foundation. We read in the Visuddhimagga (XVII, 79) about dependence-condition, which is here translated as support-condition:\n\n\nA state (dhamma) that assists in the mode of foundation and in the mode of support is a support-condition, as the earth is for trees, as canvas is for paintings, and so on. \n\n\nThis type of condition refers to phenomena which are conascent (arising together) with the phenomena they condition as well as to phenomena which have arisen previously to the phenomena they condition. \n\nWe read in the Pahna (Analytical Exposition, 8) as to the dependence-condition for conascent phenomena:\n\n\n1. The four immaterial khandhas are mutually related to one another by dependence-condition.\n\n2. The four great Elements are mutually related to one another by dependence-condition. \n\n3. At the moment of conception, nma and rpa are mutually related to one another by dependence-condition.\n\n4. States, citta and cetasikas, are related to mind-produced rpa by dependence condition.\n\n5. The four Great Elements condition the derived rpas by dependence-condition. \n\n\n\n</div>
<div tiddler="Contact" modifier="YourName" modified="200708041352" created="200704132028" tags="">Email: aweller32ATgmail.com where AT=@</div>
<div tiddler="Could you briefly describe the attitude to the scriptures and outline the key beliefs of the religion?" modifier="YourName" modified="200704141032" created="200704141032" tags="">#\n\nThe purpose of the scriptures is to help us to understand the true nature of the realities of our daily lives. This in turn will lead to less unhappiness for ourselves and others.\n\nWe are in the cycle of birth and death. We are reborn according to the deeds we have done. A good deed can bring about a rebirth in a pleasant situation and vice versa. Life however is inherently unsatisfactory. The purpose of the teachings is to reach Nibbana which is the end of rebirth. Life is conditioned by attachment. If there is no attachment to anything there will be no more rebirth. Attachment is ended by understanding the true nature of realities.\n\n</div>
<div tiddler="Could you give me the approximate number of followers in the world and the countries they live in?" modifier="YourName" modified="200704141029" created="200704141029" tags="">There are approximately 500 million Buddhists worldwide. They live in Thailand, Sri Lanka, Myanmar (Burma), Cambodia, Bangladesh, China, Japan, Tibet and Mongolia.</div>
<div tiddler="Could you give me the date of origin of the Buddhist faith?" modifier="YourName" modified="200704141028" created="200704141028" tags="">The date of origin of the Buddhist faith is about 500 b.c.</div>
<div tiddler="Could you give me the name of the founder or key figure?" modifier="YourName" modified="200704141029" created="200704141029" tags="">The name of the founder or key figure is Siddhatta Gotama. Gotama is his family name. When he attained enlightenment under the bodhi tree as a young man he became known as The Buddha (awakened).</div>
<div tiddler="Could you give me the name of the teachings or scriptures?" modifier="YourName" modified="200704141030" created="200704141030" tags="">The name of the teachings or scriptures is The Tipitaka (meaning three baskets i.e. Vinaya, Suttanta and Abhidhamma). The teachings are sometimes referred to as the dhamma.</div>
<div tiddler="Could you give me the names and times of the main festivals and what they commemorate?" modifier="YourName" modified="200704141030" created="200704141030" tags="">The Buddhist festivals observe the lunar calendar and occur on the full moon day of the month. The main ones are\n\nVesak: April-May. Commemorates the birth, death and enlightenment of the Buddha.\n\nAsala: June-July. Commemorates the conception of Siddhatta Gotama and his Great Renunciation. The Buddha's first sermon at Isipathana in Benares. His teaching of the Abhidhamma to his mother. Beginning of the first Council.\n\nVap: September-October. Commemorates the renunciation of the lay life by Maitri Bodhisatta (the Buddha to come). Offering of robes to monks who have observed the Retreat (Kathina ceremony).</div>
<div tiddler="Could you give the name of places of worship and the way in which you worship?" modifier="YourName" modified="200704141031" created="200704141031" tags="">Places of worship are called viharas. Worship can also take place at thupas which are monuments erected in memory of buddhism.\n\nThe main aspects of Buddhist worship are:\n\nPaying homage to the Buddha.\n\nExpressing confidence in the Triple Gem i.e. The Buddha, The Sangha (the community of enlightened disciples), The Dhamma (the teachings).\n\nUndertaking to train in the five precepts (abstaining from: killing, stealing, lying, sexual misconduct, taking drugs or alcohol).\n\nOfferings of requisites for the monks (food, robes, etc).\n\nListening to sermons.</div>
<div tiddler="DefaultTiddlers" modifier="YourName" modified="201007181256" created="200704092317" tags="">[[FAQ]]\n[[School Projects]]</div>
<div tiddler="Discussions" modifier="AlanWeller" modified="200704150708" created="200704150705" tags="beginner abhidhamma">!Dhamma Study Group (DSG)\nA discussion forum for anyone interested in understanding the Buddha's teachings as found in all three baskets of the Tipitaka, the original record of the Buddha's word in the Theravada tradition, and as further elucidated in the ancient commentaries of that tradition.\n\nThe discussions include matters of both theory and practice, with the aim of developing precise understanding of dhammas (the realities of the present moment).\n\nThe group started in Bangkok in the early 1970's under the guidance of the Thai Theravadin teacher Khun Sujin Boriharnwanaket. \n\nhttp://groups.yahoo.com/group/dhammastudygroup/\n\n</div>
<div tiddler="Does the Buddha's life and teachings have any relevance to modern living?" modifier="YourName" modified="200704141034" created="200704141034" tags="">His life and teachings do have relevance to modern day living, indeed they are very beneficial to modern daily life.\n\nAs a young man the future Buddha was not content to live blindly in the world. He wanted to know the truth of life. He wanted answers to such questions as: why we are born, why we get old, why we suffer, why we die. He wanted to search the truth in order to help others have less suffering and to help people live in peace and harmony together.\n\nAt the age of 26 he renounced the luxuries of home life and devoted himself solely to the pursuit of the truth. Six years later he became fully enlightened, a Buddha. He had come to know the true nature of the physical phenomena and mental phenomena as well as discovering their cause and conditions. He had discovered the path to enlightenment and for the next 45 years he taught others this path in order for them (and you and I) to realize this same truth.\n\nThe Buddha's Teachings can help us to understand our daily life in a way which has not been understood before. This understanding will help us to know ourselves enabling us to understand our own mind and the different causes for our different mental states. We will come to know more about our unwholesome, unskilful states of mind and our wholesome, skilful, states of mind. This in turn will lead to the gradual cultivation of good states of mind. Finally when wisdom is highly developed it will eliminate bad states of mind forever at the moment of becoming enlightened.\n\nGreed, hatred, delusion cause great distress in modern day life. Kindness, compassion, generosity, wisdom cause great happiness in modern day life. To have less of the former and more of the latter is why Buddhism is relevant and beneficial in modern living. </div>
<div tiddler="DownloadList" modifier="AlanWeller" modified="200704261959" created="200704261959" tags="">Please note this is a list of available downloads you cannot downlad from here you must go to [[Downloads]]\n!Books in Print\n\nabhidhamma_in_dailylife.pdf	525 KB	\nabhidhamma_in_dailylife.rtf	869 KB	\n\nbuddas_path.rtf	345 KB	\nbuddhas_path.txt	250 KB	\n\nbuddhism_in_dailylife.pdf	358 KB	\nbuddhism_in_dailylife.rtf	477 KB	\n\ncetasikas.pdf	734 KB	4/11/2007\ncetasikas.rtf	1 MB	4/11/2007\n\nmetta_lovingkindness.pdf	404 KB	\nmetta_lovingkindness.txt	198 KB	\n\nperfections22,03,07.odt	153 KB	\nperfections22,3,07.pdf	861 KB	\n\nworld_in_the_buddhistsense.html	250 KB	\nworld_in_the_buddhistsense.rtf\n\nsurvey_pdhammas.zip	238 KB	\n\ntakingrefuge.pdf	197 KB	\ntakingrefuge.rtf\n\n!Books and Articles\n\n	alone_with_dhamma.pdf	150 KB	\n	alone_with_dhamma.txt	60 KB	\n	asoka_footsteps.pdf	133 KB	\n	asoka_footsteps.zip	58 KB	\n	attachment_to_aperson.odt	18 KB	\n	attachment_to_aperson.pdf	67 KB	\n\n	conditions.pdf	282 KB	\n	conditions.rtf	555 KB	\n	conditions.txt	318 KB	\n	deed_of_merit.rtf	329 KB	\n	deeds_of_merit.html	305 KB	\n	dhamma_in_cambodia.zip	69 KB	\n	dhamma_issues_foundation.html	145 KB	\n	India_pilgrimage.rtf	114 KB	4/11/2007\n	intro_buddhas_scriptures.zip	65 KB	\n	letters_from_nvg.zip	49 KB	\n	listeningtodhamma.pdf	223 KB	\n	listeningtodhamma.zip	33 KB	\n	meaningofdhamma.txt	34 KB	\n	\n	ninasletters.zip	83 KB	\n	phrases.html	25 KB	\n	preserving_the_buddhas_teachings.zip	54 KB	\n	rupas.pdf	319 KB	\n	rupas.rtf	209 KB	\n	understanding_reality.pdf	33 KB	\n	understanding_reality.txt	17 KB	\n\n!Pali Fonts\n\n        pali_fonts_forMac.zip	108 KB	\n	pali_fonts_forPC.zip	132 KB	\n\n!Audio Files\n\nA_BodhGaya_01.mp3	9 MB	\n	</div>
<div tiddler="Download_Corrections" modifier="AlanWeller" modified="200707070805" created="200707061423" tags="">This page contains corrections for all articles and books:\n\nCetasikaCorrections\n\nAbhidhammaindailylifeCorrections\n\nConditionsCorrections</div>
<div tiddler="Downloads" modifier="AlanWeller" modified="200904060830" created="200707070800" tags="">Copyright Notice: These books may be copied and freely distributed or sold. You are free to alter the layout and type. However the text content may not be altered in any way without prior permission.\n\nBooks and articles may appear without the correct Pali accents. In order to view accents correctly our PaliFonts must be used (after downloading the text to your PC). These are available for PC and MAC.\nTexts are in these formats: pdf, rtf, txt, zip and odt (OpenOffice)\n\nFor better viewing/rss feed go to [[scribd.com/alan weller|http://www.scribd.com/people/documents/1746908-alanweller?page=1]] or to view specific documents go here ScribdAw\n\n*Introduction to the Buddhist Scriptures //by Nina van Gorkom//\n**[[Part 1|http://www.zolag.co.uk/ibs1.html]]\n**[[Part 2|http://www.zolag.co.uk/ibs2.html]]\n**[[Part 3|http://www.zolag.co.uk/ibs3.html]]\n**[[Part 4|http://www.zolag.co.uk/ibs4.html]]\n**[[Part 5|http://www.zolag.co.uk/ibs5.html]]\n     \n*The Buddha's Path //by Nina van Gorkom//\n**[[bpath.rtf|http://www.zolag.co.uk/bpath.rtf]]\n**[[bpath.txt|http://www.zolag.co.uk/Bpath.txt]]\n       \n*Listening to Dhamma //by Nina van Gorkom//      \n**[[Part 1|http://www.zolag.co.uk/list1.html]]\n**[[Part 2|http://www.zolag.co.uk/list2.html]]\n**[[Listening_to_Dhamma.pdf|http://www.zolag.co.uk/listeningtodhamma_edited.pdf]]\n     \n*Letters from Nina //by Nina van Gorkom//      \n**[[Part 1|http://www.zolag.co.uk/lett1.html]]\n**[[Part 2|http://www.zolag.co.uk/lett2.html]]\n**[[Part 3|http://www.zolag.co.uk/lett3.html]]\n   \n*A Survey of Paramattha Dhammas //by Sujin Boriharnwanaket//  \n**[[Preface|http://www.zolag.co.uk/Pres.htm]]\n**[[Part 1|http://www.zolag.co.uk/Para1.htm]]\n**[[Part 2|http://www.zolag.co.uk/Para2.htm]]\n**[[Part 3|http://www.zolag.co.uk/Para3.htm]]\n**[[Part 4|http://www.zolag.co.uk/Para4.htm]]\n**[[Part 5|http://www.zolag.co.uk/Para5.htm]]\n**[[Part 6|http://www.zolag.co.uk/Para6.htm]]\n**[[Part 7|http://www.zolag.co.uk/Para7.htm]]\n**[[Part 8|http://www.zolag.co.uk/Para8.htm]]\n**[[Part 9|http://www.zolag.co.uk/Para9.htm]]\n**[[Part 10|http://www.zolag.co.uk/Para10.htm]]\n**[[Part 11|http://www.zolag.co.uk/Para11.htm]]\n**[[Part 12|http://www.zolag.co.uk/Para12.htm]]\n**[[Part 13|http://www.zolag.co.uk/Para13.htm]]\n**[[Part 14|http://www.zolag.co.uk/Para14.htm]]\n**[[Part Appendix 1|http://www.zolag.co.uk/App1s.htm]]\n**[[Appendix 2|http://www.zolag.co.uk/App2s.htm]]\n**[[Appendix 3|http://www.zolag.co.uk/App3s.htm]]\n   \n*Dhamma in Cambodia //by Nina van Gorkom//    \n**[[Preface|http://www.zolag.co.uk/cface.html]]\n**[[Part 1|http://www.zolag.co.uk/art1a.html]]\n**[[Part 2|http://www.zolag.co.uk/art1b.html]]\n**[[Part 3|http://www.zolag.co.uk/art2a.html]]\n     \n*Preserving the Buddha's Teachings //by Nina van Gorkom//     \n**[[Part 1|http://www.zolag.co.uk/preserv1.html]]\n**[[Part 2|http://www.zolag.co.uk/preserv2.html]]\n     \n*Taking Refuge in Buddhism //by Sujin Boriharnwanaket//  \n**[[tribb.txt|http://www.zolag.co.uk/trib.txt]]\n**[[tribb.pdf|http://www.zolag.co.uk/tribb.pdf]]\n**[[trib.rtf|http://www.zolag.co.uk/trib.rtf]]\n     \n*The Buddhist Teaching's on Physical Phenomena//by Nina van Gorkom//   \n**[[ruptexmg.tex|http://www.zolag.co.uk/ruptexmg.tex]]\n**[[9781897633243_text.pdf|http://www.zolag.co.uk/9781897633243_text.pdf]]\n\n*Buddhism in Daily Life //by Nina van Gorkom//     \n**[[bdlfinal.pdf|http://www.zolag.co.uk/bdlfinal.pdf]]\n**[[bdlfinal.rtf|http://www.zolag.co.uk/finalbdl.rtf]]\n**[[finalbdl.txt|http://www.zolag.co.uk/finalbdl.txt]]\n     \n*Abhidhamma in Daily Life //by Nina van Gorkom//   \n**[[adlfinal.txt|http://www.zolag.co.uk/adlfinal.txt]]\n**[[adlfinal.pdf|http://www.zolag.co.uk/adlfinal.pdf]]\n**[[adlfinal.rtf|http://www.zolag.co.uk/adlfinal.rtf]]\n    \n*Cetasikas //by Nina van Gorkom//    \n**[[cetfinal.txt|http://www.zolag.co.uk/cetfinal.txt]]\n**[[cetfinal.pdf|http://www.zolag.co.uk/cetfinal.pdf]]\n**[[cetfinal.rtf|http://www.zolag.co.uk/cetfinal.rtf]]\n**[[cetfinal.html|http://www.zolag.co.uk/cetfinal.html]]\n\n*Conditions //by Nina van Gorkom//    \n**[[conditions.txt|http://www.zolag.co.uk/conditions.txt]]\n**[[condf.pdf|http://www.zolag.co.uk/condf.pdf]]\n**[[condf.rtf|http://www.zolag.co.uk/condf.rtf]]\n**[[conditions.html|http://www.zolag.co.uk/conditions.html]]\n**[[rZconditions.txt (corrected by Connie 20/11/03)|http://www.zolag.co.uk/rZconditions.txt]]\n\n*Letters about Vipassana //by Nina van Gorkom//     \n**[[vipns.pdf|http://www.zolag.co.uk/vipns.pdf]]\n**[[vipintro.rtf|http://www.zolag.co.uk/vipintro.rtf]]\n**[[vip1.rtf|http://www.zolag.co.uk/vip1.rtf]]\n**[[vip2,3.rtf|http://www.zolag.co.uk/vip2,3.rtf]]\n**[[vip4.rtf|http://www.zolag.co.uk/vip4.rtf]]\n**[[vip5.rtf|http://www.zolag.co.uk/vip5.rtf]]\n**[[vip6.rtf|http://www.zolag.co.uk/vip6.rtf]]\n**[[vip7.rtf|http://www.zolag.co.uk/vip7.rtf]]\n**[[vip8.rtf|http://www.zolag.co.uk/vip8.rtf]]\n**[[vip9.rtf|http://www.zolag.co.uk/vip9.rtf]]\n**[[vip10.rtf|http://www.zolag.co.uk/vip10.rtf]]\n**[[vip11.rtf|http://www.zolag.co.uk/vip11.rtf]]\n    \n*Following in Asoka's Footsteps //by Nina van Gorkom//     \n**[[asoka.pdf|http://www.zolag.co.uk/asoka.pdf]]\n**[[asoka 1|http://www.zolag.co.uk/asoka1.rtf]]\n**[[asoka 2|http://www.zolag.co.uk/asoka2.rtf]]\n**[[asoka 3|http://www.zolag.co.uk/asoka3.rtf]]\n**[[asoka 4|http://www.zolag.co.uk/asoka4.rtf]]  \n    \n*Realities and Concepts //by Sujin Boriharnwanaket (no pali acccents)// \n**[[cone.pdf|http://www.zolag.co.uk/cone.pdf]]\n\n*Understanding Reality //by Nina van Gorkom (7 page article)// \n**[[realf.pdf|http://www.zolag.co.uk/realf.pdf]]\n**[[ureal.txt|http://www.zolag.co.uk/ureality.txt]]\n\n*World in the Buddhist Sense //by Nina van Gorkom//     \n**[[witbs.txt|http://www.zolag.co.uk/witbs.txt]]\n**[[witbs.rtf|http://www.zolag.co.uk/witbs.rtf]]\n**[[witbs.html|http://www.zolag.co.uk/witbs.html]]\n\n*Deeds of Merit //by Sujin Boriharnwanaket//      \n**[[mettab.html|http://www.zolag.co.uk/mettab.html]]\n**[[metta.rtf|http://www.zolag.co.uk/metta.rtf]]\n**[[metta_edited.odt|http://www.zolag.co.uk/metta_edited.odt]]\n**[[metta_edited.pdf|http://www.zolag.co.uk/metta_edited.pdf]]   \n\n*The Perfections Leading to Enlightenment //by Sujin Boriharnwanaket//      \n**[[1897633238text.pdf|http://www.zolag.co.uk/1897633238text.pdf]]\n**[[Perfections.odt|http://www.zolag.co.uk/perfectionsf.odt]]\n**[[perfectionsf.doc|http://www.zolag.co.uk/perfectionsf.doc]]\n**[[perfectionsf.rtf|http://www.zolag.co.uk/perfectionsf.rtf]]\n\n*Nina van Gorkom's Letters     \n**[[timeas.html|http://www.zolag.co.uk/timeas.html]]\n**[[dhamma in Thailand|http://www.zolag.co.uk/dhthail.html]]\n**[[Perseverence in Dhamma|http://www.zolag.co.uk/persev.html]]\n**[[Bramahaviharas|http://www.zolag.co.uk/brahma.html]]\n     \n*Foundation Dhamma Issues //by Nina van Gorkom//      \n**[[dhamma issues.html|http://www.zolag.co.uk/dhissues.html]]\n\n*India Pilgrimmage 2004 //by Nina van Gorkom//\n**[[India Pilgrimmage 2004|http://www.zolag.co.uk/Indiacopy.rtf]]\n**[[India Pilgrimmage 2004 (txt)|http://www.zolag.co.uk/Indiacopy.txt]]\n\n*Metta: Lovingkindness in Buddhism //by Sujin Boriharnwanaket//\n**[[Mettf5.txt|http://www.zolag.co.uk/Mettf5.txt]]\n**[[Mettf5_edited.pdf|http://www.zolag.co.uk/Mettf5_edited.pdf]]\n\n*Meaning of Dhamma //by Nina van Gorkom//\n**[[meaningofdhammatxt.txt|http://www.zolag.co.uk/meaningofdhammatxt.txt]] \n**[[meaniningofdh.rtf (corrected)|http://www.zolag.co.uk/meaningofdh.rtf]]\n\n*Alone with Dhamma: Pilgrimmage in India October 2005 //by Nina van Gorkom//\n**[[alone.txt|http://www.zolag.co.uk/alone.txt]]\n**[[alone_edited.pdf|http://www.zolag.co.uk/alone_edited.pdf]]\n\n*Phrases //compiled by Alan Weller//\n**[[Phrases|http://www.zolag.co.uk/phras.html]]\n\n*Attachment to Another Person //by Sarah Abbott//\n**[[attachmenttopeople.pdf|http://www.zolag.co.uk/attachmenttopeople.pdf]]\n**[[attachmenttopeople.doc|http://www.zolag.co.uk/attachmenttopeople.doc]]\n\n!!Audio\n\n**[[A_BodhGaya_01.mp3|http://www.zolag.co.uk/A_BodhGaya_01.mp3]]\n\nMore audio files from here [[Dhamma Study Group|http://www.dhammastudygroup.org]] \n\n\nDownload_Corrections\n</div>
<div tiddler="Downloads2" modifier="AlanWeller" modified="200901272329" created="200704102254" tags=""></div>
<div tiddler="FAQ" modifier="AlanWeller" modified="200904100829" created="200704102253" tags="beginner">[[What is Buddhism?]]\n[[What is the meaning of the word Buddha?]]\n[[What is Wrong View (Ditthi)?]]\n[[What the use is of knowing the details about citta and cetasikas?]]\n[[What is Abhidhamma?]]\n[[What is Kamma (karma)?]]\n[[Should Buddhists be vegetarians?]]\n[[What is meditation?]]\n[[What is the origin of the Buddhist texts of the Theravada tradition?]]\n[[What are the conditions for enlightenment?]]\n[[Can there be a free will?]]\n[[What is the Buddhist answer to the problem of suffering?]]\n[[In what way does Buddhism differ from other mainstream religions?]]\n[[How can awareness be developed while doing complicated things?]]\n[[What is nibbana (nirvana)?]]\n[[Many religions teach about heaven and hell. In what respect are the Buddhist teachings different?]]\n[[How can the Buddha's teachings be proved?]]\n[[What can we do to overcome these accumulated tendencies to akusala (unwholesomeness)?]]\n[[What is the process of cittas which arise and perform each their own function while they experience a sense object?]]\n[[Who should be our guide?]]\n[[Who is the maker of this human being?]]\n[[The Missing Missis: Whatever happened to Mrs Buddha and her son?]]\n[[Who destroys Buddhism?]]\n[[What sort of person is a better man than a good man?]]\n[[I've heard it said that Abhidhamma is not necessary. After all the Buddha taught only suffering and the end of suffering?]]\n[[There appear to be two heavyweights at understanding the world-buddhism and physics. What do they have in common and where do they differ?]]</div>
<div tiddler="FontSizePlugin" modifier="AlanWeller" modified="200812071315" created="200812071306" tags="systemConfig">config.fontSize={};\n\n//configuration settings\nconfig.fontSize.settings =\n{\n            defaultSize : 100,  // all sizes in %\n            maxSize : 200,\n            minSize : 40,\n            stepSize : 10\n};\n\n//startup code\nvar fontSettings = config.fontSize.settings;\n\nif (!config.options.txtFontSize)\n            {config.options.txtFontSize = fontSettings.defaultSize;\n            saveOptionCookie(&quot;txtFontSize&quot;);}\nsetStylesheet(&quot;.tiddler .viewer {font-size:&quot;+config.options.txtFontSize+&quot;%;}\sn&quot;,&quot;fontResizerStyles&quot;);\nsetStylesheet(&quot;#contentWrapper .fontResizer .button {display:inline;font-size:105%; font-weight:bold; margin:0 1px; padding: 0 3px; text-align:center !important;}\sn .fontResizer {margin:0 0.5em;}&quot;,&quot;fontResizerButtonStyles&quot;);\n\n//macro\nconfig.macros.fontSize={};\nconfig.macros.fontSize.handler = function (place,macroName,params,wikifier,paramString,tiddler)\n{\n\n               var sp = createTiddlyElement(place,&quot;span&quot;,null,&quot;fontResizer&quot;);\n               sp.ondblclick=this.onDblClick;\n               if (params[0])\n                           createTiddlyText(sp,params[0]);\n               createTiddlyButton(sp,&quot;+&quot;,&quot;increase font-size&quot;,this.incFont);\n               createTiddlyButton(sp,&quot;=&quot;,&quot;reset font-size&quot;,this.resetFont);\n               createTiddlyButton(sp,&quot;&quot;,&quot;decrease font-size&quot;,this.decFont);\n}\n\nconfig.macros.fontSize.onDblClick = function (e)\n{\n             if (!e) var e = window.event;\n             e.cancelBubble = true;\n             if (e.stopPropagation) e.stopPropagation();\n             return false;\n}\n\nconfig.macros.fontSize.setFont = function ()\n{\n               saveOptionCookie(&quot;txtFontSize&quot;);\n               setStylesheet(&quot;.tiddler .viewer {font-size:&quot;+config.options.txtFontSize+&quot;%;}\sn&quot;,&quot;fontResizerStyles&quot;);\n}\n\nconfig.macros.fontSize.incFont=function()\n{\n               if (config.options.txtFontSize &lt; fontSettings.maxSize)\n                  config.options.txtFontSize = (config.options.txtFontSize*1)+fontSettings.stepSize;\n               config.macros.fontSize.setFont();\n}\n\nconfig.macros.fontSize.decFont=function()\n{\n\n               if (config.options.txtFontSize &gt; fontSettings.minSize)\n                  config.options.txtFontSize = (config.options.txtFontSize*1) - fontSettings.stepSize;\n               config.macros.fontSize.setFont();\n}\n\nconfig.macros.fontSize.resetFont=function()\n{\n\n               config.options.txtFontSize=fontSettings.defaultSize;\n               config.macros.fontSize.setFont();\n}\n\nconfig.paramifiers.font =\n{\n               onstart: function(v)\n                  {\n                   config.options.txtFontSize = v;\n                   config.macros.fontSize.setFont();\n                  }\n};</div>
<div tiddler="Free eBooks" modifier="AlanWeller" modified="200812210953" created="200812071121" tags="">For free eBooks /rss feed go to [[Scribd/Alan Weller|http://www.scribd.com/people/documents/1746908-alanweller?page=1]]. For the old page of free downloads go here [[Downloads]]</div>
<div tiddler="Help" modifier="YourName" modified="200704151445" created="200704141155" tags="beginner">This web site is a single page document which displays chunks of information called Tiddlers. To close an open Tiddler go to the top right of the Tiddler window with your mouse. A menu should appear with a close option. Also to the far right is a close all choice in the menu.\nEach Tiddler is tagged (the grey box to the right), by selecting an item from the tag list you can navigate to other items with the same tag.</div>
<div tiddler="How can awareness be developed while doing complicated things?" modifier="AlanWeller" modified="200704140659" created="200704140659" tags="">Extract from The World in the Buddhist Sense, letter 8\n\nDear Mr. G.,\n\nYou found it difficult to be aware while doing complicated things. I will quote from your letter:\n\nemembering a combination of numbers in order to open a safe, there cannot be awareness. I find that a special effort is needed for awareness of nama and rupa. While I have to exert myself to do complicated things I have no energy left for awareness. When I, for exampl ytrregffddxccvvbbyes When I do things which can be performed automatically, like shaving, eating and walking, there can be awareness. But when I do complicated things like re, study a foreign language and I make an effort to memorize the words, I exclude all other things from my mind. At such moments I could not be aware.\n\nyou are very very naughty boy no yes you are.knnnn[]]kj4r/ Shaving, walking, eating, opening a safe, all these things we can do because there are conditions to be able to do them. If you had not been taught you would not know how to open a safe. Remembering something is nama, arising because of conditions. If we forget something, that also depends on conditions. The more we understand that realities are only nama and rupa, arising because of their own conditions, the less will there be hindrances to awareness. Realities such as visible object, hardness or feeling arise already because of their own conditions and you can begin to consider their different characteristics. You should not think of having to make an effort for sati because then there is still a notion of self who is aware. Sati can arise naturally in your daily life. When there is the study with awareness of one reality at a time there is a beginning of understanding. One should not try to hold on to realities in order to study them, because they do not stay.\n\nWe believe that realities are the way we experience them, but in fact we experience them in a distorted way. It seems to us that realities such as hardness or visible object stay because their arising and falling away has not been realized yet. Their impermanence cannot be realized so long as panna has not yet been developed to that stage. We know in theory that there is no self, but we still cling to the idea of self who is aware. We may take energy or effort for self. Effort or energy (viriya) is a cetasika, a mental factor which arises with many cittas, though not with each type. It arises with the citta and falls away together with it. When it accompanies kusala citta it is kusala and when it accompanies akusala citta it is akusala. There is no self who can exert control over effort, who can cause it to be kusala. When there is right awareness of a nama or rupa which appears through one of the six doors, there is already right effort accompanying the kusala citta. We do not have to try or to think of effort. When there is still wrong view, we may think that we cannot be aware while doing complicated things. We may think that at such moments awareness is more difficult than when we are walking or doing things which do not require much attention. In reality there is no difference. If one believes that there is a difference, one does not know what right awareness is. If there is less of a preconceived idea that in particular situations awareness is impossible, there can be awareness also while doing complicated things. We may be absorbed in what we are doing, but that doesnt matter. Being absorbed is a reality, it can be known as only a type of nama. Realities appear already because of their own conditions, and gradually we can learn to study their characteristics.\n\nMisunderstandings are bound to arise as to what awareness really is and because of these misunderstandings people think that it is impossible to be aware in daily life. Someone wrote, for instance, that awareness is the same as keeping oneself under constant observation. We should observe ourselves in action, he said, and this can be done quite simply by asking oneself, What am I doing?. He thought that in this way we learn to be aware of what we are doing and that this constitutes awareness. The word awareness in conventional language has a meaning which is different from awareness, sati, of the Eightfold Path. When we ask ourselves, What am I doing?, what is the reality at that moment? There are many types of citta which think at such moments. If we do not realize that it is nama which thinks while we ask ourselves, What am I doing?, the wrong view of self will not be eradicated. There is only thinking about the self who is performing different actions. There is no sati of the Eightfold Path, there is no development of understanding of the different characteristics of nama and rupa. When we are reading and we answer the question, What am I doing?, with, I am reading, without development of understanding, we live only in the world of conventional truth. We will continue to be ignorant of the absolute truth, the truth about nama and rupa. When we are reading, is there not the nama which experiences visible object, is there not the rupa which is visible object, is there not the nama which thinks about the meaning of what is read, and should these realities not be known? It is the same when we are walking, talking or eating, if we only know I am walking, talking and eating, it is not at all helpful for the development of panna. There is still the wrong view of self. While we are walking, talking and eating there are nama and rupa appearing through the six doors, and right understanding can be developed of them. Some people believe that they have to slow down all their movements in order to be able to be aware. Is there desire for awareness? If one is not aware naturally in ones daily life panna cannot develop. The Satipatthana sutta (Middle Length Sayings I, no. 10) reminds us to be aware in our daily life, no matter what we are doing.\n\nWe read under the section of mindfulness of the body, regarding the postures:\n\n And again, monks, a monk, when he is walking, comprehends, I am walking; or when he is standing still, comprehends, I am standing still; or when he is sitting down, comprehends, I am sitting down; or when he is lying down, comprehends, I am lying down. So that however his body is disposed he comprehends that it is like that. Thus he fares along contemplating the body in the body internally, or he fares along contemplating the body in the body externally, or he fares along contemplating the body in the body internally and externally...\n\nThe commentary to this sutta, the Papancasudani explains the words, When he is going, a monk understands I am going as follows:\n\n In this matter of going, readily do dogs, jackals and the like, know when they move on that they are moving. But this instruction on the modes of deportment was not given concerning similar awareness, because awareness of that sort belonging to animals does not shed the belief in a living being, does not knock out the perception of a soul and neither becomes a subject of meditation nor the development of satipahana.\n\nThe commentary explains that there is no living being. There is going on account of the diffusion of the process of oscillation (motion) born of mental activity. There are only nama and rupa which arise because of conditions. When the monk is walking, standing, sitting or lying down, he contemplates the body in the body, he does not take the body for self. He is mindful of the realities which appear.\n\nWe read in the following section of the sutta, the section on clear comprehension:\n\n And again, monks, a monk when he is setting out or returning is one acting in a clearly conscious way; when he is looking in front or looking around... when he has bent in or stretched out (his arm)...when he is carrying his outer cloak, bowl and robe... when he is obeying the calls of nature... when he is walking, standing, sitting, asleep, awake, talking, silent, he is one acting in a clearly conscious way. Thus he fares along contemplating the body in the body internally...externally... internally and externally...\n\nIf one thinks of the body as a whole the arising and falling away of rupas cannot be realized and one will continue to cling to the idea of my body. During all ones activities there can be the development of right understanding, so that wrong view can be eradicated.\n\nSati is not: observing oneself in action. Sati arises with each beautiful (sobhana) citta and its function is being non-forgetful of what is wholesome. Sati is different from the cetasika sanna, remembrance or perception, which arises with each citta. Sanna recognizes or marks the object, so that it can be recognized later on. Sati of the Eightfold Path is mindful of the reality which presents itself at the present moment, and then right under-standing of it can be developed. We do not have to think of sati, it arises when there are conditions for it. When right understanding of a reality which presents itself is being developed, there is also sati which is mindful, non-forgetful, of that reality. For example, when the characteristic of hardness appears and it is realized as a kind of rupa, it is evident that there is sati. When we think, I am eating and we are not aware of different namas and rupas which appear, there is a concept of self who is eating. When right understanding is developed the self is broken up into different nama-elements and rupa-elements. In order that right under-standing can be developed there should be mindfulness of a characteristic of nama or rupa, not mindfulness without knowing anything.\n\nIf one thinks that sati means keeping oneself under constant observation, one is bound to believe that it is impossible to be aware while doing things which require special attention. One may be urged to make special efforts in order to create conditions for a great deal of sati. Any speculation about creating conditions for the arising of sati distracts from the study of the reality appearing right at this moment. It is thinking of the future instead of being aware of aversion now, seeing now, thinking now. There is clinging to an idea of self who can control awareness, and in that way there will not be detachment from the concept of self.\n\nIf we understand more clearly that our life consists of nama and rupa which arise because of conditions, we will be less absorbed in the idea of self while we do complicated things. Also at such moments there are only nama and rupa. We may believe that while we are talking there cannot be awareness, since we have to think about what we are saying. There is sound and can there not be awareness of it? It is citta, not self, which thinks about what we are going to say and which conditions sound. There can be awareness of realities in between thinking. I noticed that while I am writing the Chinese script (Kanji), it is possible to hear other people talking or to think of other things. This shows that there are many different types of cittas which succeed one another so rapidly that it seems that they occur all at the same time. Since there can be hearing or thinking in between the writing of Kanji, there can also be awareness in between.\n\nYou mentioned that you could not be aware while learning a foreign language. Learning a foreign language can teach us about reality. When we learn a foreign language such as Japanese we cannot in the beginning translate quickly. Later on we acquire skill and it seems that we do it automatically. When we hear a Japanese word we immediately know the meaning, it seems that hearing and knowing the meaning occur at the same time. However, we know that they are different moments of citta. Also when we hear words spoken in our own language there is hearing and then translating going on, we interpret the sounds so that we understand the meaning. The process of translation goes on very rapidly, it goes on the whole day. When there is seeing, visible object is experienced, but immediately we translate what we see, we interpret it, and then we discern people and things. If we consider the process of translation we can understand more clearly that seeing and hearing are different from thinking. The moments that we do not translate seeing and hearing can be studied. Thus, no matter whether you learn a foreign language or whether you are merely thinking after seeing or hearing, there is translating going on time and again. No matter what we do, there are nama and rupa, and sometimes sati can arise and be aware of them. We cannot control the cittas which arise. They arise and perform their own functions. So long as we believe that we can create conditions for the arising of sati, the right awareness will not arise. One may believe that there is sati when there is only ignorance of realities. Awareness can arise if there are conditions for it. The conditions are listening to the Dhamma and considering it. We may believe that we have listened and considered enough, but, when there are still misunderstandings about the Eightfold Path it is evident that our listening and considering have not been enough. We should not assume too soon that we studied enough. We have accumulated ignorance for aeons and therefore it will take aeons before it can be eradicated. This should not discourage us, but we should continue to listen, to read and to study, and we should consider thoroughly what we learnt. We should consider the Dhamma with regard to our own experiences in daily life.\n\nRahula, the Buddha's son, attained arahatship when he was only twenty years old. For him the conditions necessary for enlightenment were fulfilled: he associated with the right person, the Buddha, he listened to the Dhamma, he considered it and he developed the Eightfold Path. We read in the Middle Length Sayings (II, no. 62, Greater Discourse on an Exhortation to Rahula) that Rahula asked the Buddha how mindfulness of breathing, when it is developed and made much of, is of great fruit, of great advantage. The Buddha did not speak immediately about mindfulness of breathing, he first taught Rahula about the elements of solidity, cohesion, heat, motion and space. No matter whether these elements are internal or external, they should not be taken for self. The Buddha then said to Rahula:\n\n Develop the mind-development that is like the earth, Rahula. For, from developing the mind-development that is like the earth, Rahula, agreeable and disagreeable sensory impressions that have arisen, taking hold of your thought, will not persist.\n\nIn the same way the Buddha told Rahula to develop the mind-development that is like water, fire, wind and space (air). What are we doing when there are agreeable or disagreeable sense-impressions that take hold of us? Do we take them for self, or can we realize them as only elements? Rahula had to be mindful of all realities appearing through the six doors in order to see them as only elements.\n\nFurther on we read that the Buddha encouraged Rahula to the development of lovingkindness, compassion, sympathetic joy, equanimity, the contemplation of the foul and the perception of impermanence. It was only after the Buddha had taught all this to Rahula that he spoke about mindfulness of breathing. Rahula did not apply himself to this subject without knowing anything. While he applied himself to mindfulness of breathing he realized the true nature of all namas and rupas appearing through the six doors. He had accumulated great wisdom and therefore he was able to develop mindfulness of breathing so that it was of great fruit, of great advantage. The Buddha said that if it was developed in that way the final in-breaths and out-breaths too are known as they cease, they are not unknown. The Buddha taught Rahula about the eye, visible object and seeing-consciousness, about all realities which appear through the six doors. He taught Rahula until he attained arahatship. We read in the Kindred Sayings ( IV, Salayatana-vagga, Kindred Sayings on Sense, Third Fifty, Chapter II, paragraph 121, Rahula) that it occurred to the Buddha, while he was near Savatth, at the Jeta Grove, that Rahula was ripe for the attainment of arahatship. He wanted to give Rahula the last teachings and he said to him that they would go to Dark Wood. We read:\n\n Now at that time countless thousands of devas were following the Exalted One, thinking: Today the Exalted One will give the venerable Rahula the last teachings for the destruction of the asavas.\n So the Exalted One plunged into the depths of Dark Wood and sat down at the foot of a certain tree on the seat prepared for him. And the venerable Rahula, saluting the Exalted One, sat down also at one side. As he thus sat the Exalted One said to the venerable Rahula:\n Now what do you think, Rahula? Is the eye permanent or impermanent?\n Impermanent, lord.\n\n What is impermanent is that happiness or dukkha?\n Dukkha, lord.\n Now what is impermanent, woeful, by nature changeableis it fitting to regard that as This is mine. This am I. This is myself?\n Surely not, lord.\n\n(The same is said about the other phenomena appearing through the sense-doors and through the mind-door.)\n\n Thus spoke the Exalted One. And the venerable Rahula was delighted with the words of the Exalted One and welcomed them. And when this instruction was given, the venerable Rahulas heart was freed from the asavas without grasping. And in those countless devas arose the pure and spotless eye of the Dhamma, so that they knew: Whatsoever is of a nature to arise, all that is of a nature to cease. \n\nWhen we read this sutta we may find it to be a repetition of so many suttas. We may read it countless times, but we may only have theoretical understanding of the truth. One day the truth may be realized but this depends on the degree of the development of panna. Is the eye permanent or impermanent? Is what is impermanent happiness or dukkha? Should we take it for self? Are the other realities permanent or impermanent? The Buddha spoke about all the realities which appear now. If we do not yet have a keen understanding of seeing and visible object which appear now, at this moment, if we cannot yet distinguish between the different characteristics of nama and of rupa which appear now, their arising and falling away cannot be realized. When the Buddha asked Rahula about the true nature of realities, would Rahula only have been thinking about nama and rupa, or did he at that moment realize their true nature? We know the answer. Rahula was mindful of realities appearing through the six doors, and thus his wisdom could be fully developed. Otherwise he could not have attained arahatship.</div>
<div tiddler="How can the Buddha's teachings be proved?" modifier="AlanWeller" modified="200704140702" created="200704140702" tags="">Extract from [[Abhidhamma in Daily Life]], chapter 17\n\nIn being aware of nama and rupa which appear, such as seeing, visible object, feeling or thinking, we can prove to ourselves the truth of the Buddhas teachings; we can prove that the objects experienced through the six doors are impermanent and non-self. The truth will not be known if one follows other people blindly or if one speculates about the truth. We read in the Kindred Sayings (IV, Salayatana-vagga, Third Fifty, chapter V, 152, Is there a method?) that the Buddha said:\n\n Is there, monks, any method, by following which a monk, apart from belief, apart from inclination, apart from hearsay, apart from argument as to method, apart from reflection on reasons, apart from delight in speculation, could affirm insight thus: Ended is birth, lived is the righteous life, done is the task, for life in these conditions there is no hereafter?\n For us, lord, things have their root in the Exalted One Well indeed were it if the meaning of this that has been spoken were to manifest itself in the Exalted One. Hearing it from him the monks will remember it.\n There is indeed a method, monks, by following which a monk could affirm insight And what is that method?\n Herein, monks, a monk, seeing an object with the eye, either recognizes within him the existence of lust, aversion and ignorance, thus: I have lust, aversion and ignorance, or recognizes the non-existence of these qualities within him, thus: I have not lust, aversion and ignorance. Now as to that recognition of their existence or non-existence within him, are these conditions, I ask, to be understood by belief, or by inclination, or hearsay, or argument as to method, or reflection on reasons, or delight in speculation? Surely not, lord.\n Are these states to be understood by seeing them with the eye of wisdom?\n Surely, lord.\n Then, monks, this is the method by following which, apart from belief a monk could affirm insight thus: Ended is birth for life in these conditions there is no hereafter.\n\nThe same is said with regard to the doors of the ear, the nose, the tongue, the body and the mind.\n\nWhen we study the Abhidhamma we should keep in mind the purpose of the Buddhas teachings: the eradication of defilements through the wisdom which realizes the phenomena appearing through the six doors as they are. Through this method there will be an end to the cycle of birth and death. We should remember that the Abhidhamma is not a theoretical textbook but an exposition of realities appearing in daily life. We learn about nama and rupa; we learn about cittas which each have their own function in the sense-door process and in the mind-door process. There are sense-door processes and mind-door processes time and again, and objects are experienced by cittas arising in these processes. If there is awareness of characteristics of nama and rupa when they appear, the panna is developed which can eradicate defilements. This kind of wisdom is deeper than any kind of theoretical knowledge. </div>
<div tiddler="I've heard it said that Abhidhamma is not necessary. After all the Buddha taught only suffering and the end of suffering?" modifier="AlanWeller" modified="200704140741" created="200704140740" tags="">(Source Robert Kirkpatrick)\n\nYes, but how to get to the end of suffering. The Abhidhamma is the map for this. Here's an analogy.\n\nSay we are sick and only one medicine can cure us. We hear that the medicine comes from the forest, so we go to the forest and search and search. We find many exotic and rare herbs etc. We try different mixtures and submit to different healing regimes. However although much of this seems to help eventually we realise it is only suppressing the symptoms. None of it is actually curing the disease. Then a great doctor explains that the cure is right in front of us. The leaves of the most common trees when chewed regularly gradually eradicates the disease until it finally disappears.\n\nIn the same way the Abhidhamma helps us to see that all the common realities of our daily life-seeing, hearing, attachment etc.-when experienced with understanding are the very things which will liberate us. If we don't have the Abhidhamma its very easy to go away from the path. </div>
<div tiddler="In what way does Buddhism differ from other mainstream religions?" modifier="YourName" modified="200704140656" created="200704140656" tags="">Extract from The Buddha's Path chapter 3\n\nThe truth of non-self, in Pali anatta, is an essential element of the Buddhas teachings. This truth has been taught by the Buddha alone, it cannot be found outside the Buddhist teachings. Those who come into contact with Buddhism for the first time may be bewildered, even repelled by the truth of non-self. They wonder what the world would be without a self, without other people. Do we not live with and for other people? It is difficult to grasp the truth of non-self and its implications in daily life. What is called in conventional language a person or self is merely a temporary combination of physical phenomena and mental phenomena, which are depending on each other. They have been classified as five groups, in Pali khandhas: one group of all physical phenomena and four groups of mental phenomenafeelings, perceptions, mental activities and consciousness. The five khandhas are in a flux, in a constant process of formation and dissolution. There is nothing lasting, nothing eternal, nothing unchanging in life.\n\nThe khandhas which arise, fall away and do not return. Present khandhas are different from past khandhas but they are conditioned by past khandhas, and present khandhas condition in their turn future khandhas. We read in the Dialogues of the Buddha (I, number IX, Potthapada Sutta) that the Buddha explained to Citta about the three modes of personality: the past, the present and the future personality. They are different, but the past conditions the present and the present conditions the future. We read that the Buddha explained this by way of a simile:\n\n Just, Citta, as from a cow comes milk, and from the milk curds, and from the curds butter, and from the butter ghee, and from the ghee junket; but when it is milk it is not called curds, or butter, or ghee, or junket; and when it is curds it is not called by any of the other names.\n Just so, Citta, when any one of the three modes of personality is going on, it is not called by the name of the other. For these, Citta, are merely names, expressions, turns of speech, designations in common use in the world. And of these a Tathagata (one who has won the truth) makes use indeed, but is not led astray by them. \n\nWe call by such or such a name what are actually the five khandhas. People have different characters, different personalities. In reality there is nothing static in what is called a person. The present personality is different from the past personality, but it has originated from the past personality. We read in the commentary to the Debates (to the Kathavatthu, Chapter I, the Person, 33, 34):\n\n Given bodily and mental khandhas, it is customary to say such and such a name, a family. Thus, by this popular turn of speech, convention, expression, is meant: there is the personThe Buddhas have two kinds of discourse, the popular and the philosophical. Those relating to a being, a person, a deva (divine being), a brahma,are popular discourses, while those relating to impermanence, dukkha, non-self, the khandhas, the elements, the senses are discourses on ultimate meaning. A discourse on ultimate meaning is, as a rule, too severe to begin with; therefore the Buddhas teach at first by popular discourse, and then by way of discourse on ultimate meaning.\n The Enlightened One, best of speakers, spoke two kinds of truth, namely, the conventional truth and the ultimate truth, a third is not known.\n Therein, a popular discourse is true in conventional sense. A discourse on ultimate realities is also true, and as such, characteristic of things as they are.\n\nBefore studying the Buddhist teachings we only knew conventional truth: the truth of the world populated by people and animals, the world of persons, of self. Through the Buddhist teachings we learn about the ultimate truth: the mental phenomena and physical phenomena which are impermanent.\n\nThe truth of non-self is ultimate truth. It is deep and hard to penetrate. It has been taught by way of similes in the Buddhist scriptures and in the commentaries. The great commentator Buddhaghosa, in his book the Path of Purification (Visuddhimagga), illustrates the truth of non-self with similes from Buddhist scriptures. The Path of Purification is a comprehensive exposition of the Buddhas teaching based on old commentaries and the tradition of the monks in Sri Lanka, written in the fifth century A.D. Buddhaghosa explains that when one thinks of a whole of mind and body, one clings to the concept of person, whereas when this whole is seen as different elements which are impermanent, one will lose the perception of self: We read in the Path of Purification (XVIII, 25, 26):\n\n As with the assembly of parts\n The word chariot is countenanced,\n So, when the khandhas are present,\n A being is said in common usage.\n\n Again, this has been said: Just as when a space is enclosed with timber and creepers and grass and clay, there comes to be the term house, so too, when a space is enclosed with bones and sinews and flesh and skin, there comes to be the term material form.\n\nFurther on (XVIII, 28) we read:\n\n So in many hundred suttas it is only mentality-materiality that is illustrated, not a being, not a person. Therefore, just as when the component parts such as axles, wheels, frame, poles, etc. are arranged in a certain way, there comes to be the mere term of common usage chariot, yet in the ultimate sense when each part is examined, there is no chariotand just as when the component parts of a house such as wattles, etc. are placed so that they enclose a space in a certain way, there comes to be the mere term of common usage house, yet in the ultimate sense there is no house,so too, when there are the five khandhas of clinging, there comes to be the mere term of common usage a being, a person, yet in the ultimate sense, when each component is examined, there is no being as a basis for the assumption I am or I; in the ultimate sense there is only mentality-materiality. The vision of one who sees in this way is called right vision.\n\nIf life can be considered as existing in just one moment, it will be less difficult to understand the truth of non-self. In the Maha-Niddesa (number 6, Decay) the Buddha explains that life is extremely short. In the ultimate sense it lasts only as long as one moment of consciousness. Each moment of consciousness which arises falls away completely, to be succeeded by the next moment which is different.\n\nWe read in the Path of Purification (XX, 72) a quotation from the Maha-Niddesa text about the khandhas which are impermanent:\n\n No store of broken states, no future stock; Those born balance like seeds on needle points. Break-up of states is fore-doomed at their birth; Those present decay, unmingled with those past. They come from nowhere, break up, nowhere go; Flash in and out, as lightning in the sky.\n\nOne is used to thinking of a self who coordinates all the different experiences through the senses and the mind, a self who can see, hear and think all at the same time, but in reality there can be only one moment of consciousness at a time which experiences one object. At one moment life is seeing, at another moment life is hearing and at another moment again life is thinking. Each moment of our life arises because of its own conditions, exists for an extremely short time and then falls away. Seeing arises dependant on eye-sense, on colour and on other factors. It exists just for a moment and then it is gone. Seeing arises and falls away very rapidly, but then there are other moments of seeing again and this causes us to erroneously believe that seeing lasts. The seeing of this moment, however, is different from seeing which is just past. Colour which appears at this moment is different from colour which is just past. How could there be a self who exerts control over seeing or any other reality? Realities such as kindness and anger arise because of their own conditions, there is no self who could exert control over them. We would like to speak kindly, but when there are conditions for anger, it arises. We may tell ourselves to keep silent, but, before we realize it, angry words have been spoken already. There was anger in the past and this has been accumulated. That is why it can arise at any time. Anger does not belong to a person, but it is a reality. We are used to identifying ourselves with realities such as anger, generosity, seeing or thinking, but it can be learnt that they are mental phenomena, arising because of their own conditions. We are used to identifying ourselves with our body, but the body consists of changing physical phenomena, arising because of their own conditions. Bodily phenomena are beyond control; ageing, sickness and death cannot be prevented. Realities come and go very rapidly, they can be compared with a flash of lightning. One cannot exercise any power over a flash of lightning, it is gone as soon as it has been noticed. Evenso, one cannot exert control over the mental and physical phenomena of ones life.</div>
<div tiddler="Links" modifier="YourName" modified="200903202049" created="200704151605" tags="">http://delicious.com/alanweller/Buddhism\n\n!!DhannastudyGroup\nA discussion forum for anyone interested in understanding the Buddha's teachings as found in all three baskets of the Tipitaka, the original record of the Buddha's word in the Theravada tradition, and as further elucidated in the ancient commentaries of that tradition.\n\nThe discussions include matters of both theory and practice, with the aim of developing precise understanding of dhammas (the realities of the present moment).\n\nThe group started in Bangkok in the early 1970's under the guidance of the Thai Theravadin teacher Khun Sujin Boriharnwanaket. \nhttp://groups.yahoo.com/group/dhammastudygroup/</div>
<div tiddler="MainMenu" modifier="YourName" modified="201007181251" created="200704092327" tags="">[[FAQ]]\n[[School Projects]]\n</div>
<div tiddler="Many religions teach about heaven and hell. In what respect are the Buddhist teachings different?" modifier="AlanWeller" modified="200704140701" created="200704140701" tags="">Extract: [[Abhidhamma in Daily Life]] chapter 20\n\nMany religions teach about heaven and hell. In what respect are the Buddhist teachings different? Do we just have to believe in heaven and hell? Through the Buddhist teachings we learn to study realities, to study cause and effect in life. Each cause brings about its appropriate result. People perform good and bad deeds and these deeds bring different results; they can cause births in different planes of existence. A plane of existence is the place where one is born. Birth in a woeful plane is the result of a bad deed and birth in a happy plane is the result of a good deed. Since the deeds of beings are of many different degrees of kusala and akusala, the results are of many different degrees as well. There are different woeful planes and different happy planes of existence.\n\nThe animal world is a woeful plane. We can see how animals devour one another and we find that nature is cruel. The animal world is not the only woeful plane. There are different hell planes. The akusala vipaka in hell is more intense than the sufferings which can be experienced in the human plane. The descriptions of hells in the Buddhist teachings are not merely allegories; the experience of unpleasant things through eyes, ears, nose, tongue and bodysense is akusala vipaka and akusala vipaka is reality. Life in a hell plane is not permanent; when ones lifespan in a hell plane is over there can be rebirth in another plane.\n\nApart from the animal plane and the hell planes, there are other woeful planes. Birth in the plane of petas (ghosts) is the result of akusala kamma, conditioned by lobha. Beings in that plane have a deformed figure and they are always hungry and thirsty. Furthermore, there is the plane of asuras (demons). The objects which are experienced in the asura plane are not as enjoyable as the objects which can be experienced in the human plane. There are four classes of woeful planes in all.\n\nBirth as a human being is a happy rebirth. In the human plane there is opportunity for the development of kusala. One can study Dhamma and learn to develop the way leading to the end of defilements, to the end of birth and death. Birth in the human plane is kusala vipaka, but during ones lifespan in this plane there are both kusala vipaka and akusala vipaka. Each person experiences different results in life: there is gain and loss, honour and dishonour, praise and blame, happiness and misery. Each person is born into the family which is the right condition for him to experience the results of his deeds. It is due to ones kamma that one experiences pleasant and unpleasant things through eyes, ears, nose, tongue and bodysense.\n\nOther happy planes, apart from the human plane, are the heavenly planes. In the heavenly planes there is more kusala vipaka than in the human plane and less akusala vipaka. There are several heavenly planes and although life in a heavenly plane lasts a very long time, it is not permanent. The woeful planes, the human plane and the six heavenly planes which are deva planes, are sensuous planes of existence. Sensuous planes of existence are planes where there is seeing, hearing, smelling, tasting, the experience of tangible object through the bodysense and other kamavacara cittas (cittas which are of the sensuous plane of consciousness). There are eleven classes of sensuous planes of existence in all.\n\nThose who see the disadvantages of sense-impressions may cultivate jhana; they can be reborn in higher heavenly planes which are not sensuous planes. Those who attain rupa-jhana can be reborn in rupa-brahma-planes where there are less sense-impressions. There are sixteen rupa-brahma planes in all. One of them is the asanna-satta plane where there is only rupa, not nama. Those who have attained the highest stage of rupa-jhana and who wish to have no consciousness at all, can be reborn without citta; for them there is only a body. These beings have seen the disadvantages of consciousness; even happiness is a disadvantage, since it does not last.\n\nThose who see the disadvantages of rupa cultivate arupa-jhana. If they attain arupa-jhana they can be reborn in arupa-brahma planes where there is no rupa. There are four classes of arupa-brahma planes. Beings born in these planes have only nama, not rupa. One may wonder how there can be beings which only have rupa or beings which only have nama. When right understanding of nama and rupa has been developed realities will be seen as only elements which arise because of conditions, not a being, not a person, no self. Then there will be no doubt that, under the appropriate conditions, there can be rupa without nama and nama without rupa. </div>
<div tiddler="Metta: Loving kindness in Buddhism" modifier="AlanWeller" modified="200704150604" created="200704102308" tags="beginner sujin">By Sujin Boriharnwanaket\n\nTranslated from the original Thai by Nina van Gorkom ISBN 1 897633 14 9, 128 pages, paperback, 210mm x 135mm, price  7.95, $ 11.95. Published14th February 1995.\n\n!Key Points:\n\n*Shows metta as the foundation of the world essential for the peace and happiness of ourselves and others.\n*Gives guidance on the development of metta in daily life, pointing out hindrances to it and conditions for it.\n*Expounds the place of metta in the Buddhist doctrine of cause and result.\n*Shows the importance of insight meditation practice for the development of metta.\n*Illustrates with many quotes from the original scriptures (Pali Tipiaka).\n\n!Description:\n\nAn introduction to the basic Buddhist teachings of metta, loving kindness, and its practical application in todays world. The book is a compilation of lectures given by the author, Ms. Sujin Boriharnwanaket, in the Boranives Temple, Bangkok, for mixed groups of scholars, monks and lay people. Part of the book features questions and answers raised during the lectures. Although some background of Buddhism is assumed much of the text would be appreciated by the complete beginner.\n!Contents:\n\nConditions and impediments-Overcoming anger-Practice in daily life-Characteristics of metta-Metta in action and speech-Benefits of metta-Blessings of metta-Cause and result in life-Metta: the foundation of the world, Glossary, Selected texts.</div>
<div tiddler="News" modifier="YourName" modified="200903202052" created="200903202052" tags="">Updates to this site</div>
<div tiddler="News Blog" modifier="AlanWeller" modified="200704102254" created="200704102254" tags="">Type the text for 'New Tiddler'</div>
<div tiddler="OpenOffice" modifier="AlanWeller" modified="200704120818" created="200704120818" tags="">'OpenOffice'free office suite http://www.openoffice.org\n\nOpenOffice.org is a multiplatform and multilingual office suite and an open-source project. Compatible with all other major office suites, the product is free to download, use, and distribute. To help build the community, join us.</div>
<div tiddler="PageTemplate" modifier="AlanWeller" modified="200901272303" created="200901272303" tags="ClassicTheme">&lt;div class='header'&gt;\n&lt;div class='titleLine'&gt;\n&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;\n&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div id='mainMenu' refresh='content' tiddler='MainMenu'&gt;&lt;/div&gt;\n&lt;div id='sidebar'&gt;\n&lt;div macro='gradient vert #ffffff #cc9900'&gt;&lt;a&gt; &lt;/a&gt;&lt;div id='sidebarOptions' refresh='content' tiddler='SideBarOptions'&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;div id='sidebarTabs' refresh='content' force='true' tiddler='SideBarTabs'&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;div id='displayArea'&gt;\n&lt;div id='messageArea'&gt;&lt;/div&gt;\n&lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;\n&lt;/div&gt;</div>
<div tiddler="Pali Glossary" modifier="YourName" modified="200902191105" created="200704102254" tags="">A [[Pali Glossary |pglos.html]]to help with this web site is available here. NB Pali accents are not rendered correctly in this document.\n\nThis version has correct accents, [[Pali Glossary with Accents|http://www.zolag.co.uk/paliglossary.pdf]].</div>
<div tiddler="PaliAccents" modifier="YourName" modified="200902191047" created="200902191047" tags="">Two page article on getting Pali accents in text.\n*[[paliaccents.pdf|http://www.zolag.co.uk/paliaccents.pdf]]</div>
<div tiddler="PaliConvert" modifier="YourName" modified="200901271247" created="200901271246" tags="pali">% script to convert accents from openoffice exported latex to Latex\ns/\s\saa/\s\s=a/g\ns/\s\s`u/\s\sd n/g\ns/\s\s`o/\s\s.n/g\ns/\s\s'i/\s\s=\s\si /g\ns/\s\s=\s\si  /\s\s=\s\si{}/g\ns/\s\s`i/\s\sd t/g\ns/\s\s'u/\s\s=u/g\ns/\s\s^i/\s\sd l/g\ns/\s\s&quot;y/\s\sd m/g\n</div>
<div tiddler="PaliFonts" modifier="YourName" modified="200902191046" created="200707081042" tags="">In order to view most of the books and articles downloaded from this site with the correct Pali accents you will need these fonts. Otherwise they will show up as french and other types of accents.\n\nSee this article on PaliAccents.\n\nThe following font Pcharter is available in four styles: plain, italic, bold, bold italic.\n!!Fonts for MAC\n*[[pCharter for MAC|http://www.zolag.co.uk/pChart1.bin]]\n!!Fonts fof PC\n*[[pChar1.ttf|http://www.zolag.co.uk/pChar1.ttf]]\n*[[pChar2.ttf|http://www.zolag.co.uk/pChar2.ttf]]\n*[[pChar3.ttf|http://www.zolag.co.uk/pChar3.ttf]]\n*[[pChar4.ttf|http://www.zolag.co.uk/pChar4.ttf]]\n\n*[[pHuma5.ttf|http://www.zolag.co.uk/pHuma5.ttf]]</div>
<div tiddler="Rupas" modifier="YourName" modified="200902191122" created="200902191122" tags="corrections"> I would like a correction at the end of Ch 7\n If that is too late it will be for a reprint in the future.\nLast para: erase about conventional terms. Instead:\nThe Sutta speaks about space of the auditory orifices and the other holes and openings of the body. Space in the ear is one of the conditions for hearing 5. We attach great importance to internal space and we take it for mine or self, but it is only a rpa element. \n\nChange footnote 5:  \n5 Atthaslin II, Book II, Part I, Ch III, 314.\nSpace in the ear or the nose is space that is not conditioned by one of the four factors of kamma, citta, temperature or nutrition; it is unconditioned rpa.  \n\n</div>
<div tiddler="School Projects" modifier="AlanWeller" modified="200704150623" created="200704141020" tags="beginner">Answers to Questions from School pupils by AlanWeller\n\n#[[Could you give me the date of origin of the Buddhist faith?]]\n#[[Could you give me the name of the founder or key figure?]]\n#[[Could you give me the approximate number of followers in the world and the countries they live in?]]\n#[[Could you give me the names and times of the main festivals and what they commemorate?]]\n#[[Could you give me the name of the teachings or scriptures?]]\n#[[Could you give the name of places of worship and the way in which you worship?]]\n#[[Could you briefly describe the attitude to the scriptures and outline the key beliefs of the religion?]]\n#[[What are the beliefs about God, life after death and what makes a committed believer?]]\n#[[Can the religion be separated into different groups e.g. denominations and if so what are the main groups and what are the main differences between them?]]\n#[[What interested you about the Buddhist religion and what made you decide to join? How has it changed your life and is there anything you have had to give up to follow the religion? What made the religion right for you and anything else you think may help?]]\n#[[Does the Buddha's life and teachings have any relevance to modern living?]]</div>
<div tiddler="ScribdAw" modifier="YourName" modified="200907181126" created="200904060821" tags="">Free articles and books available at Scribd.com or from [[Downloads]].\n\n\n!For beginners:\nhttp://www.scribd.com/doc/3918540/Understanding-Reality\n [[info|The Buddha's Path]] http://www.scribd.com/doc/3918513/The-Buddhas-Path\n[[info|Buddhism in Daily Life]] http://www.scribd.com/doc/3918039/Buddhism-in-Daily-Life\n[[info1|Abhidhamma in Daily Life]] [[info2|ADL Press Release]] http://www.scribd.com/doc/3918055/Abhidhamma-in-Daily-Life\n\n!General\nhttp://www.scribd.com/doc/3918626/Loving-Kindness-in-Buddhism\n[[info|A Survey of Paramattha Dhammas]] http://www.scribd.com/doc/3945086/A-Survey-of-Paramattha-Dhammas\nhttp://www.scribd.com/doc/3924455/Taking-Refuge-in-Buddhism\nhttp://www.scribd.com/doc/12918668/Pilgimmige-in-India-2004\nhttp://www.scribd.com/doc/8703301/Pilgrimmage-in-SriLanka\nhttp://www.scribd.com/doc/8703292/Sri-Lanka-Revisited\nhttp://www.scribd.com/doc/7549418/Following-in-Asokas-Footsteps\nhttp://www.scribd.com/doc/7549393/Letters-on-Vipassana\nhttp://www.scribd.com/doc/7548812/Realities-and-Concepts\nhttp://www.scribd.com/doc/4083972/Preserving-the-Buddhist-Teachings\nhttp://www.scribd.com/doc/4083833/Introduction-to-the-Buddhist-Scriptures\nhttp://www.scribd.com/doc/3936769/Getting-Pali-Accents-in-Text\nhttp://www.scribd.com/doc/3936699/Pali-Glossary-pdf\nhttp://www.scribd.com/doc/3924571/Listening-to-Dhamma\nhttp://www.scribd.com/doc/3924553/Alone-with-Dhamma\nhttp://www.scribd.com/doc/3924526/Meaning-of-Dhamma\nhttp://www.scribd.com/doc/3924465/Deeds-of-Merit\nhttp://www.scribd.com/doc/3918653/Conditions\nhttp://www.scribd.com/doc/3918097/The-Perfections-leading-to-Enlightenment\nhttp://www.scribd.com/doc/3918083/Attachment-to-People\n[[info|Cetasikas]] http://www.scribd.com/doc/3918075/Cetasikas\nhttp://www.scribd.com/doc/3917805/The-Buddhist-Teaching-on-Physical-Phenomena\nhttp://www.scribd.com/doc/14009037/World-in-the-Buddhist-Sense\nhttp://www.scribd.com/doc/14009030/Phrases-on-Buddhism\nhttp://www.scribd.com/doc/14009029/Perseverance-in-Dhamma\nhttp://www.scribd.com/doc/14009026/My-Time-with-Ajarn-Sujin\nhttp://www.scribd.com/doc/14009022/Dhamma-in-Thailand\nhttp://www.scribd.com/doc/14009019/Brahmaviharas\nhttp://www.scribd.com/doc/14009453/Letters-From-Nina\nhttp://www.scribd.com/doc/14009451/Foundation-Issues\nhttp://www.scribd.com/doc/14009740/World-in-the-Buddhist-Sense</div>
<div tiddler="Should Buddhists be vegetarians?" modifier="YourName" modified="200704140652" created="200704140652" tags="">From The Buddha's Path, chapter 6\n\nDoes this mean that Buddhists should be vegetarians? The Buddha did not teach people to abstain from eating meat. The monks had to accept any kind of food which was offered to them by the layfollowers. The Buddha explained to the monks that they could eat meat unless they had seen, heard or suspected that an animal was killed especially for them. We read in the Book of Discipline (Vinaya IV, Maha-vagga VI, on Medicines, 237) that the general Siha attained enlightenment after having listened to the Buddha. He offered a meal which included meat to the Buddha and the order of monks. The Niganthas, who were of another teaching, found fault with the offering of meat. We read that after the meal the Buddha explained to the monks:\n\n Monks, one should not knowingly make use of meat killed on purpose (for one). Whoever should make use of it, there is an offence of wrong-doing. I allow you, monks, fish and meat that are quite pure in three respects: if they are not seen, heard, suspected (to have been killed on purpose for a monk).\n\nThis answer may not be satisfactory to everyone. One may wonder whether one indirectly promotes the slaughtering of animals by buying meat. It would be good if there were no slaughtering at all, no violence. The world, however, is not an Utopia. Animals are slaughtered and their meat is sold. If one in the given situation buys meat and eats it, one does not commit an act of violence. While one kills there is akusala citta rooted in aversion; killing is an act of violence. While one eats meat there may be attachment or dislike of it, but there is no act of violence towards a living being.</div>
<div tiddler="SiteSubtitle" modifier="YourName" modified="201007181249" created="200704091831" tags="">-FAQ</div>
<div tiddler="SiteTitle" modifier="YourName" modified="200704091830" created="200704091829" tags="">Zolag</div>
<div tiddler="StyleSheet" modifier="AlanWeller" modified="200901272308" created="200901272301" tags="ClassicTheme">/***\n!TiddlyWiki Classic Color Scheme\nDesigned by Jeremy Ruston\nhttp://tiddlystyles.com/#theme:Classic\n\nTo use this color scheme copy the [[ClassicTiddlyWiki]] contents into a tiddler and name it 'StyleSheet' also grab the [[ClassicTemplate]] and copy its contents into a tiddler named 'PageTemplate'.\n\n!Colors Used\n*@@bgcolor(#630):color(#fff): #630@@\n*@@bgcolor(#930): #930@@\n*@@bgcolor(#996633): #963@@\n*@@bgcolor(#c90): #c90@@\n*@@bgcolor(#cf6): #cf6@@\n*@@bgcolor(#cc9): #cc9@@\n*@@bgcolor(#ba9): #ba9@@\n*@@bgcolor(#996): #996@@\n*@@bgcolor(#300):color(#fff): #300@@\n*@@bgcolor(#000000):color(#fff): #000@@\n*@@bgcolor(#666): #666@@\n*@@bgcolor(#888): #888@@\n*@@bgcolor(#aaa): #aaa@@\n*@@bgcolor(#ddd): #ddd@@\n*@@bgcolor(#eee): #eee@@\n*@@bgcolor(#ffffff): #fff@@\n*@@bgcolor(#f00): #f00@@\n*@@bgcolor(#ff3): #ff3@@\n!Generic Rules /%==============================================%/\n***/\n/*{{{*/\nbody {\n background: #fff;\n color: #000;\n}\n\na{\n color: #963;\n}\n\na:hover{\n background: #963;\n color: #fff;\n}\n\na img{\n border: 0;\n}\n\nh1,h2,h3,h4,h5 {\n background: #cc9;\n}\n/*}}}*/\n/***\n!Header /%==================================================%/\n***/\n/*{{{*/\n.header{\n background: #300;\n}\n\n.titleLine {\n color: #fff;\n padding: 5em 0em 1em .5em;\n}\n\n.titleLine a {\n color: #cf6;\n}\n\n.titleLine a:hover {\n background: transparent;\n}\n/*}}}*/\n/***\n!Main Menu /%=================================================%/\n***/\n/*{{{*/\n#mainMenu .button {\n color: #930;\n}\n\n#mainMenu .button:hover {\n color: #cf6;\n background: #930;\n}\n\n#mainMenu li{\n list-style: none;\n}\n/*}}}*/\n/***\n!Sidebar options /%=================================================%/\n~TiddlyLinks and buttons are treated identically in the sidebar and slider panel\n***/\n/*{{{*/\n#sidebar {\n background: #c90;\n right: 0;\n}\n\n#sidebarOptions a{\n color: #930;\n border: 0;\n margin: 0;\n padding: .25em .5em;\n}\n\n#sidebarOptions a:hover {\n color: #cf6;\n background: #930;\n}\n\n#sidebarOptions a:active {\n color: #930;\n background: #cf6;\n}\n\n#sidebarOptions .sliderPanel {\n background: #eea;\n margin: 0;\n}\n\n#sidebarOptions .sliderPanel a {\n color: #930;\n}\n\n#sidebarOptions .sliderPanel a:hover {\n color: #cf6;\n background: #930;\n}\n\n#sidebarOptions .sliderPanel a:active {\n color: #930;\n background: #cf6;\n}\n/*}}}*/\n/***\n!Sidebar tabs /%=================================================%/\n***/\n/*{{{*/\n.tabSelected,.tabContents {\n background: #eea;\n border: 0;\n}\n\n.tabUnselected {\n background: #c90;\n}\n\n#sidebarTabs {\n background: #c90;\n}\n\n#sidebarTabs .tabSelected{\n color: #cf6;\n background: #963;\n}\n\n#sidebarTabs .tabUnselected {\n color: #cf6;\n background: #930;\n}\n\n#sidebarTabs .tabContents{\n background: #963;\n}\n\n#sidebarTabs .txtMoreTab .tabSelected,\n#sidebarTabs .txtMoreTab .tabSelected:hover{\n background: #930;\n color: #cf6;\n}\n\n#sidebarTabs .txtMoreTab .tabUnselected,\n#sidebarTabs .txtMoreTab .tabUnselected:hover{\n background: #300;\n color: #cf6;\n}\n\n#sidebarTabs .txtMoreTab .tabContents {\n background: #930;\n}\n\n#sidebarTabs .tabContents a {\n color: #cf6;\n border: 0;\n}\n\n#sidebarTabs .button.highlight,\n#sidebarTabs .tabContents a:hover {\n background: #cf6;\n color: #300;\n}\n/*}}}*/\n/***\n!Message Area /%=================================================%/\n***/\n/*{{{*/\n#messageArea {\n background: #930;\n color: #fff;\n}\n\n#messageArea a:link, #messageArea a:visited {\n color: #c90;\n}\n\n#messageArea a:hover {\n color: #963;\n background: transparent;\n}\n\n#messageArea a:active {\n color: #fff;\n}\n/*}}}*/\n/***\n!Popup /%=================================================%/\n***/\n/*{{{*/\n.popup {\n background: #eea;\n border: 1px solid #930;\n}\n\n.popup hr {\n color: #963;\n background: #963;\n border-bottom: 1px;\n}\n\n.popup li.disabled {\n color: #ba9;\n}\n\n.popup li a, .popup li a:visited {\n color: #300;\n}\n\n.popup li a:hover {\n background: #930;\n color: #eea;\n}\n/*}}}*/\n/***\n!Tiddler Display /%=================================================%/\n***/\n/*{{{*/\n.tiddler .button {\n color: #930;\n}\n\n.tiddler .button:hover {\n color: #cf6;\n background: #930;\n}\n\n.tiddler .button:active {\n color: #fff;\n background: #c90;\n}\n\n.shadow .title {\n color: #888;\n}\n\n.title {\n color: #422;\n}\n\n.subtitle {\n color: #866;\n}\n\n.toolbar {\n color: #aaa;\n}\n\n.toolbar a,\n.toolbar a:hover{\n border: 0;\n}\n\n.tagging, .tagged {\n border: 1px solid #fff;\n background-color: #ffc;\n}\n\n.selected .tagging, .selected .tagged {\n border: 1px solid #aa6;\n background-color: #ffc;\n}\n\n.tagging .listTitle, .tagged .listTitle {\ncolor: #999999;\n}\n\n.footer {\n color: #ddd;\n}\n\n.selected .footer {\n color: #888;\n}\n\n.sparkline {\n background: #eea;\n border: 0;\n}\n\n.sparktick {\n background: #930;\n}\n\n.errorButton {\n color: #ff0;\n background: #f00;\n}\n\n.zoomer {\n color: #963;\n border: 1px solid #963;\n}\n/*}}}*/\n/***\n''The viewer is where the tiddler content is displayed'' /%------------------------------------------------%/\n***/\n/*{{{*/\n.viewer .button {\n background: #c90;\n color: #300;\n border-right: 1px solid #300;\n border-bottom: 1px solid #300;\n}\n\n.viewer .button:hover {\n background: #eea;\n color: #c90;\n}\n\n.viewer .imageLink{\n background: transparent;\n}\n\n.viewer blockquote {\n border-left: 3px solid #666;\n}\n\n.viewer table {\n border: 2px solid #303030;\n}\n\n.viewer th, thead td {\n background: #996;\n border: 1px solid #606060;\n color: #fff;\n}\n\n.viewer td, .viewer tr {\n border: 1px solid #606060;\n}\n\n.viewer pre {\n border: 1px solid #963;\n background: #eea;\n}\n\n.viewer code {\n color: #630;\n}\n\n.viewer hr {\n border: 0;\n border-top: dashed 1px #606060;\n color: #666;\n}\n\n.highlight, .marked {\n background: #ff3;\n}\n/*}}}*/\n/***\n''The editor replaces the viewer in the tiddler'' /%------------------------------------------------%/\n***/\n/*{{{*/\n.editor input {\n border: 1px solid #000;\n}\n\n.editor textarea {\n border: 1px solid #000;\n width: 100%;\n}\n\n.editorFooter {\n color: #aaa;\n}\n\n.editorFooter a {\n color: #930;\n}\n\n.editorFooter a:hover {\n color: #cf6;\n background: #930;\n}\n\n.editorFooter a:active {\n color: #fff;\n background: #c90;\n}\n/*}}}*/</div>
<div tiddler="Taking Refuge in Buddhism" modifier="AlanWeller" modified="200704150606" created="200704102334" tags="sujin beginner">Taking Refuge in Buddhism\nby Sujin Boriharnwanaket\n\nTaking Refuge in Buddhism is an introduction to the development of insight meditation. The book is composed of lectures and discussions with Cambodians. Although some background knowledge of Buddhism is assumed, it could also be appreciated by the beginner.\n\n *Gives guidance on the development of understanding of the mental and physical phenomena as they appear in everyday life.\n*Explains the difference between theoretical and direct understanding of the truth.\n*Shows that the Buddha's teachings on non-self have to be applied in order to develop understanding.\n*Shows that listening and considering the Buddha's teachings is the key to the practice.\n*Explains direct awareness (sati) using examples. </div>
<div tiddler="The Buddha's Path" modifier="AlanWeller" modified="200810280918" created="200704102301" tags="beginner gorkom">By Nina van Gorkom, published on April 15th 1994, ISBN 1 897633 12 2, 160 pages, paperback, 210mm x 148mm, price 7.95, $ 11.95.\n\n!Key Points:\n\n * Demonstrates the way in which the Buddhist teachings can be applied to daily life.\n * Addresses the question of why we suffer and the solution to suffering.\n * Helps to understand the meaning of meditation.\n * Illustrates with many quotes from the original scriptures (The Pali Tipitaka).\n\n!Description:\nAn Introduction to the doctrine of Theravada Buddhism for those who have no previous knowledge. The four noble Truths - suffering - the origin of suffering - the cessation of suffering - and the way leading to the end of suffering - are explained as a philosophy and a practical guide which can be followed in todays world.\n!Contents:\nIntroduction, The truth of suffering, The truth of non-self, The mind,Deeds and their results, Good deeds and a wholesome life, Meditation and The eightfold Path Glossary, Index.</div>
<div tiddler="The Buddhist Teaching on Physical Phenomena" modifier="YourName" modified="200904071147" created="200810280916" tags="">!Keypoints:\n\n*Helps the reader to see that the study of physical phenomena pertains\ndirectly to his daily life.\n*Analyses the physical phenomena which condition our actions, bodily\npostures and speech.\n*Explains sense objects and sense-organs, thereby helping the reader to\nsee the difference between ultimate realities and concepts or ideas.\n\n!Description:\n\nA general introduction to physical phenomena and the way they are\nrelated to each other and to mental phenomena. The purpose of this\nbook is to show that the study of both mental phenomena and physical\nphenomena is indispensable for the development of the eightfold Path.\nThe quotations from the scriptures provide the reader with lively\nexamples of the way the physical phenomena, which are depending on\nconditions, perform their functions in daily life. The study of this\nbook will help the reader to understand the Buddha's teaching of\nnon-self. This book is suitable for those who already have some\nknowledge of Buddhism. \n\nISBN 978-1-897633-25-0. 9&quot; x 7&quot; paperback, 104 pages, Price 10, Published November 1st 2008.</div>
<div tiddler="The Missing Missis: Whatever happened to Mrs Buddha and her son?" modifier="AlanWeller" modified="200704140735" created="200704140735" tags="">(From the Tipitaka) Princess Yasodhara married the future Buddha (Bodhisatta), Gotama at the age of 16. On the day of the birth of their son Rahula the Bodhisatta renounced the world to find the path to enlightenment.\n\nPrincess Yashodhara and Rahula were eventually ordained into the Buddhist Order where they both developed insight and attained arahantship. In the Apadana the princess declares her attainment (translation not yet published). In the Psalms of the Brethren, Rahula 294-298, Rahula declares his attainment: (AW)\n\nReborn in this Buddha-age through our Bodhisat, as the son of Princess Yasodhara, he was reared with a great retinue of nobles. The circumstances of his entering the Order are recorded in the Khandhaka. And he, his knowledge ripened by gracious words in many Sutta passages, conjured up insight, and so won arahantship. Thereupon, reflecting on his victory, he confessed anna:\n\n Twice blest of fortune am I whom my friends\n Call 'Lucky Rahula.' for I am both\n Child of the Buddha and a Seer of truths;\n Yea, and intoxicants are purged from me;\n Yea, and there's no more coming back to be.\n Ar'hant am I, worthy of men's offerings;\n 'Thrice skilled' my ken is of ambrosial things.\n Blinded are beings by their sense-desires,\n Spread o'er them like a net; covered are they\n By cloack of craving; by their heedless ways\n Caught as a fish in mouth of funnel-net,\n But I, that call of sense abandoning,\n Have cut and snapt the bonds of devil's lure.\n Craving with craving's root abolishing;\n Cool am I now; extinct is fever's fire.</div>
<div tiddler="The Perfections Leading to Enlightenment" modifier="YourName" modified="200707081845" created="200704102336" tags="sujin abhidhamma">The Perfections Leading to Enlightenment\n\nThe Perfections leading to Enlightenment is now published and is available to order via amazon in US and UK.\n\nThe Perfections is a study of the ten good qualities: generosity, morality, renunciation, wisdom, energy, patience, truthfulness, determination, loving-kindness, and equanimity.\n\nIt shows when they are considered perfections and what hinders them.\n\nIt shows the importance of developing them in daily life and how their cultivation is essential for the complete eradication of all defilements.\n\nMany quotes are used from the the original scriptures of Theravada Buddhism and for precision of understanding some Pali terms are used.\n\nThe author is a prolific writer and broadcaster of Buddhist scriptures and has had several books published worldwide.\n\nISBN 1897633238, 200 pages, paperback, 9&quot;x7&quot;, Price 12.95, US $25.00 published 1st April 2007.</div>
<div tiddler="The World in the Buddhist Sense" modifier="AlanWeller" modified="200704150555" created="200704102307" tags="beginner gorkom">By Nina van Gorkom\n\nISBN 1 897633 11 4, 123 pages, paperback, 148mm x 210mm, price  7.95, $ 11.95, published October 6 th 1993.\n\n!Key Points:\n\n * Explains the world in the Buddhist sense: the realities in and around ourselves.\n * Points to the benefit of right understanding: the elimination of delusion and all other faults.\n * Describes what counteracts the development of understanding.\n * Helps to understand the meaning of meditation.\n * Deals with the complexity of the subject mindfulness of breathing.\n * Analyses the difference between the development of calm and the development of insight.\n * Illustrates with many quotes from the Buddhist Theravada scriptures and commentaries.\n\n!Description:\n\nThe purpose of this book is to show that the Buddhas Path to true understanding has to be developed in daily life. It explains the pitfalls one will come across while developing this path and the way to overcome them. The book is composed of letters written in answer to questions about the practice and is suitable for those who already have a background knowledge of Buddhism but who seek a deeper understanding.</div>
<div tiddler="There appear to be two heavyweights at understanding the world-buddhism and physics. What do they have in common and where do they differ?" modifier="AlanWeller" modified="200904100830" created="200904100810" tags="">!What they have in common\nThey are both reproducible. Buddhism concerns the development of understanding of reality which appears now through six doorways. By developing this understanding characteristics of reality will show up as they are and as written in the texts.  Similarly physics experiments can be reproduced to verify measurement.\n\n!Where do they differ\nIn Buddhism the object of the understanding is a reality. In physics the object of understanding is a concept. For example temperature. The physicist understands temperature as the average kinetic energy of particles. This is THINKING about reality. However temperature has a characteristic which can be directly experienced through the body-sense. We do not have to call it anything. If awareness is developed when hot or cold appear then understanding of the characteristic of this reality can be known. This understanding has a REALITY as its object. AW\n\n   </div>
<div tiddler="ToDo" modifier="AlanWeller" modified="200904060856" created="200904060856" tags="">Letters from Nina by Nina van Gorkom\nDhamma in Cambodia by Nina van Gorkom\nWorld in the Buddhist Sense by Nina van Gorkom\nNina van Gorkom's Letters \nFoundation Dhamma Issues by Nina van Gorkom\nPhrases compiled by Alan Weller</div>
<div tiddler="TspotSetupPlugin" modifier="YourName" modified="200703221316" created="200704122206" tags="systemConfig">/***\nRequired by Tiddlyspot\n***/\n//{{{\n\nconfig.options.chkHttpReadOnly = false; // make it so you can by default see edit controls via http\n\nif (window.location.protocol != &quot;file:&quot;)\n config.options.chkGTDLazyAutoSave = false; // disable autosave in d3\n\nconfig.tiddlyspotSiteId = 'zolag';\n\n// probably will need to redo this for TW 2.2\nwith (config.shadowTiddlers) {\n SiteUrl = 'http://'+config.tiddlyspotSiteId+'.tiddlyspot.com';\n SideBarOptions = SideBarOptions.replace(/(&lt;&lt;saveChanges&gt;&gt;)/,&quot;$1&lt;&lt;tiddler TspotSidebar&gt;&gt;&quot;);\n OptionsPanel = OptionsPanel.replace(/^/,&quot;&lt;&lt;tiddler TspotOptions&gt;&gt;&quot;);\n DefaultTiddlers = DefaultTiddlers.replace(/^/,&quot;[[Welcome to Tiddlyspot]] &quot;);\n MainMenu = MainMenu.replace(/^/,&quot;[[Welcome to Tiddlyspot]] &quot;);\n}\n\nmerge(config.shadowTiddlers,{\n\n'Welcome to Tiddlyspot':[\n &quot;This document is a ~TiddlyWiki from tiddlyspot.com. A ~TiddlyWiki is an electronic notebook that is great for managing todo lists, personal information, and all sorts of things.&quot;,\n &quot;&quot;,\n &quot;@@font-weight:bold;font-size:1.3em;color:#444; //What now?// &amp;nbsp;&amp;nbsp;@@ Before you can save any changes, you need to enter your password in the form below. Then configure privacy and other site settings at your [[control panel|http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/controlpanel]] (your control panel username is //&quot; + config.tiddlyspotSiteId + &quot;//).&quot;,\n &quot;&lt;&lt;tiddler TspotControls&gt;&gt;&quot;,\n &quot;See also GettingStarted.&quot;,\n &quot;&quot;,\n &quot;@@font-weight:bold;font-size:1.3em;color:#444; //Working online// &amp;nbsp;&amp;nbsp;@@ You can edit this ~TiddlyWiki right now, and save your changes using the \s&quot;save to web\s&quot; button in the column on the right.&quot;,\n &quot;&quot;,\n &quot;@@font-weight:bold;font-size:1.3em;color:#444; //Working offline// &amp;nbsp;&amp;nbsp;@@ A fully functioning copy of this ~TiddlyWiki can be saved onto your hard drive or USB stick. You can make changes and save them locally without being connected to the Internet. When you're ready to sync up again, just click \s&quot;upload\s&quot; and your ~TiddlyWiki will be saved back to tiddlyspot.com.&quot;,\n &quot;&quot;,\n &quot;@@font-weight:bold;font-size:1.3em;color:#444; //Help!// &amp;nbsp;&amp;nbsp;@@ Find out more about ~TiddlyWiki at [[TiddlyWiki.com|http://tiddlywiki.com]]. Also visit [[TiddlyWiki Guides|http://tiddlywikiguides.org]] for documentation on learning and using ~TiddlyWiki. New users are especially welcome on the [[TiddlyWiki mailing list|http://groups.google.com/group/TiddlyWiki]], which is an excellent place to ask questions and get help. If you have a tiddlyspot related problem email [[tiddlyspot support|mailto:support@tiddlyspot.com]].&quot;,\n &quot;&quot;,\n &quot;@@font-weight:bold;font-size:1.3em;color:#444; //Enjoy :)// &amp;nbsp;&amp;nbsp;@@ We hope you like using your tiddlyspot.com site. Please email [[feedback@tiddlyspot.com|mailto:feedback@tiddlyspot.com]] with any comments or suggestions.&quot;\n].join(&quot;\sn&quot;),\n\n'TspotControls':[\n &quot;| tiddlyspot password:|&lt;&lt;option pasUploadPassword&gt;&gt;|&quot;,\n &quot;| site management:|&lt;&lt;upload http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/store.cgi index.html . . &quot; + config.tiddlyspotSiteId + &quot;&gt;&gt;//(requires tiddlyspot password)//&lt;&lt;br&gt;&gt;[[control panel|http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/controlpanel]], [[download (go offline)|http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/download]]|&quot;,\n &quot;| links:|[[tiddlyspot.com|http://tiddlyspot.com/]], [[FAQs|http://faq.tiddlyspot.com/]], [[announcements|http://announce.tiddlyspot.com/]], [[blog|http://tiddlyspot.com/blog/]], email [[support|mailto:support@tiddlyspot.com]] &amp; [[feedback|mailto:feedback@tiddlyspot.com]], [[donate|http://tiddlyspot.com/?page=donate]]|&quot;\n].join(&quot;\sn&quot;),\n\n'TspotSidebar':[\n &quot;&lt;&lt;upload http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/store.cgi index.html . . &quot; + config.tiddlyspotSiteId + &quot;&gt;&gt;&lt;html&gt;&lt;a href='http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/download' class='button'&gt;download&lt;/a&gt;&lt;/html&gt;&quot;\n].join(&quot;\sn&quot;),\n\n'TspotOptions':[\n &quot;tiddlyspot password:&quot;,\n &quot;&lt;&lt;option pasUploadPassword&gt;&gt;&quot;,\n &quot;&quot;\n].join(&quot;\sn&quot;)\n\n});\n//}}}\n</div>
<div tiddler="UploadLog" modifier="YourName" modified="200907181126" created="200704122316" tags="">| !date | !user | !location | !storeUrl | !uploadDir | !toFilename | !backupdir | !origin |\n| 12/4/2007 23:16:24 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 12/4/2007 23:21:12 | AlanWeller | [[zolag.html|file:///home/alan/zolag.html]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 12/4/2007 23:24:17 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 12/4/2007 23:25:15 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 13/4/2007 21:42:45 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 13/4/2007 21:46:32 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 13/4/2007 19:11:3 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 14/4/2007 2:52:34 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 14/4/2007 2:58:13 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 14/4/2007 3:5:10 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 14/4/2007 3:48:56 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 14/4/2007 3:53:53 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 14/4/2007 4:0:2 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 14/4/2007 10:26:11 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 14/4/2007 10:40:2 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 14/4/2007 10:49:15 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 14/4/2007 12:1:8 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 14/4/2007 12:4:23 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 14/4/2007 12:5:57 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 15/4/2007 1:51:21 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 15/4/2007 2:1:18 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 15/4/2007 2:6:42 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 15/4/2007 2:10:53 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 15/4/2007 2:26:52 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 15/4/2007 2:40:25 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 15/4/2007 2:52:53 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 15/4/2007 3:9:43 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 15/4/2007 3:19:39 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 15/4/2007 4:6:15 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 15/4/2007 4:7:57 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 15/4/2007 14:45:3 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 15/4/2007 16:3:21 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 15/4/2007 16:7:35 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 15/4/2007 17:2:23 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 16/4/2007 12:8:4 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 17/4/2007 8:31:41 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 26/4/2007 22:5:26 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 26/4/2007 22:11:51 | YourName | [[/|http://zolag.tiddlyspot.com/#UploadLog]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 8/7/2007 11:14:21 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 8/7/2007 11:17:46 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 8/7/2007 11:22:40 | AlanWeller | [[zolag(2).html|file:///home/alan/zolag(2).html]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 8/7/2007 11:31:2 | AlanWeller | [[zolag(2).html|file:///home/alan/zolag(2).html]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 8/7/2007 11:51:7 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 4/8/2007 14:52:17 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 26/10/2008 14:54:45 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 26/10/2008 15:5:37 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 27/10/2008 11:12:20 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 28/10/2008 9:22:13 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 28/10/2008 9:52:24 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 7/12/2008 13:6:53 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 7/12/2008 13:9:24 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 7/12/2008 13:11:34 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 7/12/2008 13:15:45 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 7/12/2008 13:17:2 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 7/12/2008 16:42:14 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 7/12/2008 16:42:43 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 27/1/2009 12:47:57 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 27/1/2009 18:57:17 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 27/1/2009 23:32:25 | AlanWeller | [[zolag(3).html|file:///home/alan/zolag(3).html]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 27/1/2009 23:36:37 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 19/2/2009 10:50:50 | YourName | [[zolag.html|file:///home/alan/Downloads/zolag.html]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 19/2/2009 11:5:31 | YourName | [[zolag.html|file:///home/alan/zolag/WEBSITE/zolagmirror/zolag.html]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 19/2/2009 11:23:15 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 20/3/2009 20:50:18 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 20/3/2009 20:55:56 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 20/3/2009 20:57:13 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 4/4/2009 1:14:17 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 6/4/2009 9:29:28 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 6/4/2009 9:32:44 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 6/4/2009 9:35:50 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 6/4/2009 9:43:6 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 6/4/2009 9:48:26 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 6/4/2009 9:57:12 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 6/4/2009 10:27:52 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 6/4/2009 10:46:47 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 6/4/2009 10:54:55 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 7/4/2009 12:47:24 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 7/4/2009 12:54:0 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 7/4/2009 20:10:24 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 7/4/2009 20:16:7 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 7/4/2009 20:16:28 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 9/4/2009 11:11:36 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 9/4/2009 11:11:55 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 9/4/2009 11:11:55 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 10/4/2009 8:59:51 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . | Ok |\n| 10/4/2009 9:32:29 | AlanWeller | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 18/7/2009 12:12:6 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |\n| 18/7/2009 12:26:17 | YourName | [[/|http://zolag.tiddlyspot.com/]] | [[store.cgi|http://zolag.tiddlyspot.com/store.cgi]] | . | index.html | . |</div>
<div tiddler="UploadPlugin" modifier="YourName" modified="200703200115" created="200704122206" tags="systemConfig">/***\n|''Name:''|UploadPlugin|\n|''Description:''|Save to web a TiddlyWiki|\n|''Version:''|3.4.5|\n|''Date:''|Oct 15, 2006|\n|''Source:''|http://tiddlywiki.bidix.info/#UploadPlugin|\n|''Documentation:''|http://tiddlywiki.bidix.info/#UploadDoc|\n|''Author:''|BidiX (BidiX (at) bidix (dot) info)|\n|''License:''|[[BSD open source license|http://tiddlywiki.bidix.info/#%5B%5BBSD%20open%20source%20license%5D%5D ]]|\n|''~CoreVersion:''|2.0.0|\n|''Browser:''|Firefox 1.5; InternetExplorer 6.0; Safari|\n|''Include:''|config.lib.file; config.lib.log; config.lib.options; PasswordTweak|\n|''Require:''|[[UploadService|http://tiddlywiki.bidix.info/#UploadService]]|\n***/\n//{{{\nversion.extensions.UploadPlugin = {\n major: 3, minor: 4, revision: 5, \n date: new Date(2006,9,15),\n source: 'http://tiddlywiki.bidix.info/#UploadPlugin',\n documentation: 'http://tiddlywiki.bidix.info/#UploadDoc',\n author: 'BidiX (BidiX (at) bidix (dot) info',\n license: '[[BSD open source license|http://tiddlywiki.bidix.info/#%5B%5BBSD%20open%20source%20license%5D%5D]]',\n coreVersion: '2.0.0',\n browser: 'Firefox 1.5; InternetExplorer 6.0; Safari'\n};\n//}}}\n\n////+++!![config.lib.file]\n\n//{{{\nif (!config.lib) config.lib = {};\nif (!config.lib.file) config.lib.file= {\n author: 'BidiX',\n version: {major: 0, minor: 1, revision: 0}, \n date: new Date(2006,3,9)\n};\nconfig.lib.file.dirname = function (filePath) {\n var lastpos;\n if ((lastpos = filePath.lastIndexOf(&quot;/&quot;)) != -1) {\n return filePath.substring(0, lastpos);\n } else {\n return filePath.substring(0, filePath.lastIndexOf(&quot;\s\s&quot;));\n }\n};\nconfig.lib.file.basename = function (filePath) {\n var lastpos;\n if ((lastpos = filePath.lastIndexOf(&quot;#&quot;)) != -1) \n filePath = filePath.substring(0, lastpos);\n if ((lastpos = filePath.lastIndexOf(&quot;/&quot;)) != -1) {\n return filePath.substring(lastpos + 1);\n } else\n return filePath.substring(filePath.lastIndexOf(&quot;\s\s&quot;)+1);\n};\nwindow.basename = function() {return &quot;@@deprecated@@&quot;;};\n//}}}\n////===\n\n////+++!![config.lib.log]\n\n//{{{\nif (!config.lib) config.lib = {};\nif (!config.lib.log) config.lib.log= {\n author: 'BidiX',\n version: {major: 0, minor: 1, revision: 1}, \n date: new Date(2006,8,19)\n};\nconfig.lib.Log = function(tiddlerTitle, logHeader) {\n if (version.major &lt; 2)\n this.tiddler = store.tiddlers[tiddlerTitle];\n else\n this.tiddler = store.getTiddler(tiddlerTitle);\n if (!this.tiddler) {\n this.tiddler = new Tiddler();\n this.tiddler.title = tiddlerTitle;\n this.tiddler.text = &quot;| !date | !user | !location |&quot; + logHeader;\n this.tiddler.created = new Date();\n this.tiddler.modifier = config.options.txtUserName;\n this.tiddler.modified = new Date();\n if (version.major &lt; 2)\n store.tiddlers[tiddlerTitle] = this.tiddler;\n else\n store.addTiddler(this.tiddler);\n }\n return this;\n};\n\nconfig.lib.Log.prototype.newLine = function (line) {\n var now = new Date();\n var newText = &quot;| &quot;;\n newText += now.getDate()+&quot;/&quot;+(now.getMonth()+1)+&quot;/&quot;+now.getFullYear() + &quot; &quot;;\n newText += now.getHours()+&quot;:&quot;+now.getMinutes()+&quot;:&quot;+now.getSeconds()+&quot; | &quot;;\n newText += config.options.txtUserName + &quot; | &quot;;\n var location = document.location.toString();\n var filename = config.lib.file.basename(location);\n if (!filename) filename = '/';\n newText += &quot;[[&quot;+filename+&quot;|&quot;+location + &quot;]] |&quot;;\n this.tiddler.text = this.tiddler.text + &quot;\sn&quot; + newText;\n this.addToLine(line);\n};\n\nconfig.lib.Log.prototype.addToLine = function (text) {\n this.tiddler.text = this.tiddler.text + text;\n this.tiddler.modifier = config.options.txtUserName;\n this.tiddler.modified = new Date();\n if (version.major &lt; 2)\n store.tiddlers[this.tiddler.tittle] = this.tiddler;\n else {\n store.addTiddler(this.tiddler);\n story.refreshTiddler(this.tiddler.title);\n store.notify(this.tiddler.title, true);\n }\n if (version.major &lt; 2)\n store.notifyAll(); \n};\n//}}}\n////===\n\n////+++!![config.lib.options]\n\n//{{{\nif (!config.lib) config.lib = {};\nif (!config.lib.options) config.lib.options = {\n author: 'BidiX',\n version: {major: 0, minor: 1, revision: 0}, \n date: new Date(2006,3,9)\n};\n\nconfig.lib.options.init = function (name, defaultValue) {\n if (!config.options[name]) {\n config.options[name] = defaultValue;\n saveOptionCookie(name);\n }\n};\n//}}}\n////===\n\n////+++!![PasswordTweak]\n\n//{{{\nversion.extensions.PasswordTweak = {\n major: 1, minor: 0, revision: 3, date: new Date(2006,8,30),\n type: 'tweak',\n source: 'http://tiddlywiki.bidix.info/#PasswordTweak'\n};\n//}}}\n/***\n!!config.macros.option\n***/\n//{{{\nconfig.macros.option.passwordCheckboxLabel = &quot;Save this password on this computer&quot;;\nconfig.macros.option.passwordType = &quot;password&quot;; // password | text\n\nconfig.macros.option.onChangeOption = function(e)\n{\n var opt = this.getAttribute(&quot;option&quot;);\n var elementType,valueField;\n if(opt) {\n switch(opt.substr(0,3)) {\n case &quot;txt&quot;:\n elementType = &quot;input&quot;;\n valueField = &quot;value&quot;;\n break;\n case &quot;pas&quot;:\n elementType = &quot;input&quot;;\n valueField = &quot;value&quot;;\n break;\n case &quot;chk&quot;:\n elementType = &quot;input&quot;;\n valueField = &quot;checked&quot;;\n break;\n }\n config.options[opt] = this[valueField];\n saveOptionCookie(opt);\n var nodes = document.getElementsByTagName(elementType);\n for(var t=0; t&lt;nodes.length; t++) \n {\n var optNode = nodes[t].getAttribute(&quot;option&quot;);\n if (opt == optNode) \n nodes[t][valueField] = this[valueField];\n }\n }\n return(true);\n};\n\nconfig.macros.option.handler = function(place,macroName,params)\n{\n var opt = params[0];\n if(config.options[opt] === undefined) {\n return;}\n var c;\n switch(opt.substr(0,3)) {\n case &quot;txt&quot;:\n c = document.createElement(&quot;input&quot;);\n c.onkeyup = this.onChangeOption;\n c.setAttribute (&quot;option&quot;,opt);\n c.className = &quot;txtOptionInput &quot;+opt;\n place.appendChild(c);\n c.value = config.options[opt];\n break;\n case &quot;pas&quot;:\n // input password\n c = document.createElement (&quot;input&quot;);\n c.setAttribute(&quot;type&quot;,config.macros.option.passwordType);\n c.onkeyup = this.onChangeOption;\n c.setAttribute(&quot;option&quot;,opt);\n c.className = &quot;pasOptionInput &quot;+opt;\n place.appendChild(c);\n c.value = config.options[opt];\n // checkbox link with this password &quot;save this password on this computer&quot;\n c = document.createElement(&quot;input&quot;);\n c.setAttribute(&quot;type&quot;,&quot;checkbox&quot;);\n c.onclick = this.onChangeOption;\n c.setAttribute(&quot;option&quot;,&quot;chk&quot;+opt);\n c.className = &quot;chkOptionInput &quot;+opt;\n place.appendChild(c);\n c.checked = config.options[&quot;chk&quot;+opt];\n // text savePasswordCheckboxLabel\n place.appendChild(document.createTextNode(config.macros.option.passwordCheckboxLabel));\n break;\n case &quot;chk&quot;:\n c = document.createElement(&quot;input&quot;);\n c.setAttribute(&quot;type&quot;,&quot;checkbox&quot;);\n c.onclick = this.onChangeOption;\n c.setAttribute(&quot;option&quot;,opt);\n c.className = &quot;chkOptionInput &quot;+opt;\n place.appendChild(c);\n c.checked = config.options[opt];\n break;\n }\n};\n//}}}\n/***\n!! Option cookie stuff\n***/\n//{{{\nwindow.loadOptionsCookie_orig_PasswordTweak = window.loadOptionsCookie;\nwindow.loadOptionsCookie = function()\n{\n var cookies = document.cookie.split(&quot;;&quot;);\n for(var c=0; c&lt;cookies.length; c++) {\n var p = cookies[c].indexOf(&quot;=&quot;);\n if(p != -1) {\n var name = cookies[c].substr(0,p).trim();\n var value = cookies[c].substr(p+1).trim();\n switch(name.substr(0,3)) {\n case &quot;txt&quot;:\n config.options[name] = unescape(value);\n break;\n case &quot;pas&quot;:\n config.options[name] = unescape(value);\n break;\n case &quot;chk&quot;:\n config.options[name] = value == &quot;true&quot;;\n break;\n }\n }\n }\n};\n\nwindow.saveOptionCookie_orig_PasswordTweak = window.saveOptionCookie;\nwindow.saveOptionCookie = function(name)\n{\n var c = name + &quot;=&quot;;\n switch(name.substr(0,3)) {\n case &quot;txt&quot;:\n c += escape(config.options[name].toString());\n break;\n case &quot;chk&quot;:\n c += config.options[name] ? &quot;true&quot; : &quot;false&quot;;\n // is there an option link with this chk ?\n if (config.options[name.substr(3)]) {\n saveOptionCookie(name.substr(3));\n }\n break;\n case &quot;pas&quot;:\n if (config.options[&quot;chk&quot;+name]) {\n c += escape(config.options[name].toString());\n } else {\n c += &quot;&quot;;\n }\n break;\n }\n c += &quot;; expires=Fri, 1 Jan 2038 12:00:00 UTC; path=/&quot;;\n document.cookie = c;\n};\n//}}}\n/***\n!! Initializations\n***/\n//{{{\n// define config.options.pasPassword\nif (!config.options.pasPassword) {\n config.options.pasPassword = 'defaultPassword';\n window.saveOptionCookie('pasPassword');\n}\n// since loadCookies is first called befor password definition\n// we need to reload cookies\nwindow.loadOptionsCookie();\n//}}}\n////===\n\n////+++!![config.macros.upload]\n\n//{{{\nconfig.macros.upload = {\n accessKey: &quot;U&quot;,\n formName: &quot;UploadPlugin&quot;,\n contentType: &quot;text/html;charset=UTF-8&quot;,\n defaultStoreScript: &quot;store.php&quot;\n};\n\n// only this two configs need to be translated\nconfig.macros.upload.messages = {\n aboutToUpload: &quot;About to upload TiddlyWiki to %0&quot;,\n backupFileStored: &quot;Previous file backuped in %0&quot;,\n crossDomain: &quot;Certainly a cross-domain isue: access to an other site isn't allowed&quot;,\n errorDownloading: &quot;Error downloading&quot;,\n errorUploadingContent: &quot;Error uploading content&quot;,\n fileLocked: &quot;Files is locked: You are not allowed to Upload&quot;,\n fileNotFound: &quot;file to upload not found&quot;,\n fileNotUploaded: &quot;File %0 NOT uploaded&quot;,\n mainFileUploaded: &quot;Main TiddlyWiki file uploaded to %0&quot;,\n passwordEmpty: &quot;Unable to upload, your password is empty&quot;,\n urlParamMissing: &quot;url param missing&quot;,\n rssFileNotUploaded: &quot;RssFile %0 NOT uploaded&quot;,\n rssFileUploaded: &quot;Rss File uploaded to %0&quot;\n};\n\nconfig.macros.upload.label = {\n promptOption: &quot;Save and Upload this TiddlyWiki with UploadOptions&quot;,\n promptParamMacro: &quot;Save and Upload this TiddlyWiki in %0&quot;,\n saveLabel: &quot;save to web&quot;, \n saveToDisk: &quot;save to disk&quot;,\n uploadLabel: &quot;upload&quot; \n};\n\nconfig.macros.upload.handler = function(place,macroName,params){\n // parameters initialization\n var storeUrl = params[0];\n var toFilename = params[1];\n var backupDir = params[2];\n var uploadDir = params[3];\n var username = params[4];\n var password; // for security reason no password as macro parameter\n var label;\n if (document.location.toString().substr(0,4) == &quot;http&quot;)\n label = this.label.saveLabel;\n else\n label = this.label.uploadLabel;\n var prompt;\n if (storeUrl) {\n prompt = this.label.promptParamMacro.toString().format([this.toDirUrl(storeUrl, uploadDir, username)]);\n }\n else {\n prompt = this.label.promptOption;\n }\n createTiddlyButton(place, label, prompt, \n function () {\n config.macros.upload.upload(storeUrl, toFilename, uploadDir, backupDir, username, password); \n return false;}, \n null, null, this.accessKey);\n};\nconfig.macros.upload.UploadLog = function() {\n return new config.lib.Log('UploadLog', &quot; !storeUrl | !uploadDir | !toFilename | !backupdir | !origin |&quot; );\n};\nconfig.macros.upload.UploadLog.prototype = config.lib.Log.prototype;\nconfig.macros.upload.UploadLog.prototype.startUpload = function(storeUrl, toFilename, uploadDir, backupDir) {\n var line = &quot; [[&quot; + config.lib.file.basename(storeUrl) + &quot;|&quot; + storeUrl + &quot;]] | &quot;;\n line += uploadDir + &quot; | &quot; + toFilename + &quot; | &quot; + backupDir + &quot; |&quot;;\n this.newLine(line);\n};\nconfig.macros.upload.UploadLog.prototype.endUpload = function() {\n this.addToLine(&quot; Ok |&quot;);\n};\nconfig.macros.upload.basename = config.lib.file.basename;\nconfig.macros.upload.dirname = config.lib.file.dirname;\nconfig.macros.upload.toRootUrl = function (storeUrl, username)\n{\n return root = (this.dirname(storeUrl)?this.dirname(storeUrl):this.dirname(document.location.toString()));\n}\nconfig.macros.upload.toDirUrl = function (storeUrl, uploadDir, username)\n{\n var root = this.toRootUrl(storeUrl, username);\n if (uploadDir &amp;&amp; uploadDir != '.')\n root = root + '/' + uploadDir;\n return root;\n}\nconfig.macros.upload.toFileUrl = function (storeUrl, toFilename, uploadDir, username)\n{\n return this.toDirUrl(storeUrl, uploadDir, username) + '/' + toFilename;\n}\nconfig.macros.upload.upload = function(storeUrl, toFilename, uploadDir, backupDir, username, password)\n{\n // parameters initialization\n storeUrl = (storeUrl ? storeUrl : config.options.txtUploadStoreUrl);\n toFilename = (toFilename ? toFilename : config.options.txtUploadFilename);\n backupDir = (backupDir ? backupDir : config.options.txtUploadBackupDir);\n uploadDir = (uploadDir ? uploadDir : config.options.txtUploadDir);\n username = (username ? username : config.options.txtUploadUserName);\n password = config.options.pasUploadPassword; // for security reason no password as macro parameter\n if (!password || password === '') {\n alert(config.macros.upload.messages.passwordEmpty);\n return;\n }\n if (storeUrl === '') {\n storeUrl = config.macros.upload.defaultStoreScript;\n }\n if (config.lib.file.dirname(storeUrl) === '') {\n storeUrl = config.lib.file.dirname(document.location.toString())+'/'+storeUrl;\n }\n if (toFilename === '') {\n toFilename = config.lib.file.basename(document.location.toString());\n }\n\n clearMessage();\n // only for forcing the message to display\n if (version.major &lt; 2)\n store.notifyAll();\n if (!storeUrl) {\n alert(config.macros.upload.messages.urlParamMissing);\n return;\n }\n // Check that file is not locked\n if (window.BidiX &amp;&amp; BidiX.GroupAuthoring &amp;&amp; BidiX.GroupAuthoring.lock) {\n if (BidiX.GroupAuthoring.lock.isLocked() &amp;&amp; !BidiX.GroupAuthoring.lock.isMyLock()) {\n alert(config.macros.upload.messages.fileLocked);\n return;\n }\n }\n \n var log = new this.UploadLog();\n log.startUpload(storeUrl, toFilename, uploadDir, backupDir);\n if (document.location.toString().substr(0,5) == &quot;file:&quot;) {\n saveChanges();\n }\n var toDir = config.macros.upload.toDirUrl(storeUrl, toFilename, uploadDir, username);\n displayMessage(config.macros.upload.messages.aboutToUpload.format([toDir]), toDir);\n this.uploadChanges(storeUrl, toFilename, uploadDir, backupDir, username, password);\n if(config.options.chkGenerateAnRssFeed) {\n //var rssContent = convertUnicodeToUTF8(generateRss());\n var rssContent = generateRss();\n var rssPath = toFilename.substr(0,toFilename.lastIndexOf(&quot;.&quot;)) + &quot;.xml&quot;;\n this.uploadContent(rssContent, storeUrl, rssPath, uploadDir, '', username, password, \n function (responseText) {\n if (responseText.substring(0,1) != '0') {\n displayMessage(config.macros.upload.messages.rssFileNotUploaded.format([rssPath]));\n }\n else {\n var toFileUrl = config.macros.upload.toFileUrl(storeUrl, rssPath, uploadDir, username);\n displayMessage(config.macros.upload.messages.rssFileUploaded.format(\n [toFileUrl]), toFileUrl);\n }\n // for debugging store.php uncomment last line\n //DEBUG alert(responseText);\n });\n }\n return;\n};\n\nconfig.macros.upload.uploadChanges = function(storeUrl, toFilename, uploadDir, backupDir, \n username, password) {\n var original;\n if (document.location.toString().substr(0,4) == &quot;http&quot;) {\n original = this.download(storeUrl, toFilename, uploadDir, backupDir, username, password);\n return;\n }\n else {\n // standard way : Local file\n \n original = loadFile(getLocalPath(document.location.toString()));\n if(window.Components) {\n // it's a mozilla browser\n try {\n netscape.security.PrivilegeManager.enablePrivilege(&quot;UniversalXPConnect&quot;);\n var converter = Components.classes[&quot;@mozilla.org/intl/scriptableunicodeconverter&quot;]\n .createInstance(Components.interfaces.nsIScriptableUnicodeConverter);\n converter.charset = &quot;UTF-8&quot;;\n original = converter.ConvertToUnicode(original);\n }\n catch(e) {\n }\n }\n }\n //DEBUG alert(original);\n this.uploadChangesFrom(original, storeUrl, toFilename, uploadDir, backupDir, \n username, password);\n};\n\nconfig.macros.upload.uploadChangesFrom = function(original, storeUrl, toFilename, uploadDir, backupDir, \n username, password) {\n var startSaveArea = '&lt;div id=&quot;' + 'storeArea&quot;&gt;'; // Split up into two so that indexOf() of this source doesn't find it\n var endSaveArea = '&lt;/d' + 'iv&gt;';\n // Locate the storeArea div's\n var posOpeningDiv = original.indexOf(startSaveArea);\n var posClosingDiv = original.lastIndexOf(endSaveArea);\n if((posOpeningDiv == -1) || (posClosingDiv == -1))\n {\n alert(config.messages.invalidFileError.format([document.location.toString()]));\n return;\n }\n var revised = original.substr(0,posOpeningDiv + startSaveArea.length) + \n allTiddlersAsHtml() + &quot;\sn\st\st&quot; +\n original.substr(posClosingDiv);\n var newSiteTitle;\n if(version.major &lt; 2){\n newSiteTitle = (getElementText(&quot;siteTitle&quot;) + &quot; - &quot; + getElementText(&quot;siteSubtitle&quot;)).htmlEncode();\n } else {\n newSiteTitle = (wikifyPlain (&quot;SiteTitle&quot;) + &quot; - &quot; + wikifyPlain (&quot;SiteSubtitle&quot;)).htmlEncode();\n }\n\n revised = revised.replaceChunk(&quot;&lt;title&quot;+&quot;&gt;&quot;,&quot;&lt;/title&quot;+&quot;&gt;&quot;,&quot; &quot; + newSiteTitle + &quot; &quot;);\n revised = revised.replaceChunk(&quot;&lt;!--PRE-HEAD-START--&quot;+&quot;&gt;&quot;,&quot;&lt;!--PRE-HEAD-END--&quot;+&quot;&gt;&quot;,&quot;\sn&quot; + store.getTiddlerText(&quot;MarkupPreHead&quot;,&quot;&quot;) + &quot;\sn&quot;);\n revised = revised.replaceChunk(&quot;&lt;!--POST-HEAD-START--&quot;+&quot;&gt;&quot;,&quot;&lt;!--POST-HEAD-END--&quot;+&quot;&gt;&quot;,&quot;\sn&quot; + store.getTiddlerText(&quot;MarkupPostHead&quot;,&quot;&quot;) + &quot;\sn&quot;);\n revised = revised.replaceChunk(&quot;&lt;!--PRE-BODY-START--&quot;+&quot;&gt;&quot;,&quot;&lt;!--PRE-BODY-END--&quot;+&quot;&gt;&quot;,&quot;\sn&quot; + store.getTiddlerText(&quot;MarkupPreBody&quot;,&quot;&quot;) + &quot;\sn&quot;);\n revised = revised.replaceChunk(&quot;&lt;!--POST-BODY-START--&quot;+&quot;&gt;&quot;,&quot;&lt;!--POST-BODY-END--&quot;+&quot;&gt;&quot;,&quot;\sn&quot; + store.getTiddlerText(&quot;MarkupPostBody&quot;,&quot;&quot;) + &quot;\sn&quot;);\n\n var response = this.uploadContent(revised, storeUrl, toFilename, uploadDir, backupDir, \n username, password, function (responseText) {\n if (responseText.substring(0,1) != '0') {\n alert(responseText);\n displayMessage(config.macros.upload.messages.fileNotUploaded.format([getLocalPath(document.location.toString())]));\n }\n else {\n if (uploadDir !== '') {\n toFilename = uploadDir + &quot;/&quot; + config.macros.upload.basename(toFilename);\n } else {\n toFilename = config.macros.upload.basename(toFilename);\n }\n var toFileUrl = config.macros.upload.toFileUrl(storeUrl, toFilename, uploadDir, username);\n if (responseText.indexOf(&quot;destfile:&quot;) &gt; 0) {\n var destfile = responseText.substring(responseText.indexOf(&quot;destfile:&quot;)+9, \n responseText.indexOf(&quot;\sn&quot;, responseText.indexOf(&quot;destfile:&quot;)));\n toFileUrl = config.macros.upload.toRootUrl(storeUrl, username) + '/' + destfile;\n }\n else {\n toFileUrl = config.macros.upload.toFileUrl(storeUrl, toFilename, uploadDir, username);\n }\n displayMessage(config.macros.upload.messages.mainFileUploaded.format(\n [toFileUrl]), toFileUrl);\n if (backupDir &amp;&amp; responseText.indexOf(&quot;backupfile:&quot;) &gt; 0) {\n var backupFile = responseText.substring(responseText.indexOf(&quot;backupfile:&quot;)+11, \n responseText.indexOf(&quot;\sn&quot;, responseText.indexOf(&quot;backupfile:&quot;)));\n toBackupUrl = config.macros.upload.toRootUrl(storeUrl, username) + '/' + backupFile;\n displayMessage(config.macros.upload.messages.backupFileStored.format(\n [toBackupUrl]), toBackupUrl);\n }\n var log = new config.macros.upload.UploadLog();\n log.endUpload();\n store.setDirty(false);\n // erase local lock\n if (window.BidiX &amp;&amp; BidiX.GroupAuthoring &amp;&amp; BidiX.GroupAuthoring.lock) {\n BidiX.GroupAuthoring.lock.eraseLock();\n // change mtime with new mtime after upload\n var mtime = responseText.substr(responseText.indexOf(&quot;mtime:&quot;)+6);\n BidiX.GroupAuthoring.lock.mtime = mtime;\n }\n \n \n }\n // for debugging store.php uncomment last line\n //DEBUG alert(responseText);\n }\n );\n};\n\nconfig.macros.upload.uploadContent = function(content, storeUrl, toFilename, uploadDir, backupDir, \n username, password, callbackFn) {\n var boundary = &quot;---------------------------&quot;+&quot;AaB03x&quot;; \n var request;\n try {\n request = new XMLHttpRequest();\n } \n catch (e) { \n request = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;); \n }\n if (window.netscape){\n try {\n if (document.location.toString().substr(0,4) != &quot;http&quot;) {\n netscape.security.PrivilegeManager.enablePrivilege('UniversalBrowserRead');}\n }\n catch (e) {}\n } \n //DEBUG alert(&quot;user[&quot;+config.options.txtUploadUserName+&quot;] password[&quot; + config.options.pasUploadPassword + &quot;]&quot;);\n // compose headers data\n var sheader = &quot;&quot;;\n sheader += &quot;--&quot; + boundary + &quot;\sr\snContent-disposition: form-data; name=\s&quot;&quot;;\n sheader += config.macros.upload.formName +&quot;\s&quot;\sr\sn\sr\sn&quot;;\n sheader += &quot;backupDir=&quot;+backupDir\n +&quot;;user=&quot; + username \n +&quot;;password=&quot; + password\n +&quot;;uploaddir=&quot; + uploadDir;\n // add lock attributes to sheader\n if (window.BidiX &amp;&amp; BidiX.GroupAuthoring &amp;&amp; BidiX.GroupAuthoring.lock) {\n var l = BidiX.GroupAuthoring.lock.myLock;\n sheader += &quot;;lockuser=&quot; + l.user\n + &quot;;mtime=&quot; + l.mtime\n + &quot;;locktime=&quot; + l.locktime;\n }\n sheader += &quot;;;\sr\sn&quot;; \n sheader += &quot;\sr\sn&quot; + &quot;--&quot; + boundary + &quot;\sr\sn&quot;;\n sheader += &quot;Content-disposition: form-data; name=\s&quot;userfile\s&quot;; filename=\s&quot;&quot;+toFilename+&quot;\s&quot;\sr\sn&quot;;\n sheader += &quot;Content-Type: &quot; + config.macros.upload.contentType + &quot;\sr\sn&quot;;\n sheader += &quot;Content-Length: &quot; + content.length + &quot;\sr\sn\sr\sn&quot;;\n // compose trailer data\n var strailer = new String();\n strailer = &quot;\sr\sn--&quot; + boundary + &quot;--\sr\sn&quot;;\n //strailer = &quot;--&quot; + boundary + &quot;--\sr\sn&quot;;\n var data;\n data = sheader + content + strailer;\n //request.open(&quot;POST&quot;, storeUrl, true, username, password);\n try {\n request.open(&quot;POST&quot;, storeUrl, true); \n }\n catch(e) {\n alert(config.macros.upload.messages.crossDomain + &quot;\snError:&quot; +e);\n exit;\n }\n request.onreadystatechange = function () {\n if (request.readyState == 4) {\n if (request.status == 200)\n callbackFn(request.responseText);\n else\n alert(config.macros.upload.messages.errorUploadingContent + &quot;\snStatus: &quot;+request.status.statusText);\n }\n };\n request.setRequestHeader(&quot;Content-Length&quot;,data.length);\n request.setRequestHeader(&quot;Content-Type&quot;,&quot;multipart/form-data; boundary=&quot;+boundary);\n request.send(data); \n};\n\n\nconfig.macros.upload.download = function(uploadUrl, uploadToFilename, uploadDir, uploadBackupDir, \n username, password) {\n var request;\n try {\n request = new XMLHttpRequest();\n } \n catch (e) { \n request = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;); \n }\n try {\n if (uploadUrl.substr(0,4) == &quot;http&quot;) {\n netscape.security.PrivilegeManager.enablePrivilege(&quot;UniversalBrowserRead&quot;);\n }\n else {\n netscape.security.PrivilegeManager.enablePrivilege(&quot;UniversalXPConnect&quot;);\n }\n } catch (e) { }\n //request.open(&quot;GET&quot;, document.location.toString(), true, username, password);\n try {\n request.open(&quot;GET&quot;, document.location.toString(), true);\n }\n catch(e) {\n alert(config.macros.upload.messages.crossDomain + &quot;\snError:&quot; +e);\n exit;\n }\n \n request.onreadystatechange = function () {\n if (request.readyState == 4) {\n if(request.status == 200) {\n config.macros.upload.uploadChangesFrom(request.responseText, uploadUrl, \n uploadToFilename, uploadDir, uploadBackupDir, username, password);\n }\n else\n alert(config.macros.upload.messages.errorDownloading.format(\n [document.location.toString()]) + &quot;\snStatus: &quot;+request.status.statusText);\n }\n };\n request.send(null);\n};\n\n//}}}\n////===\n\n////+++!![Initializations]\n\n//{{{\nconfig.lib.options.init('txtUploadStoreUrl','store.php');\nconfig.lib.options.init('txtUploadFilename','');\nconfig.lib.options.init('txtUploadDir','');\nconfig.lib.options.init('txtUploadBackupDir','');\nconfig.lib.options.init('txtUploadUserName',config.options.txtUserName);\nconfig.lib.options.init('pasUploadPassword','');\nsetStylesheet(\n &quot;.pasOptionInput {width: 11em;}\sn&quot;+\n &quot;.txtOptionInput.txtUploadStoreUrl {width: 25em;}\sn&quot;+\n &quot;.txtOptionInput.txtUploadFilename {width: 25em;}\sn&quot;+\n &quot;.txtOptionInput.txtUploadDir {width: 25em;}\sn&quot;+\n &quot;.txtOptionInput.txtUploadBackupDir {width: 25em;}\sn&quot;+\n &quot;&quot;,\n &quot;UploadOptionsStyles&quot;);\nif (document.location.toString().substr(0,4) == &quot;http&quot;) {\n config.options.chkAutoSave = false; \n saveOptionCookie('chkAutoSave');\n}\nconfig.shadowTiddlers.UploadDoc = &quot;[[Full Documentation|http://tiddlywiki.bidix.info/l#UploadDoc ]]\sn&quot;; \n\n//}}}\n////===\n\n////+++!![Core Hijacking]\n\n//{{{\nconfig.macros.saveChanges.label_orig_UploadPlugin = config.macros.saveChanges.label;\nconfig.macros.saveChanges.label = config.macros.upload.label.saveToDisk;\n\nconfig.macros.saveChanges.handler_orig_UploadPlugin = config.macros.saveChanges.handler;\n\nconfig.macros.saveChanges.handler = function(place)\n{\n if ((!readOnly) &amp;&amp; (document.location.toString().substr(0,4) != &quot;http&quot;))\n createTiddlyButton(place,this.label,this.prompt,this.onClick,null,null,this.accessKey);\n};\n\n//}}}\n////===\n\n</div>
<div tiddler="Was Einstein a Buddhist?" modifier="AlanWeller" modified="200707211321" created="200707211319" tags="">Einstein on Buddhism\nBuddhism has the characteristics of what would be expected in a cosmic religion for the future: It transcends a personal God, avoids dogmas and theology; it covers both the natural and spritual; and it is based on a religious sense aspiring from the experience of all things, natural and spiritual, as a meaningful unity. -Albert Einstein\n\nIf there is any religion that would cope with modern scientific needs it would be Buddhism. -Albert Einstein\n\nA human being is part of the whole, called by us 'Universe'; a part limited in time and space. He experiences himself, his thoughts and feelings as something separated from the rest-a kind of optical delusion of his consciousness. This delusion is a kind of prison for us, restricting us to our personal desires and affection for a few persons nearest us. Our task must be to free ourselves from this prison by widening our circle of compassion to embrace all living creatures and the whole nature in its beauty. Nobody is able to achieve this completely but striving for such achievement is, in itself, a part of the liberation and a foundation for inner security.\n-Albert Einstein\n\nThe most beautiful thing we can experience is the mysterious. It is the source of all true art and science. He to whom this emotion is a stranger, who can no longer pause to wonder and stand rapt in awe, is as good as dead: his eyes are closed. -Albert Einstein\n\nSource: [[The Buddhist Blog: Einstein on Buddhism|http://thebuddhistblog.blogspot.com/2005/05/einstein-on-buddhism.html]]</div>
<div tiddler="What are the beliefs about God, life after death and what makes a committed believer?" modifier="YourName" modified="200704141032" created="200704141032" tags="">Buddhists do not believe in God. They believe in life after death either as a human, an animal or some other lifeform according to previous deeds that have been done. Someone becomes a committed believer when he or she understands the teachings and sees the value of applying that understanding in daily life.\n\n</div>
<div tiddler="What are the conditions for enlightenment?" modifier="YourName" modified="200704140655" created="200704140655" tags="">Extract Abhidhamma in Daily Life, chapter 24.\n\nOne cannot attain enlightenment without having cultivated the right conditions. We read in the Kindred Sayings (V, Maha-vagga, Book XI, Kindred Sayings on Streamwinning, chapter I, 5, Sariputta) about four conditions for becoming a sotapanna (streamwinner). The sutta states:\n\n Now the venerable Sariputta went to see the Exalted One, and on coming to him saluted him and sat down at one side. To the venerable Sariputta so seated the Exalted One said this:\n A limb of stream-winning! A limb of stream-winning! is the saying, Sariputta. Tell me, Sariputta, of what sort is a limb of stream-win.\n Lord, association with the upright is a limb of stream-winning. Hearing the good Dhamma is a limb of stream-winning. Applying the mind is a limb of stream-winning. Conforming to the Dhamma is a limb of stream-winning.\n Well said, Sariputta! Well said, Sariputta! Indeed these are limbs of stream-winning. Now again, Sariputta, they say: The stream! The stream! Of what sort is the stream, Sariputta?\n The stream, lord, is just this ariyan eightfold way, to wit: Right view, right thought, right speech, right action, right livelihood, right effort, right mindfulness, right concentration.\n Well said, Sariputta! Well said, Sariputta! The stream is just this ariyan eightfold way. Now again, Sariputta, they say, Streamwinner! Streamwinner! Of what sort is a streamwinner, Sariputta?\n Whosoever, lord, is blessed with this ariyan eightfold waysuch an one of such a name, of such and such a clan, is called Streamwinner.\n\nThe first condition, association with the righteous person, is most important. It would not be possible to find the right path by oneself. Only Buddhas have accumulated such wisdom that they can find the Path by themselves, without the help of a teacher. Other people, however, need the teachings of a Buddha in order to find the right path, because ignorance has been accumulated for an endlessly long time. We need association with the right person, the good friend in Dhamma, who can point out to us the right path, because our defilements prevent us from finding the right path. Our friend in Dhamma can encourage us to develop right understanding of nama and rupa.\n\nThe question may arise what one should do if one is not able to find the right friend in Dhamma. Is reading the scriptures not a condition to find the path leading to enlightenment? It is true that reading the scriptures is also very helpful since they can encourage us to be mindful of nama and rupa in daily life. We might, however, interpret the teachings in the wrong way. It depends on conditions whether we come into contact with the right person who can help us to understand the teachings as well as the practice in accordance with the teachings. Accumulated kusala kamma can be the condition for us to meet the right person.\n\nWhen we have heard the Dhamma from the right person, we should apply the mind; this is the third condition. We should not blindly follow the person who teaches us Dhamma, but we should investigate the scriptures ourselves, ponder over the Dhamma, and consider it carefully, in order to test the truth.\n\nThe real test of the truth is the practice itself. Therefore, the fourth condition is conforming to the Dhamma, which is the development of the eightfold Path. By being mindful of the phenomena appearing through the six doors we can find out ourselves whether it is true that these phenomena are only nama and rupa, arising because of conditions. We can investigate ourselves whether they are impermanent or permanent, whether they are dukkha or happiness, whether they are non-self, anatta, or self. We can find out through the practice itself whether we really understand the teachings. If we practise in the wrong way we may eventually find out that this does not lead to right understanding of the realities of our daily life. Through the development of the eightfold Path we will have more confidence (saddha) in the Buddhas teachings. We will have more confidence when we experience that through right understanding of nama and rupa in daily life there will be less clinging to self. </div>
<div tiddler="What can we do to overcome these accumulated tendencies to akusala (unwholesomeness)?" modifier="AlanWeller" modified="200704140703" created="200704140703" tags="">From Cambodia Lectures chapter 2.\n\nSujin : At the attainment of Buddhahood, the Buddha realized the truth of Dhamma by his wisdom which eradicated defilements completely. His teaching is different from all other teachings and methods. The highest degree of wisdom taught by other religions and philosophies is only the degree which can temporarily subdue defilements. Defilements can only be completely eradicated by panna, wisdom, developed through satipatthana, which is actually the development of right understanding of the eightfold Path. Only the Buddha has taught this Path, there is no other way leading to the eradication of defilements.\n\nBhikkhu: I can develop this Path sometimes, but I want to develop it thoroughly and reach the goal. I do not know how many lives it will take to reach the goal. I have listened to lectures about vipassan, the development of insight, and I have heard that through insight clinging and the other defilements can be eradicated. The eradication of defilements is most important, but it is extremely difficult, not only for laypeople but also for bhikkhus.\n\nS. : The venerable bhikkhu said that the eradication of defilements is difficult, no matter it concerns bhikkhus or laypeople. It is only panna which can eradicate defilements. If panna does not arise it is impossible to eradicate them.\n\nThrough the accumulation of wisdom together with all the other perfections the Bodhisatta could in his last life, at the attainment of enlightenment, become an omniscient Buddha. Therefore, everyone who is sincerely interested in the Dhamma and who is motivated to study it, should realize that the development of panna is of the highest benefit. Without panna it is impossible to eradicate defilements, and if someone who does not develop panna believes that he can eradicate them, he is utterly deluded. Each person has accumulated many defilements during countless lives, they are accumulated from the past on to this present life, and in this life from the moment of birth until now. However, we should not be discouraged because of this. If we listen to the Dhamma and there is more understanding of it, we can very gradually learn to investigate the characteristics of the realities which appear. This is the way leading to the realization of the truth that dhamma is dhamma, not I, mine or self.\n\nWhen someone begins to listen to the Dhamma and sees that the Dhamma is a most difficult subject, he should not become disheartened. If people, instead of being discouraged, begin to develop panna, they will see that what at first seemed most complicated gradually becomes clearer. The development of right understanding in daily life can become ones habitual inclination and eventually one will be able to fully develop it.\n\nB. : The listeners say that while they are listening to the Dhamma their minds are occupied with the Dhamma, and there is understanding of it. However, when they have finished listening they are distracted, they are absorbed in other things. What should they do in order to cause the citta to be firm and steady with regard to what is wholesome, to be intent on the Dhamma all the time?\n\nS. : This is not possible all the time. However, the citta can gradually become more intent on the Dhamma, depending on ones understanding and confidence. The person who has understanding of the Dhamma will not be forgetful of what he has heard, he will ponder over it and consider it. If he has free time he may be inclined to read the scriptures. When he wakes up in the morning he may still think of the Dhamma he has heard. He may, for example, remember what he heard about rpas of the body. When he touches hardness he can remember that tangible object is not self, not a being, not a person. No matter whether we are asleep or awake, sit, lie down, stand or walk, there is the body; the body is right at hand. There are rupas of the body appearing whenever we touch what is hard or soft. If someone has firm remembrance of the Dhamma he has heard, and if he has accumulated confidence and the other spiritual faculties, indriyas, there are the right conditions for the arising of mindfulness. Sati can be directly aware of the characteristics of realities which are appearing at the present moment. Then he understands that the dhammas, the realities which are appearing, are not abstract categories. Citta, cetasika and rupa, all realities which are explained in the Tipitaka, are appearing now. The truth of Dhamma pertains to this very moment. As panna develops there can be awareness and investigation of the characteristics of realities and in this way they will be seen more clearly. However, if people cling to panna it cannot be developed. When we have listened to the Dhamma we acquire more understanding of it, and then, in accordance with what we have learnt about realities, sati can be aware of the characteristics of realities which appear. Some people have a great deal of understanding whereas others do not have much understanding, depending on the extent they have listened to the Dhamma and considered it. Listening to the Dhamma, intellectual understanding of it and pondering over it, these are conditions which support the arising of sati, and in this way the truth about realities can be understood more clearly. However, we should not be negligent with regard to the development of understanding.\n\nWe should remember that the Buddha in countless former lives as a Bodhisatta had to accumulate the perfections. In his last life during which he attained enlightenment, he was a human being, just like all of us who are sitting here. He was seeing visible object through the eyes, hearing sound through the ears and thinking of different things; he was not all the time thinking of the Dhamma. However, he needed to know the true nature of seeing while he was seeing, he needed to know the true nature of hearing while he was hearing. He needed to know these phenomena as they are because they are realities. After seeing and hearing there are like and dislike of what has been seen and heard, and these are also realities which should be known as they are.\n\nThe Buddha knew that it is extremely difficult to know the true nature of phenomena such as seeing or hearing, which are realities occurring time and again, in daily life. We could reduce our life to just one moment, because life actually occurs during one moment of citta which experiences an object and is then gone. However, if one is not a Bodhisatta one is absorbed in thinking for a long time about what appears just for a moment through the eyes, the ears, the nose, the tongue, the bodysense or the mind. The Bodhisatta was altogether different from us who are time and again infatuated with what we experience. Since he knew that the way leading to enlightenment was extremely difficult, he accumulated patience, energy and the other perfections, which were necessary conditions to attain Buddhahood. He had endless endurance and he did not become disheartened while he accumulated the perfections with the purpose to penetrate the truth of realities and to be able to teach other beings, so that they also could become free from dukkha just like he himself.\n\nEverybody here has the opportunity to listen to the Dhamma which the Buddha realized at the attainment of enlightenment and which he taught to others as well. You do not need to accumulate the perfections to the extent the Buddha accumulated them for the attainment of Buddhahood, but you can listen to the Dhamma and practise the way the Buddha has shown us.\n\nListening to the Dhamma, listening intently, is an essential condition for the arising of panna, there is no other method to develop panna. If people are listening only superficially they are not really listening to the Dhamma. They may call listening what is not really listening, because what they hear goes in at one ear and out at the other; there is no understanding of what they heard. Listening to the Dhamma is actually paying careful attention to what one hears and pondering over it with understanding. It is most important to remember that listening also means applying what one hears. It is not enough to have only theoretical understanding of what one hears, but one should also practise what the Buddha taught.\n\nB. : The venerable bhikkhu says that he has listened already but that he now wants to really practise the Dhamma. However, he has many different tasks to accomplish with regard to the Order of monks, and because of his work his citta is distracted. He has no opportunity to sit quietly, alone. He has listened to the Dhamma and he has understood what he has heard, but he has no leisure time. He wonders whether there is only one way of practice or more than one, depending on ones way of life. A monk has a way of life which is different from the life of laypeople. He understands that laypeople can practise the Dhamma, but he, as a bhikkhu, has many tasks to do which make it difficult to practise. Since he himself is still young he has a lot of work to do. When he is older he will have more leisure time for the practice.\n\nS. : The venerable bhikkhu said that he had listened to the Dhamma already, but, our listening is never enough. Even the arahats in the Buddhas time continued to listen to the Dhamma. The Buddha taught the Dhamma for fortyfive years with the purpose to help people to understand the Truth. We may have listened for a long time, but if we do not come to understand the characteristics of the realities which are appearing, we have not listened long enough yet. It would be better, instead of wanting to practise, to begin to understand the characteristics of the realities appearing at this very moment. We may wish to have no more defilements, but can defilements be eradicated at all if we do not listen to the Dhamma and understand as they are the characteristics of the realities which are appearing?\n\nAs regards the venerable bhikkhus remark about his lack of free time for the practice, not only monks but also laymen have many tasks to fulfill; also many laymen complain that they have no leisure time for the practice. However, the practice of the Dhamma does not depend on the amount of free time one has. Just now, while we are sitting here, there are realities appearing. There are seeing and hearing, and these are real. Also when we are doing our work there are realities appearing. We cannot select a particular time for the understanding of this or that reality. It is necessary to develop panna which understands the realities which are appearing in daily life, until there is complete understanding of them. In this way ignorance, doubt and wrong view of self can be eradicated. </div>
<div tiddler="What interested you about the Buddhist religion and what made you decide to join? How has it changed your life and is there anything you have had to give up to follow the religion? What made the religion right for you and anything else you think may help?" modifier="YourName" modified="200704141034" created="200704141034" tags="">I became interested in buddhism because it does not depend on belief but on the development of understanding of the reality of the present moment such as seeing, hearing, anger, attachment.\n\nThe understanding I have is a condition for calm in my life and I am no longer troubled by not knowing what I am here for. I have had to give up the belief in a self or soul in order to develop the buddhist path.\n\nThe religion is right for me because I think that the Buddha correctly diagnosed the cause of suffering and gave the right pathway for complete deliverance from suffering.</div>
<div tiddler="What is Abhidhamma?" modifier="AlanWeller" modified="200704140759" created="200704140746" tags="">Extract from the Preface of [[Abhidhamma in Daily Life]]\n\nAs regards the Abhidhamma, this is an exposition of all realities in detail. The prefix abhi is used in the sense of `preponderance' or `distinction'. `Abhidhamma' means `higher dhamma' or dhamma in detail. The form of this part of the Tipitaka is different, but the aim is the same: the eradication of wrong view and eventually of all defilements. Thus, when we study the many enumerations of realities, we should not forget the real purpose of our study. The theory (pariyatti) should encourage us to the practice (patipatti) which is necessary for the realization of the truth (pativedha). While we are studying the different mental phenomena (namas) and physical phenomena (rupas) and while we are pondering over them, we can be reminded to be aware of the nama and rupa which appear at that moment. In this way we will discover more and more that the Abhidhamma explains everything which is real, that is, the `worlds' appearing through the six doors of the senses and the mind. \nThis book is meant as an introduction to the study of the Abhidhamma. In order to understand this book, some basic knowledge of Buddhism is necessary. My book The Buddha's Path could be helpful to make the reader acquainted with the basic principles and tenets of Buddhism before he starts to read this book on the Abhidhamma. </div>
<div tiddler="What is Buddhism?" modifier="YourName" modified="200704141203" created="200704132030" tags="beginner">Extract from [[The Buddha's Path]], preface.\n\nWhat is Buddhism? It is different from what most people believe: an Oriental religion full of rituals and ceremonies, which teaches meditation leading to mystical experiences. Buddhism is most practical and matter of fact. The Buddha taught all that is real, all mental phenomena and physical phenomena of our life. By the study of his teachings one learns to investigate ones different mental states which change very rapidly. One comes to know ones faults and vices, even the more subtle ones which are not easily noticeable. One learns what is good and wholesome and how to develop wholesome deeds, speech and thoughts. The Buddha taught on life and death, on the conditions for all phenomena which arise and which are impermanent. He pointed out the suffering and dissatisfaction inherent in the phenomena of life. He explained the true nature of man: a composition of elements which arise and then fall away immediately and which are devoid of an abiding substance, of a self. The Buddha taught the eightfold Path which, if it is developed in the right way, leads to direct understanding of the true nature of all the phenomena of life. It is by direct understanding that defilements can eventually be eradicated. </div>
<div tiddler="What is Kamma (karma)?" modifier="AlanWeller" modified="200704140734" created="200704140734" tags="">Extract Chapter 5 [[The Buddha's Path]].\n\nThe Pali term kamma, also known in its Sanskrit form karma, literally means action or deed. A good deed brings a pleasant result and a bad deed brings an unpleasant result. The results of our own deeds come to us sooner or later, this is the law of kamma and result, and nobody can alter the operation of this law. The Buddhas teaching on kamma and result is difficult to grasp. It is not a dogma one has to accept. There can be theoretical understanding of kamma and result, but by theoretical understanding this law cannot be fully comprehended. Only by direct understanding of the physical phenomena and mental phenomena of our life the condition of kamma which produces result can be seen more clearly. Therefore it should not be expected that the law of kamma and result can be fully understood when we begin to investigate the Buddhas teaching on this subject.\n\nA deed done in the past can produce result later on. Kamma can be compared to a seed developing into a tree which bears fruit later on. Evenso, a bad deed, for example killing, can produce an unpleasant result such as illness or pain. A good deed, for example a deed of generosity, can produce a pleasant result, such as the receiving of beautiful things. When we think of a deed and its result we usually think of a deed which has an effect on someone else. In order to understand the law of kamma and its result we should not think in terms of the conventional realities of persons and situations, but we should have understanding of the ultimate realities of cittas and their accompanying mental factors and of physical phenomena, realities which arise and then fall away immediately. We cannot be sure whether someone else performs kusala kamma or not from the outward appearance of things. We may see someone else giving things away but there may not be the performing of a deed of generosity. The giving may be motivated by selfish motives, and then giving is not kusala kamma. It is the wholesome or unwholesome intention or volition which constitutes kusala kamma or akusala kamma. The terms kusala kamma and akusala kamma can be used in the sense of good deeds and evil deeds, but when we are more precise kamma is the intention or volition motivating deeds performed through bodily action, through speech and through the mind. When we speak of the different types of kusala kamma and akusala kamma we should remember that kamma is intention or volition, a mental reality. Kamma is a mental factor accompanying citta, and it arises and falls away together with the citta.\n\nHow can a deed performed in the past produce its result later on? Kamma, or the volition which accompanies the citta when a good deed or a bad deed is performed, falls away immediately together with the citta. However, since each citta which falls away is succeeded by the next citta, kamma can be accumulated from moment to moment. Its dynamic force is carried on and when the time is ripe it can produce its result. That is the chain of causal action we read about in the above quoted sutta. The same sutta mentions the kinds of akusala kamma performed through body, speech and mind. Not every akusala citta is of the intensity of akusala kamma which can produce a result. When there is clinging to a pleasant sight or sound there is akusala citta but not akusala kamma which could produce a result. Clinging, however, has many degrees. It can be more subtle or it can be strong, such as covetousness, the desire for someone elses property. This has the intensity of akusala kamma when one plans to take away what belongs to someone else. Kusala kamma comprises abstaining from evil deeds as well as the performing of good deeds, deeds of generosity and mental development, such as the study of the Buddhas teachings and the development of understanding of the realities of our life.\n\nMoments of happiness and misery alternate in our life. The experiences of pleasant objects and unpleasant objects through the senses do not occur by chance, they must have a cause: kamma is the cause. We read in the Gradual Sayings (IV, Book of the Eights, Chapter I, 5, Worldly Failings) that the Buddha said to the monks:\n\n Monks, these eight worldly conditions obsess the world; the world revolves round these eight worldly conditions. What eight?\n Gain and loss, fame and obscurity, blame and praise, bodily ease and pain. Monks, these eight worldly conditions obsess the world, the world revolves round these eight worldly conditions.\n Gain, loss, obscurity and fame,\n And censure, praise, bodily ease, pain-\n These are mans statesimpermanent,\n Of time and subject unto change.\n And recognizing these the sage,\n Alert, discerns these things of change;\n Fair things his mind never agitate,\n Nor foul his spirit vex. Gone are\n Compliance and hostility,\n Gone up in smoke and are no more.\n The goal he knows. In measure full\n He knows the stainless, griefless state.\n Beyond becoming has he gone.\n\nThe person who has reached the state of perfection has equanimity towards the vicissitudes of life. He is freed from the chain of causal action, there is no more rebirth for him. So long as one is full of attachment, aversion and ignorance, one wants pleasant objects and dislikes unpleasant objects. However, the experience of pleasant objects and unpleasant objects is not in any ones power, it depends on kamma which produces result. One day there is gain, the next day loss; one day there is praise, the next day blame. Sometimes we are healthy, sometimes we suffer from sickness and pain. The experience of pleasant or unpleasant objects through the senses is not a reward or a punishment. The idea of reward or punishment stems from the conception of a supreme being, a God, who is the judge of mans deeds. The cause of the experience of pleasant and unpleasant objects through the senses is within ourselves: it is kamma. There is seeing and hearing of pleasant and unpleasant objects time and again. Seeing and hearing are the results of kusala kamma or akusala kamma. These results arise just for a moment and then they fall away. When we define what was seen or heard or think of the nature of the object, the moments of result have fallen away already. It is hard to tell whether seeing or hearing is the result of kusala kamma or of akusala kamma. Thinking of what was seen or heard is not result; when there is thinking there is kusala citta or akusala citta, but mostly akusala citta. In order to understand the ultimate realities of kamma and its result we have to be very precise. Seeing, hearing, smelling, tasting and the experience of tangible object through the bodysense are cittas which are results of kamma. Our reactions in a wholesome or in an unwholesome way to the objects which are experienced are not results of kamma, they are kusala citta or akusala citta. Kusala citta and akusala citta can be called the active side of life, since they can perform good deeds and bad deeds which will cause the appropriate results later on. The cittas which are results of ones deeds can be called the passive side of life. We have to receive results, whether we like it or not.\n\nCittas arise because of their own conditions, they are beyond control. Sometimes it seems that we ourselves can cause the enjoyment of pleasant objects. However, there have to be the right conditions for the enjoyment of pleasant objects and enjoyment cannot last as long as we wish. We can enjoy pleasant music by turning on the radio, but kamma is the cause of hearing, not a self. It also depends on conditions whether we can afford a radio or not. One may live in poverty and not be able to afford a radio. It is due to kamma if one is born into a poor family and has to live in uncomfortable circumstances. It is due to kamma if one is born into a family which is well-to-do and if one can live in comfort.\n\nIn order to understand that birth into pleasant surroundings and in unpleasant surroundings is the result of kamma we have to go back to the first moment of a lifespan. There was a citta at the first moment of our life, and this is the rebirth-consciousness. This citta must have a cause and the cause is in the past, it is kamma. Birth is result, we could not select our parents, nor time and place of our birth. The first moment of life is called rebirth-consciousness because there is not only this present life, there were also past lives. It is difficult to understand that kamma of the past produces the birth of a being. We can notice, however, that people are born into different circumstances, with different bodily features and different mental capacities. This does not happen by chance, there must be conditions for such differences. There are different kammas which cause different kinds of birth. In the Discourse on the Lesser Analysis of Deeds (Middle Length Sayings III, number 135) we read that Subha asks the Buddha what the cause is of the different results human beings experience from the time of their birth:\n\n Now, good Gotama, what is the cause, what is the reason that lowness and excellence are to be seen among human beings while they are in human form? For, good Gotama, human beings of short lifespan are to be seen and those of long lifespan; those of many and those of few illnesses; those who are ugly, those who are beautiful; those who are of little account, those of great account; those who are poor, those who are wealthy; those who are of lowly families, those of high families; those who are weak in wisdom, those who are full of wisdom.\n The Buddha answered Subha:\n Deeds are ones own, brahman youth, beings are heirs to deeds, deeds are matrix, deeds are kin, deeds are arbiters. Deed divides beings, that is to say by lowness and excellence.\n\nSome people are born in countries where there is war and famine, others in countries where there is peace and prosperity. This does not happen by chance; kamma, a deed performed in the past, is the cause. If kamma is the cause of birth, what is then the role of the parents? Parents are also a condition for the birth of a child, but they are not the only condition. Kamma produces at the first moment of life the citta which is the rebirth-consciousness. The new human being which comes to life consists of mental phenomena and bodily phenomena. The physical phenomena which arise at the first moment of life must also have a cause: kamma is the cause. Thus, at the first moment of life there is mental result as well as physical result of kamma. Kamma is not the only factor from which bodily phenomena originate. There are four factors in all: kamma, citta, temperature and nutrition. After kamma has produced bodily phenomena at the first moment of life, the other factors also produce bodily phenomena. As to the factor of temperature, there has to be the right temperature for the new being in the womb in order to develop. When the mother takes food, nutrition is suffused in the body and then nutrition is also producing bodily phenomena for the being in the womb. Citta is a condition as well for bodily phenomena arising throughout our life. If there were no citta we could not stay alive, we could not move, we could not perform any activities. If we remember the four factors which produce bodily phenomena, namely kamma, citta, temperature and nutrition, it will help us to understand that the body does not belong to a self. What we call my body consists of bodily phenomena which arise because of different conditions and then fall away. Kamma produces bodily phenomena at the first moment of a lifespan and also throughout life. It is kamma which produces the sense organs of eyesense, earsense, smellingsense, tastingsense and bodysense. The sense organs which are the physical results of kamma are the means for the experiences which are the mental results of kamma: seeing, hearing and the other sense impressions. Thus, kamma produces result at the first moment of life, it produces the births of beings, and in the course of life it also produces pleasant and unpleasant results in the form of experiences through the senses.\n\nKamma can cause rebirth in unhappy and in happy planes of existence. Besides the human plane of existence there are other planes of existence. Birth in an unhappy plane is the result of akusala kamma and birth in a happy plane is the result of kusala kamma. Hell planes and the animal world, for example, are unhappy planes. The human plane and heavenly planes are happy planes. It may be felt by some that the existence of hell planes and heavenly planes is mythology. It should be remembered that conventional terms are used to designate different degrees of unpleasant results and pleasant results of kamma. Birth in a hell plane is an unhappy rebirth because in such a plane there are conditions for the experience of intense suffering. Birth in a heavenly plane is a happy rebirth because in such a plane there are conditions for the experience of pleasant objects. Life in a hell plane or in a heavenly plane does not last forever. There will be rebirth again and it depends on kamma in which plane rebirth-consciousness will arise. Birth in the human plane is the result of kusala kamma, but in the course of life there are conditions for the experience of both pleasant and unpleasant objects through the senses, depending on the different kammas which produce them.\n\nIt may happen that someone who has obtained wealth with dishonest means lives in luxury. How can bad deeds have pleasant results? It is not possible for us to find out which deed of the past produces its corresponding result at present. A criminal can receive pleasant results but these are caused by good deeds. His bad deeds will produce unpleasant results but it is not known when. In the course of many lives good deeds and bad deeds were performed and we do not know when it is the right time for a particular kamma to produce result. A good deed or a bad deed may not produce result during the life it was performed, but it may produce result in the following life or even after countless lives have passed. In the scriptures it is said that when kamma has ripened its fruit is experienced. We read in the Dhammapada, (verses 119 and 120):\n\n Even an evil-doer sees good so long as evil ripens not; but when it bears fruit, then he sees the evil results.\n Even a good person sees evil so long as good ripens not; but when it bears fruit, then the good one sees the good results.\n\nSeveral other conditions are needed for akusala kamma or kusala kamma to produce their appropriate results. The time when one is born or the place where one is born can be a favourable or an unfavourable condition for kusala kamma or for akusala kamma to produce result. For example, when one lives in a time of war there are more conditions for akusala kamma and less conditions for kusala kamma to produce result. A particular kamma may be prevented from producing result when there is a very powerful counteractive kamma which has preponderance. For example, when someone is wealthy and lives in comfort, there are pleasant results for him, caused by kusala kamma. However, he may suddenly lose his wealth and be forced to live in miserable circumstances. His loss is caused by akusala kamma which has ripened so that it can produce unpleasant result. This is an example which shows that the way different kinds of kamma operate in our life is most intricate.</div>
<div tiddler="What is Wrong View (Ditthi)?" modifier="YourName" modified="200704132044" created="200704132044" tags="">Extract from chapter 6 of Introduction to the Buddhist Scriptures (not yet published in print)\n\nThe Four Applications of Mindfulness\n\nWe read in the &quot;Kindred Sayings&quot; (V, Maha-vagga, Book III, Kindred Sayings on the Applications of Mindfulness, Ch I, 1 Ambapali) that the Buddha, while he was staying at Vesali, in Ambapali's Grove, said to the monks:\n\n This, monks, is the sole way that leads to the purification of beings, to the utter passing beyond sorrow and grief, to the destruction of woe and lamentation, to the winning of the Method 1 , to realizing Nibbana, to wit: the four applications of mindfulness. What four?\n Herein, a monk dwells, as regards body (as transient), having overcome, in the world, covetousness and grief. He dwells, as regards feelings... as regards cittas... as regards dhammas, contemplating dhammas (as transient), ardent, composed and mindful, having overcome, in the world, covetousness and grief.\n This, monks, is the sole way that leads to the purification of beings, to the utter passing beyond sorrow and grief, to the destruction of woe and lamentation, to the winning of the Method, to realizing Nibbana, to wit: the four applications of mindfulness.\n\nThe four Applications of Mindfulness are: Mindfulness of Body, including all rupas, Mindfulness of Feeing, Mindfulness of Citta and Mindfulness of Dhammas. &quot;Dhammas&quot; include here all realities which are not classified under the first three Applications of Mindfulness; they are realities classified under different aspects, such as the akusala cetasikas which are the five &quot;hindrances&quot;, the sobhana cetasikas which are the factors of enlightenment, the realities which are classified as the five khandhas or as the ayatanas, &quot;sense-fields&quot;, or the four noble Truths. Thus, the four Applications of Mindfulness contain all realities which appear through the six doors of the senses and the mind and which can be objects of mindfulness. Whatever reality appears at the present moment can be object of mindfulness and right understanding.\n\nThe development of right understanding of realities, satipatthana, is the essence of the Buddha's teaching. The four Applications of Mindfulness have been explained in detail in the &quot;Satipatthana sutta&quot;(Middle Length Sayings I, no 10) and the &quot;Maha-satipatthana sutta&quot;(Dialogues of the Buddha II, no. 22), but also many other parts of the scriptures contain expositions of the teaching of satipatthana. Moreover, even when satipatthana is not explicitly mentioned, it is implied, because it is the only way leading to the eradication of defilements, which is the goal of the Buddha's teachings.\n\nWhen one reads about the monk who &quot;dwells contemplating&quot; body, feelings, cittas and dhammas, one may think that one has to sit and meditate about the objects of satipatthana. We read in the &quot;Book of Analysis&quot; (Ch 7, Analysis of the Foundation of Mindfulness, 195) a word exposition of &quot;contemplating&quot; and &quot;dwells&quot;:\n\n &quot;Contemplating&quot; means: Therein what is contemplation? That which is wisdom, understanding, absence of dullness, truth investigation, right view. This is called contemplation. Of this contemplation he is possessed, well possessed, attained, well attained, endowed, well endowed, furnished. Therefore this is called &quot;contemplating&quot;.\n &quot;Dwells&quot; means: Assumes the four postures, exists, protects, keeps going, maintains, turns about, dwells. Therefore this is called &quot;dwells&quot;.\n\nAs we see, &quot;dwells&quot; does not refer only to sitting, but to the four postures, namely, walking, sitting, standing and lying down. In daily life these four postures are assumed time and again. Thus, he &quot;dwells contemplating&quot; means: it is his habit to be aware in his daily life of the realities included in the &quot;Four Applications of Mindfulness&quot;.\n\nWe read in the above quoted sutta: &quot;having overcome in the world covetousness and grief&quot;. The &quot;Book of Analysis&quot;, in the same section, explains the meaning of the &quot;world&quot;:\n\n This same body is the world, also the five khandhas (as objects) of the attachments are the world. \n\nThe &quot;world&quot; includes all conditioned realities, namas and rupas, which appear through the six doors. At the moment of mindfulness one is not attached to objects, there is no covetousness, nor is there grief or aversion. When there is mindfulness of whatever object presents itself, be it pleasant or unpleasant, there is no wish to flee from it or to go to a quiet place. However, some people feel that they are overwhelmed by defilements, especially when they are occupied with their daily tasks. They believe that they should calm the mind first before they develop vipassana 5. They wonder whether they should not apply the Buddha's advice to dwell at the roots of a tree. It is true that we read for example in the &quot;Middle Length Sayings&quot; (I, no. 8, Discourse on Expunging) that the Buddha, while he was staying near Savatthi, in the Jeta Grove, taught Dhamma to Cunda and after that said:\n\n ...These, Cunda, are the roots of trees, these are empty places. Meditate, Cunda; do not be slothful; be not remorseful later. This is our instruction to you. \n\nThe Buddha spoke such words to monks. The monk should not be attached to the company of people, he should live like an arahat. The Buddha did not tell all monks to live in the forest because forest life is not suitable for everyone; one has to endure hardship and discomfort. Those who had accumulations for living in the forest and for developing samatha, tranquil meditation, could do so, but the Buddha did not lay down any rule as to mental development. Some people had accumulated the skill and inclination to develop both samatha and vipassana, whereas others developed only vipassana. In the same sutta the Buddha explained to Cunda about the attainment of jhana, the result of the development of samatha:\n\n The situation occurs, Cunda, when a monk here, aloof from pleasures of the senses, aloof from unskilled states of mind, may enter on and abide in the first jhana which is accompanied by initial thought and discursive thought 6, is born of aloofness, and is rapturous and joyful. It may occur to him: &quot;I fare along by expunging.&quot; But these, Cunda, are not called expungings in the discipline for an ariyan; these are called &quot;abidings in ease here-now&quot; in the discipline for an ariyan. \n\nThe attainment of jhana brings only temporary freedom from defilements, not the eradication of them. The Buddha spoke in a similar way about the higher stages of jhana. After that the Buddha explained about restraint from all kinds of vices and defilements, about the development of wholesome qualities and the development of the eightfold Path. He taught the &quot;disquisition on expunging...the disquisition on utter quenching&quot;. Through samatha defilements can be temporarily subdued, wheras through insight they can eventually be completely eradicated.\n\nThere are many misunderstandings about the development of samatha. People want to have a peaceful mind, but they do not realize that this is attachment. They do not want to have aversion and worry, but they are ignorant of the disadvantages of attachment. It is attachment which conditions aversion. Even jhana can be an object of clinging. We read in the &quot;Middle Length Sayings&quot; (III, 113, Discourse on the Good Man) that the Buddha, while he was staying near Savatthi, in the Jeta Grove, spoke to the monks about dhamma of good men and dhamma of bad men. The &quot;bad man&quot; is proud of the fact that he is of a high family, of his fame, of the monk's requisites he obtains. He exalts himself and disparages others because of these things, whereas the good man thinks of the goal of dhamma, does not exalt himself and does not disparage others. The bad man is proud of having heard much (of the teachings), of being an expert in Vinaya, a speaker on dhamma, a forest dweller, and he is proud of having attained jhana. We read:\n\n And again, monks, a bad man, aloof from pleasures of the senses, aloof from unskilled states of mind, enters on and abides in the first jhana which is accompanied by initial thought and discursive thought, is born of aloofness, and is rapturous and joyful. He reflects thus: &quot;I am an acquirer of the attainment of the first jhana, but these other monks are not acquirers of the attainment of the first jhana.&quot; He exalts himself for that attainment of the first jhana, disparages the others. This too, monks, is dhamma of a bad man. But a good man, monks, reflects thus: &quot;Lack of desire even for the attainment of the first jhana has been spoken of by the Lord; for whatever they imagine it to be, it is otherwise.&quot; He, having made lack of desire itself the main thing, neither exalts himself on account of that attainment of the first jhana nor disparages others. This, too, monks, is dhamma of a good man... \n\nThe same is stated about the higher stages of jhana. The bad man who attains the highest stage of immaterial jhana , the plane of neither-perception-nor-non-perception exalts himself and disparages others. He cannot attain arahatship. The good man who attains the highest stage of immaterial jhana is intent on detachment, he is not proud of his attainment. We read further on that the Buddha said:\n\n And again, monks, a good man, by passing quite beyond the plane of neither-perception-nor-non-perception, enters on and abides in the stopping of perception and feeling 9; and when he has seen by means of wisdom his cankers are caused to be destroyed. And, monks, this monk does not imagine he is aught or anywhere or in anything.... \n\nThis monk, who is a good man, will not be reborn, he has reached the end of the cycle of birth and death. When someone has accumulated the skill and the inclination to develop samatha to the degree of jhana, he should not take jhanacitta for self and he should have no desire for jhana. When jhanacitta arises it does so dependant on the appropriate conditions. He can be mindful of it in order to see it as it is, as non-self.\n\nFor the development of jhana many conditions have to be fulfilled and one should know which are impediments to jhana. We read in the &quot;Gradual Sayings&quot; (V, Book of the Tens, Ch VIII, 2, The thorn) that the Buddha was staying near Vesali in Great Grove, at the House with the Peaked Roof, together with a number of senior monks. A crowd of Licchavis who were riding in their cars made a great noise, dashing into Great Wood to visit the Lord. The monks who were staying with the Buddha remembered that the Buddha had said that noise is an obstacle to jhana, and therefore they retreated to Gosinga Wood where they would be free from noise and crowds. The Buddha asked the other monks where those senior monks were gone and then they gave him the reason for their departure. The Buddha said to them:\n\n Well said! Well said, monks! Those who should assert what those great disciples have asserted would rightly do so. Indeed, monks, I have said that noise is a thorn to jhana . There are these ten thorns. What ten?\n To one who delights in seclusion delight in society is a thorn. To one devoted to concentration on the mark of the foul , concentration on the fair is a thorn. To one guarding the doors of the sense-faculties the sight of shows is a thorn. To the Brahma-life consorting with women is a thorn. To the first jhana sound is a thorn; to the second jhana applied thought and sustained thought ; to the third zest ; to the fourth jhana in-breathing and out-breathing is a thorn . To the attainment of the stopping of perception and feeling, perception and feeling are a thorn. Lust, malice and delusion are thorns.\n So, monks, do you abide thornless, do you abide thorn-removers, do you abide thornless thorn-removers. Monks, the thornless are arahats, the thornless thorn-removers are arahats. \n\nIn this sutta the Buddha speaks about conditions for different stages of jhana, and after that he reminds the monks that attachment, aversion and ignorance are hindrances. He reminds them to become people without defilements, namely arahats. The way leading to the eradication of defilements is satipatthana.\n\nWe read in the sutta that sound is a &quot;thorn&quot; to jhana. Sound is not an obstacle to the development of insight. Someone may find a loud noise distracting from awareness of nama and rupa, but he forgets that sound can be object of awareness. He did not choose to hear such a sound, it just arose because of the appropriate conditions and it was the right time for kamma to produce the vipakacitta which heard that sound. We never know what object will present itself at a particular moment, realities do not belong to a self, they are beyond control. When we hear a loud noise aversion may arise, and that is another reality which arises because of conditions; there can be awareness of its characteristic so that it can be realized as non-self. We would like to ignore akusala, but we should face it with mindfulness and right understanding. If we are not mindful of akusala we will continue to take it for self and it will never be eradicated.\n\nWe read in the &quot;Maha-satipatthana sutta&quot; (Dialogues of the Buddha, XXII) in the section on the fourth Application of Mindfulness, Mindfulness of Dhammas, that the monk has to see dhammas in dhammas. We read that he has to see &quot;dhammas in dhammas from the point of view of the five hindrances&quot;. These are the defilements of sensuous desire, ill-will or anger, sloth and torpor, agitation and worry, and doubt. He has to realize it when there is sensuous desire in him and when he has no sensuous desire, and it is the same with the other hindrances. We read:\n\n ...So does he, as to dhammas, continue to consider them, both internally or externally, or internally and externally together. He ever considers how a dhamma is something that comes to be, again he ever considers how a dhamma is something that passes away, or he ever considers their coming to be with their passing away.... \n\nWhenever defilements arise they should be seen as dhammas, conditioned realities. We read in the above-quoted sutta that a monk should consider the origination and passing away of dhammas, he should see the impermanence of conditioned dhammas. What falls away immediately cannot be owned by a self. We can understand this truth on a theoretical level, but when there is direct awareness of the dhamma which appears the truth can be understood more deeply. When defilements are realized as dhammas which are impermanent and non-self, one will not be disturbed by them; one can face them with right understanding.\n\nFurther on in the above-quoted sutta we read that a monk considers dhammas from the point of view of the five khandhas, of the &quot;Six Internal and External Spheres of Sense&quot; (ayatanas), of the Seven Factors of Enlightenment and of the four noble Truths. Under the section of the second noble Truth, the Truth of the origin of dukkha, which is craving, we read about all the objects of craving. The text states:\n\n And what, monks, is the ariyan Truth concerning the coming to be of dukkha?\n Even this craving, potent for rebirth, that is accompanied by lust and self-indulgence, seeking satisfaction now here, now there, namely, the craving for the life of sense, the craving for becoming (renewed life), and the craving for not becoming (for no rebirth).\n Now this craving, monks, where does it arise, where does it have its dwelling? In those material things of this world which are dear to us, which are pleasant. There does craving arise, there does it dwell.\n What things in this world are dear, what things are pleasant? The eye, the ear, the nose, the tongue, the body and the mind- these are the things in this world that are dear, that are pleasant. There does craving arise, there does it dwell.\n Visible object, sound, odour, flavour, tangible object and mind-object- these are the things in this world that are dear, that are pleasant. There does craving arise, there does it dwell.\n Seeing-consciousness 18, hearing-consciousness, smelling-consciousness, tasting-consciousness, body-consciousness and mind- consciousness- these are the things in this world that are dear, that are pleasant. There does craving arise, there does it dwell.\n Eye-contact 19, ear-contact, nose-contact, tongue-contact, body-contact and mind-contact- these are the things in this world that are dear, that are pleasant. There does craving arise, there does it dwell.\n Feeling originating from eye-contact, feeling originating from ear-contact, feeling originating from nose-contact, feeling originating from tongue-contact, feeling originating from body-contact, and feeling originating from mind-contact- these are the things in this world that are dear, that are pleasant. There does craving arise, there does it dwell.\n The remembrance of visible object, of sound, of odour, of flavour, of tangible object and of mental object- these are the things in this world that are dear, that are pleasant. There does craving arise, there does it dwell. \n\nThe same is said about intention (cetana) concerned with the objects experienced through the six doors, craving for them, thinking about them, deliberating about them.\n\nWe cling to the world appearing through the six doors. Every kind of craving can be considered as dhamma, it is included in the fourth Application of Mindfulness. We cannot force ourselves to be detached from pleasant objects, clinging is a conditioned reality. Clinging arises and falls away, but if there is no sati we do not know that it is a conditioned reality which is impermanent and non-self. We may understand in theory that it makes no sense to cling since pleasant objects only last for a very short while, but we still cling to all objects. Even when insight has been developed to the degree that panna realizes the arising and falling away of realities, clinging is not eradicated yet. The sotapanna sees realities as impermanent and non-self, he has eradicated the wrong view of self; but he still has craving for pleasant objects, and therefore he has to continue to develop insight until arahatship is attained. Only then all forms of clinging are eradicated.\n\nAll the different sections of the &quot;Maha-satipatthana sutta&quot; remind us that whatever reality presents itself can be object of awareness and right understanding. Right understanding can be developed in any situation, no matter whether someone is developing calm or whether he is enjoying pleasant things such as music or delicious food.\n\nWe read in the &quot;Maha-satipatthana sutta&quot; in the section on the Application of Mindfulness of the Body about the Reflection on the Repulsiveness of the Body:\n\n And moreover, monks, a monk reflects upon this very body, from the soles of his feet below upward to the crown of his head, as something enclosed in skin and full of various impurities:- &quot;Here is in this body hair and down, nails, teeth, skin, flesh, sinews, bones, marrow, kidney, heart, liver, membranes, spleen, lungs, stomach, bowels, intestines; excrement, bile, phlegm, pus, blood, sweat, fat, tears, serum, saliva, mucus, synovic fluid, urine.&quot;... \n\nThe repulsiveness of the parts of the body is a meditation subject of samatha which has as its aim to be less attached to the body. However, when we notice &quot;parts of the body&quot;, such as hair or nails, we can be reminded to develop insight in order to realize that what we take for &quot;my body&quot; are only elements which are impermanent and devoid of self. We read in the &quot;Book of Analysis&quot; (Ch 3, Analysis of the Elements, 82) about the element of solidity or hardness, here translated as &quot;extension&quot;:\n\n Therein, what is the element of extension? The element of extension is twofold: It is internal; it is external. Therein what is internal element of extension? That which is personal, self-referable, hard, harsh, hardness, being hard, internal, grasped (by craving and false view). For example: head hair, body hair, nails, teeth, skin; flesh, sinews, bone, bone-marrow, kidneys; heart, liver, membraneous tissue, spleen, lungs; intestines, mesentery, undigested food, excrement; or whatever else there is, personal, self-referable, hard, harsh, hardness, being hard, internal, grasped. This is called internal element of extension.... \n\nIt is then explained that the external element of extension is for example metal, stone or rock. The four Great Elements of solidity, cohesion, heat and motion are present in the body and also in material phenomena outside. Hardness of the body is the same as hardness of a rock, hardness is a paramattha dhamma, a rupa with its own unchangeable characteristic. When hardness appears there can be awareness and right understanding of it as an element which is not &quot;mine&quot; or &quot;self&quot;.\n\nIn the &quot;Maha-satipatthana sutta&quot;, after the section on the &quot;Parts of the Body&quot;, it is said that the monk should dwell contemplating the arising and falling away of dhammas, and this is repeated after each section of the Applications of Mindfulness. Hair, nails and teeth are concepts we can think of, but they consists of rupas which each have their own characteristic. Rupa, the reality which does not know anything, is different from nama, the reality which experiences something. The characteristics of nama and rupa have to be clearly distinguished from each other, not by theoretical understanding, but by insight, direct understanding, which has to be developed through awareness time and again. If nama and rupa are not clearly distinguished from each other, their arising and falling away, their impermanence, cannot be realized and we will continue to cling to the wrong view of self.\n\nSome people believe that the teaching of the four Applications of Mindfulness implies a particular order of objects of mindfulness; they believe that when someone is mindful of the objects included in Mindfulness of the Body, he is only aware of rupa, not of nama. However, there is no particular order of objects of mindfulness, it all depends on conditions which object presents itself at a particular moment. If there would be awareness of rupa, but not of nama, one would not really understand the characteristic of rupa as completely different from the characteristic of nama. Time and again, we notice parts of the body and also at such moments there are namas and rupas which can be objects of mindfulness. The Buddha taught the four Applications of Mindfulness in order to remind us to be aware of rupa, of feelings, of cittas, of dhammas, which include all realities other than those mentioned under the first three sections. At one moment there may be mindfulness of hardness, and at another moment mindfulness of feeling, which may be pleasant, unpleasant or indifferent, or mindfulness of the citta which experiences hardness, or mindfulness of aversion or attachment. There is time and again a reality impinging on one of the six doors. If there is right understanding of the objects of mindfulness, we can learn to be aware of one reality at a time, either a nama or a rupa. In that way their different characteristics can gradually be understood. </div>
<div tiddler="What is meditation?" modifier="YourName" modified="200704140653" created="200704140653" tags="">Extract from Buddhism in Daily Life, Chapter 5.\n\nThe Buddha said that one should realize the impermanence of all things. Everybody is subject to old age, sickness and death. All things are susceptible to change. What one is enjoying today may be changed tomorrow. Many people do not want to face this truth; they are too attached to the pleasant things they can enjoy through eyes, ears, nose, tongue and bodysense. They do not realize that these things are not true happiness. The Buddha cured peoples ignorance by helping them to have right understanding about their life; he taught them Dhamma. The Buddha taught different ways of developing wholesomeness: dana or generosity, sila or morality and bhavana or mental development. Bhavana is a way of kusala kamma which is on a higher level, because wisdom is developed through bhavana.\n\nOne may wonder why wisdom, panna, is essential. The answer is that only understanding things as they are can eliminate ignorance. Out of ignorance people take what is unwholesome for wholesome. Ignorance causes sorrow. The Buddha always helped people to have right understanding of their different cittas (consciousness). He explained what akusala (unwholesome) cittas and kusala (wholesome) cittas are, in order that people could develop more wholesomeness.\n\nWe can verify in our life that the Buddha taught the truth. His teachings are true not only for Buddhists, but for everybody, no matter what race or nationality he is or what religion he professes. Attachment or greed (in Pali: lobha), aversion or anger (in Pali: dosa) and ignorance (in Pali: moha) are common to everybody, not only to Buddhists. Should not everyone eradicate lobha, dosa and moha?\n\nPeople do not always realize that lobha, dosa and moha lead to sorrow. They may recognize unwholesomeness when it is coarse, but not when it is more subtle. For example, they may know that the citta is unwholesome when there is lobha which is as coarse as greed or lust, but they do not recognize lobha when it is more subtle, such as attachment to beautiful things or to dear people. Why is it unwholesome to have attachment to our relatives and friends? It is true that we are bound to have lobha, but we should realize that attachment is not the same as pure loving-kindness (in Pali: metta). When we think that we have pure loving-kindness, there can be moments of attachment too. Attachment is not wholesome; it will sooner or later bring unhappiness. Although people may not like to see this truth, one day they will experience that lobha brings unhappiness. Through death we are bound to lose people who are dear to us. And when sickness or old age affect our sense faculties we may no longer be able to enjoy beautiful things through eyes and ears.\n\nIf we do not have the right understanding of the realities of life we will not know how to bear the loss of dear people. We read in the Udana (Verses of Uplift, Ch VIII, Paialigama, 8, Khuddaka Nikaya) that, while the Buddha was staying near Savatthi in East Park, at the storeyed house of Migaras mother, Visakha came to see him. Visakha who had lost her grand-daughter came to see the Buddha with wet clothes and wet hair. The Buddha said:\n\n Why, Visakha! How is it that you come here with clothes and hair still wet at an unseasonable hour?\n O, sir, my dear and lovely grand-daughter is dead! That is why I come here with hair and clothes still wet at an unseasonable hour.\n Visakha, would you like to have as many sons and grandsons as there are men in Savatthi?\n Yes, sir, I would indeed!\n But how many men do you suppose die daily in Savatthi?\n Ten, sir, or maybe nine, or eight. Maybe seven, six, five or four, three, two; may be one a day dies in Savatthi, sir. Savatthi is never free from men dying, sir.\n What think you, Visakha? In such case would you ever be without wet hair and clothes? Surely not, sir! Enough for me, sir, of so many sons and grandsons!\n Visakha, whoso have a hundred things beloved, they have a hundred sorrows. Whoso have ninety, eighty... thirty, twenty things beloved... whoso have ten... whoso have but one thing beloved, have but one sorrow. Whoso have no thing beloved, they have no sorrow. Sorrowless are they and passionless. Serene are they, I declare.\n\nPeople who see that it is unwholesome to be enslaved by attachment to people and to the things around themselves, want to develop more understanding of realities by applying themselves to bhavana, mental development. Studying the Buddhas teachings and explaining them to others is kusala kamma included in bhavana. In studying the teachings panna will be developed. If we want to understand what the Buddha taught it is essential to read the scriptures as they have come down to us at the present time in the Three Collections: the Vinaya, the Suttanta and the Abhidhamma. Study alone, however, is not enough. We should experience the truth of Dhamma in daily life. Only then will we know things as they really are. Teaching Dhamma to other people is kusala kamma of a high degree. In this way one not only helps others to have more understanding about their life, one develops ones own understanding as well. Teaching Dhamma is the most effective way of helping other people to develop kusala and to eradicate akusala.\n\nAnother way of kusala kamma included in bhavana is the development of calm or samatha bhavana. In samatha there are specific meditation subjects which can condition the calm which is temporary freedom from lobha, dosa and moha. One must have right understanding of the meditation subject and of the way to become calm. When samatha has been highly developed different stages of jhana or absorption can be attained. However, the attainment of jhana is extremely difficult and one must have accumulated the right conditions in order to attain it. When the citta is jhanacitta there are no lobha, dosa and moha. Jhana is kusala kamma of a high degree. Jhana is not the same as a trance which might be experienced after taking certain drugs. Those who take drugs want to obtain the desired end in an easy way and their action is prompted by lobha. Those who apply themselves to samatha have the sincere wish to purify themselves of lobha, dosa and moha; they do not look for sensational or thrilling experiences.\n\nSamatha can purify the mind, but it cannot eradicate unwholesome latent tendencies. When the citta is not jhanacitta, lobha, dosa and moha are bound to arise again. The person who applies himself to samatha cannot eradicate the belief in a self, and so long as there is the concept of self, defilements cannot be eradicated.\n\nThe clinging to the concept of self can only be eradicated through vipassana. Vipassana or insight meditation is another way of kusala kamma included in bhavana. Through the development of vipassana ignorance of realities is eliminated. One learns to see things as they are in being aware, for example, when one sees, hears, smells, tastes, when one receives impressions through the bodysense or when one thinks. When we experience that all things in ourselves and around ourselves are only mental phenomena or nama and physical phenomena or rupa which arise and fall away, we will be less inclined to take them for self.\n\nWhat is the reason that we all are inclined to cling to a self? The reason is that because of our ignorance we do not know things as they really are. When we hear a sound, we are ignorant of the different phenomena which occur during the moment we are hearing that sound. We think that it is a self who is hearing. However, it is not a self who is hearing; it is a citta which hears the sound. Citta is a mental phenomenon, it is nama, that is, the reality which experiences something. The citta which hears experiences sound. Sound itself does not experience anything, it is rupa. Rupa is the reality which does not experience anything. Sound and earsense are conditions for hearing. Earsense is rupa as well. One may wonder whether it is true that earsense does not experience anything. Earsense is a kind of rupa in the ear which has the capacity to receive sound, but it does not experience the sound. It is only a condition for the nama which experiences the sound. Each citta has its own conditions through which it arises. Seeing is conditioned by eyesense which is rupa and by visible object which is also rupa. There is no self who performs different functions such as seeing, hearing, smelling, tasting, receiving impressions through the bodysense and thinking. These are different namas, each of which arises because of its own conditions. </div>
<div tiddler="What is nibbana (nirvana)?" modifier="AlanWeller" modified="200704140751" created="200704140700" tags="">Extract from [[The Buddha's Path]], chapter1.\n\nThe third noble Truth, the cessation of suffering, is nibbana. The Buddha experienced at his enlightenment nibbana. It is difficult to understand what nibbana, is. Nibbana (more popularly known in its Sanskrit form of nirvana) is not a place such as heaven or a paradise where one enjoys eternal bliss. There are heavenly planes, according to the Buddhist teachings, where one can be reborn as a result of a good deed, but existence in such planes is not forever. After ones lifespan in such a plane is ended there will be rebirth in other planes, and thus there is no end to suffering. Nibbana is only an object of speculation so long as it has not been realized. It can be realized when there is full understanding of all phenomena of life which arise because of their own conditions and then fall away. The conditioned phenomena of life are, because of their impermanence, unsatisfactory or suffering. Nibbana is the unconditioned reality, it does not arise and fall away and therefore it is not suffering, it is the end of suffering. Nibbana is real, it is a reality which can be experienced, but we cannot grasp what an unconditioned reality is when we have not realized the truth of conditioned realities. Nibbana is not a God, it is not a person or a self. Since negative terms are used to express what nibbana is, such as the end of rebirth, it may be felt that Buddhism propagates a negative attitude towards life. However, this is not the case. It has to be understood that rebirth is suffering and that nibbana is the end of suffering. Nibbana is freedom from all defilements, and since defilements are the cause of all unhappiness nibbana should be called the highest goal. We read in the Kindred Sayings (IV, Kindred Sayings on Sense, Part IV, Chapter 38, 1, Nibbana) that the wanderer Rose-apple-eater came to see the Buddhas disciple Sariputta and asked him what nibbana was. Sariputta answered:\n\n The destruction of lust, the destruction of hatred, the destruction of illusion, friend, is called nibbana.\n\nExtinction and freedom from desire are meanings of the word nibbana. Nibbana means the end of clinging to existence and thus it is deliverance from all future birth, old age, sickness and death, from all suffering which is inherent in the conditioned realities of life. The Buddha experienced at his enlightenment the unconditioned reality which is nibbana. His passing away was the absolute extinguishment of conditions for the continuation of the life process. When the Buddha was still alive people asked him what would happen to him after his passing away. He explained that this belongs to the questions which cannot be answered, questions which are merely speculative and do not lead to the goal. The Buddhas passing away cannot be called the annihilation of life, and there cannot be rebirth for him in another plane, either. If there would be rebirth he would not have reached the end of all suffering.</div>
<div tiddler="What is the Buddhist answer to the problem of suffering?" modifier="YourName" modified="200704140656" created="200704140656" tags="">Extract from The Buddha's Path, chapter1.\n\nThe Buddha gave his own, unique answer to the problem of suffering. He taught that the cause of suffering is within man, namely his own faults and defilements, and not in the external situation. He explained that only profound knowledge of his own mind and of all phenomena of his life can lead to the end of suffering. We read in the Buddhist scriptures (Kindred Sayings I, Chapter III, Kosala, Part 3, 3, The World) that King Pasenadi had a conversation with the Buddha at Savatthi about the cause of suffering. We read:\n\n How many kinds of things, lord, that happen in the world, make for trouble, for suffering, for distress?\n Three things, sire, happen of that nature. What are the three? Greed, hate, and delusion these three make for trouble, for suffering, for distress.\n\nThe outward circumstances cannot be changed, but the inward attitude towards the vicissitudes of life can be changed. Wisdom can be developed and this can eventually eradicate completely greed, hate and delusion. This wisdom is not developed by speculation about the truth of life, it is developed through the direct experience of the phenomena of life as they really are, including ones own mental states. That is the Path the Buddha taught, but it takes time to understand how it is to be developed. The Buddha was not a God, not a saviour, who wanted people to follow him without questioning the truth of his teaching. He showed the Path to the understanding of the truth, but people had to investigate the truth and develop the Path themselves. We read in the scriptures (Dialogues of the Buddha, II, 16, the Book of the Great Decease) that the Buddha said to his disciple Ananda:\n\n Therefore, Ananda, be an island to yourselves, a refuge to yourselves, seeking no external refuge; with the Teaching as your island, the Teaching as your refuge, seeking no other refuge.\n\nThe Buddha explained that in developing the Path one is ones own refuge.\n\nSee also Chapter 2 The Buddha's Path 22k\n\nExtract from Buddhism in Daily Life, chapter 9.\n\nWe read in the Kindred Sayings (V, Maha-vagga, Book XII, Kindred Sayings about the Truths, Ch II, 1) that the Buddha explained the Four Noble Truths (ariya sacca) to his first five disciples in the Deerpark in Varanasi. The first Noble Truth is the Truth of dukkha which can be translated as suffering or unsatisfactoriness. The Buddha said:\n\n Now this, monks, is the ariyan truth about dukkha:\n Birth is dukkha, decay is dukkha, sickness is dukkha, death is dukkha; likewise sorrow and grief, woe, lamentation and despair. To be conjoined with things we dislike, to be separated from things we like that also is dukkha. Not to get what one wants that also is dukkha. In a word, the five khandhas which are based on grasping are dukkha.\n\n\nThe five khandhas, which are the mental phenomena and the physical phenomena in and around ourselves, are dukkha. One may wonder why they are dukkha. We take the mind for self, but what we call our mind are only mental elements or namas which arise and then fall away immediately. We take the body for self, but what we call our body are only physical elements or rupas which arise and fall away. When we do not know the truth we think that these phenomena can stay; we take them for self. We might for instance think that sadness stays, but there is not only sadness, there are many other phenomena such as seeing, hearing and thinking. What we think is a long time of sadness is, in reality, many different phenomena succeeding one another; none of these phenomena stays.\n\nPhenomena which are impermanent are not real happiness; so they are dukkha. Although dukkha is often translated as suffering, it is not only an unhappy feeling; the first Noble Truth pertains to all phenomena which arise and fall away. There is not anything in our life which is not dukkha. Even happy feeling is dukkha; it does not last. The second Noble Truth is the origin of dukkha, which is craving. The same sutta states:\n\n Now this, monks, is the ariyan truth about the arising of dukkha: It is that craving that leads back to birth, along with the lure and the lust that lingers longingly now here, now there: namely the craving for sensual pleasure, the craving to be born again, the craving for existence to end. Such, monks, is the ariyan truth about the arising of dukkha.\n\nSo long as there is craving in any form there will be a condition for life, for the arising of nama and rupa. Thus, there will be dukkha.\n\nThe third Noble Truth is the cessation of dukkha, which is nibbana. We read in the above quoted sutta:\n\n And this, monks, is the ariyan truth about the ceasing of dukkha: Verily it is the utter passionless cessation of, the giving up, the forsaking, the release from, the absence of longing for this craving.\n\nCraving is the origin of dukkha, whereas when there is the cessation of craving there will be the extinction of rebirth and thus of dukkha. Nibbana is the end of dukkha. The arahat has, at the attainment of enlightenment eradicated all craving and thus for him there are no more conditions for rebirth, and that means the end of dukkha.\n\nWe read in the same sutta about the fourth Noble Truth:\n\n Now this, monks, is the ariyan truth about the practice that leads to the ceasing of dukkha:\n Verily it is the ariyan eightfold way, namely: Right understanding, right thinking, right speech, right action, right livelihood, right effort, right mindfulness, right concentration.\n\nThe eightfold Path (ariya-magga) is the development of right understanding of all phenomena which appear in our daily life. We come to know the world in and around ourselves, not through speculation, but from our own experience. How do we experience the world? We experience the world through seeing, hearing, smelling, tasting, receiving impressions through the bodysense and through the mind. Everything we experience through the doors of the five senses and through the mind-door is extremely short, because all phenomena which arise fall away immediately. When we see, there is the world of visible object, but it does not last, it falls away again. When we hear, there is the world of sound, but it is impermanent. Likewise the world of smell, the world of taste, the world of tangible object and the world of mental objects; none of these worlds lasts.\n\nIn the Visuddhimagga (VIII, 39) we read about the shortness of the world:\n\n ...in the ultimate sense the life-moment of living beings is extremely short, being only as much as the occurrence of a single conscious moment. Just as a chariot wheel, when it is rolling, rolls (that is, touches the ground) only on one point of (the circumference of) its tyre, and, when it is at rest, rests only on one point, so too, the life of living beings lasts only for a single conscious moment. When that consciousness has ceased, the being is said to have ceased...\n Life, person, pleasure, painjust these alone\n Join in one conscious moment that flicks by.\n Ceased khandhas of those dead or alive\n Are all alike, gone never to return.\n No (world is) born if (consciousness is) not\n Produced, when that is present, then it lives;\n When consciousness dissolves, the world is dead...</div>
<div tiddler="What is the meaning of the word Buddha?" modifier="AlanWeller" modified="200704140750" created="200704132032" tags="">Extract: [[Buddhism in Daily Life]] Chapter 6\n\nWhat is the meaning of the word Buddha? The Illustrator of Ultimate Meaning (the Paramatthajotika, a commentary to the Minor Readings, Khuddaka Nikaya) explains, in the commentary to the Three Refuges, the meaning of the word Buddha:\n\n ... and this is said, Buddha: in what sense Buddha? He is the discoverer (bujjhita) of the Truths, thus he is enlightened (Buddha). He is the enlightener (bodheta) of the generation, thus he is enlightened. He is enlightened by omniscience, enlightened by seeing all, enlightened without being led by others... he is quite without defilement, thus he is enlightened; he has travelled by the Path that goes in only one way, thus he is enlightened; he alone discovered the peerless complete enlightenment, thus he is enlightened; ... Buddha: this is not a name made by a mother, made by a father... this (name) Buddha, which signifies final liberation, is a realistic description of Enlightened Ones, Blessed Ones, together with their obtainment of omniscient knowledge at the root of an enlightenment (tree).\n\nThe Buddha is the discoverer of the truth. What is the truth the Buddha discovered all by himself? He is enlightened by omniscience, enlightened by seeing all... the commentary to the Paramatthajotika says. He had developed the wisdom to see and to experience the truth of all things. Everything in life is impermanent and thus it is unsatisfactory. People suffer from old age, sickness and death. In spite of this truth people still cling to the things in and around themselves. Thus they are not able to see reality. The Buddha understood through direct experience that all phenomena which arise fall away immediately. He did not cling to anything at all.</div>
<div tiddler="What is the origin of the Buddhist texts of the Theravada tradition?" modifier="YourName" modified="200704140654" created="200704140654" tags="">Extract from The Buddha's Path, preface.\n\nWhat is the origin of the Buddhist texts of the Theravada tradition as they have come to us today? These texts date from the Buddhas time, about 2500 years ago. Shortly after the Buddhas passing away a Council was held in Rajagaha, were the teachings were examined and scrutinized as to their orthodoxy. Under the leadership of the Buddhas eminent disciple Maha Kassapa five hundred monks who had reached the state of perfection recited all the texts of the Vinaya, the Book of Discipline for the monks, the Suttanta, Discourses, and the Abhidhamma, the higher teaching on ultimate realities. A second Council was held one century later at Vesali. This was necessary because of wrong interpretations of the monkss rules by heretical monks. A third Council was held in 268 B.C. in Pataliputta. On this occasion the canon of the Theravada tradition in the Pali language as it exists today was finally redacted. During all this time the teachings were handed down by oral tradition. About 89 B.C. they were committed to writing in Sri Lanka. </div>
<div tiddler="What is the process of cittas which arise and perform each their own function while they experience a sense object?" modifier="AlanWeller" modified="200704140742" created="200704140742" tags="">Extract from Abhidhamma in Daily Life, chapter 15\n\nAn object which impinges on one of the senses can be visible object, sound, odour, flavour or tangible object. Each of these objects is rupa. They arise and fall away, but they do not fall away as rapidly as nama. As we have seen (in chapter 12), rupa lasts as long as seventeen moments of citta. When a sense object which is rupa impinges on one of the senses, a process of cittas occurs which arise in a particular order and perform each their own function while they experience that sense object. The first citta of that process, the panca-dvaravajjana-citta, five-door-adverting-consciousness, does not arise immediately. First there have to be bhavanga-cittas and these are: atita-bhavanga, past bhavanga, bhavanga-calana, vibrating bhavanga, and bhavangupaccheda, arrest-bhavanga or last bhavanga before the current of bhavanga-cittas is arrested. These bhavanga-cittas do not experience the rupa which impinges on one of the senses. The panca-dvaravajjana-citta, which is a kiriyacitta, adverts to the object and is then succeeded by one of the dvi-panca-vinnanas (seeing-consciousness, hearing-consciousness, etc.) which is vipaka, the result of a good deed or a bad deed. There is, however, not only one moment of vipaka in a process, but several moments. The dvi-panca-vinnana is succeeded by sampaticchana-citta (receiving-consciousness) which is vipaka and this citta is succeeded by santirana-citta (investigating-consciousness) which is also vipaka. The santirana-citta is succeeded by the votthapana-citta (determining-consciousness) which is kiriyacitta. This citta is succeeded by seven javana-cittas which are, in the case of non-arahats, akusala cittas or kusala cittas. All cittas, starting with the panca-dvaravajjana-citta, experience the object which impinges on one of the senses. Counting from the atita-bhavanga, fifteen moments of citta have elapsed when the seventh javana-citta has fallen away. If the rupa which has impinged on one of the senses arose at the same time as the atita-bhavanga, that rupa can survive two more moments of citta, since the duration of rupa equals seventeen moments of citta. Thus, after the javana-cittas there can be two more moments of citta which directly experience the object. These cittas, which are vipakacittas, are tadarammana-cittas or tadalambana-cittas. They perform the function of tadarammana or tadalambana, which is translated as registering or retention. Tadarammana literally means that object; the citta hangs on to that object. When the tadarammana-cittas have fallen away the sense-door process has run its full course. There is, however, not always a complete sense-door process. When the rupa which impinges on one of the senses has arisen before the atita-bhavanga, the process cannot run its full course. Since rupa does not last longer than seventeen moments of citta, it falls away before the tadarammana-cittas could arise. Thus, in that case there are no tadarammana-cittas.\n\nOnly in the sensuous plane of existence kamma can, after kamavacara javana-cittas (of the sense-sphere), produce the vipakacittas which are the tadarammana-cittas, hanging on to the sense object. For those who are born in rupa-brahma-planes where there are less conditions for sense-impressions, and for those who are born in arupa-brahma-planes where there are no sense-impressions, there are no tadarammana-cittas.\n\nSummarizing the cittas which succeed one another when a rupa impinges on one of the senses and becomes the object of cittas of a sense-door process which runs its full course:\n\n 1. Atita-bhavanga (past bhavanga)\n 2. Bhavanga-calana (vibrating bhavanga)\n 3. Bhavangupaccheda (arrest-bhavanga)\n 4. Panca-dvaravajjana-citta (five-door-adverting- consciousness)\n 5. Dvi-panca-vinnana (the five pairs of seeing- consciousness, etc.)\n 6. Sampaticchana-citta (receiving-consciousness)\n 7. Santirana-citta (investigating-consciousness)\n 8. Votthapana-citta (determining-consciousness)\n 9. Javana-cittas, kusala cittas or akusala cittas (in the case of Non-arahats), &quot;running through&quot; the object\n 10. Javana-cittas\n 11. Javana-cittas\n 12. Javana-cittas\n 13. Javana-cittas\n 14. Javana-cittas\n 15. Javana-cittas\n 16. 1 Tadarammana-citta (registering-consciousness)\n 17. 1 Tadarammana-citta (registering-consciousness)</div>
<div tiddler="What sort of person is a better man than a good man?" modifier="AlanWeller" modified="200704140738" created="200704140738" tags="">From the Designation of Human Types, chapter 4\n\n What sort of person is a better man than a good man?\n\n Here a certain person, while he himself refrains from the destruction of life, incites others to refrain, himself refrains from taking things not given, incites others to refrain, himself refrains from misbehaviour in sensual pleasures, incites others to refrain, himself refrains from indulging in the enjoyment of spirituous, fermented liquors and intoxicants, incites others to refrain. Such is the person who is said to be a better man than a good man.</div>
<div tiddler="What the use is of knowing the details about citta and cetasikas?" modifier="YourName" modified="200704132046" created="200704132046" tags="">Extract from Cetasikas: Introduction\n\nThe reader may wonder what the use is of knowing the details about citta and cetasikas. Citta and cetasikas are not abstract categories, they are active at this very moment. We could not see, hear, think, act, be angry or have attachment without cetasikas. Seeing, for example, is a citta. It is the citta which cognizes colour or visible object. In order to perform its function it needs the assistance of cetasikas, such as contact, which contacts visible object, or one-pointedness, which focuses on the object. It is important to have more understanding of cetasikas. We should know that defilements are cetasikas and that good qualities are cetasikas. They arise in daily life and when they appear we should investigate their characteristics. Otherwise we would not know what is right and what is wrong. We would not know when defilements arise and how deeply rooted they are. If the Buddha had not taught in detail about defilements we would only have a vague idea about them. How could we see the danger of defilements when they are unknown to us? How could we develop what is wholesome if we would not know the characteristics of wholesome cetasikas and the different ways of good deeds?</div>
<div tiddler="Who destroys Buddhism?" modifier="AlanWeller" modified="200704140736" created="200704140736" tags="">Buddhists destroy Buddhism.-AlanWeller\n\nFrom the Kindred Sayings xvi, 12\n\n Thus have I heard: The Exalted One was once staying at Savatthi, at Jeta Grove, in the Anathapindika Park.\n Now the venerable Maha-Kassapa went into his presence, saluted him and sat down beside him. So seated, the venerable Maha-Kassapa said this to the Exalted One: 'What now, Lord, are the conditions, what is the cause that formerly there were both fewer precepts and more brethren were established as Arahants ? What, lord, are the conditions, what is the cause that now-a-days there are more precepts and fewer brethren are established as Arahants?'\n 'It happens thus, Kassapa. When members decrease, and the true doctrine disappears, there are then more precepts, and few brethren are established as Arahants. There is no disappearing of the true doctrine, Kassapa, till a counterfeit doctrine arises in the world; but when a counterfeit doctrine does arise, then there is a disappearance of the true doctrine. Just as there is no disappearing of gold so long as there is no counterfeit gold arisen in the world. So it is with the true doctrine.\n ' The earth-element, Kassapa, does not make the true doctrine disappear, nor does the water-element, nor the heat-element, nor the air-element. But here in the Order itself futile men arise, and it is they who make the true doctrine disappear.\n 'Take the sinking of a ship, Kassapa, by overlading: it is not thus that the true doctrine disappears. There are five lowering things that conduce to the obscuration and disappearance of the true doctrine. Which five?\n 'It is when brethren and sisters, laymen and laywomen live in irreverence and are unruly toward the Teacher, live in irreverence and are unruly toward the training, live in irreverence and are unruly toward concentrative study.\n 'But when they live in reverence and docility toward these Five, then do these five things conduce to the maintenance, the clarity, the presence of the true doctrine.</div>
<div tiddler="Who is the maker of this human being?" modifier="AlanWeller" modified="200704140704" created="200704140704" tags="">From the Kindred Sayings 1, Ch v, 10\n\n At Savatthi, Sister Vajira, rising early plunged into the depths of Dark Wood, and seated herself at the foot of a certain tree for noonday rest. Then Mara the evil one, desirous to arouse fear, wavering, and dread in her, desirous of making her desist from being alone, went up to her, and addressed her in verse:-\n\n By whom was wrought this being? Where is he\n Who makes him? Whence doth a being rise?\n Where doth the being cease and pass away?\n Then Sister Vajira thought: Who now is this, human or non-human, that speaketh verse? Sure it is Mara the evil one that speaketh verse, desirous of arousing in me fear, wavering, and dread, desirous of making me desist from being alone. And the Sister, knowing it was Mara, replied in verse:-\n\n Being! Why dost thou harp upon that word?\n Mong false opinions, Mara, hast thou strayed.\n Mere bundle of conditioned factors, this!\n No being can be here discerned to be.\n For just as, when the parts are rightly set,\n The word chariot ariseth [in our minds],\n So doth our usage covenant to say:\n A being when the aggregates are there.\n\n Nay, it is simply ill that rises, ill\n That doth persist, and ill that wanes away.\n Nought beside ill it is that comes to pass,\n Nought else but ill it is doth cease to be.\n Then Mara the evil one thought: Sister Vajira knows me, and sad and sorrowful he vanished there and then.</div>
<div tiddler="Who should be our guide?" modifier="AlanWeller" modified="200704140704" created="200704140704" tags="">Extract from Cambodia Lectures\n\nS. : There is no doubt that the Dhamma is our guide and therefore people should not be attached to teachers. It is very difficult to thoroughly and completely understand the Tipitaka, both as to the letter and the meaning, but we are able to acquire more understanding of it by listening to any person who can explain the truth of Dhamma. However, we should not accept what is not in conformity with realities. We should not cling to persons, we should not believe in persons more than in the Dhamma itself. We should really have confidence in the Dhamma the Buddha assigned as his successor, as our guide.\n\nEverything which occurs does so because of the appropriate conditions. Nobody knows in the case of a particular person his accumulated conditions for such or such aspect of the Dhamma or for the performing of such or such task in the field of Buddhism. May everyone who has the desire to study the Dhamma help to make known the Dhamma in accordance with his own ability. If someone helps explaining the Dhamma, it is not necessary that there are many people who come to listen to him or her. People who have knowledge and understanding of the Dhamma can, each in their own way, help others who do not know the Dhamma to acquire understanding of it. There is no need to think, I succeed this person, or, That person succeeds me. Different people can each perform a task in the field of Dhamma, in accordance with the understanding and capability they have accumulated.\n\nThe way to make known the Dhamma is to first study it oneself, in order to have right understanding. It is wrong to expect others to study the Dhamma and not to study it oneself. Someone may say that Buddhism is most beneficial, that it gives solutions to the problems in our life and in society, but does he really study the Dhamma himself? The person who wants to study Buddhism should be quite sure when he will do so. Otherwise he will keep on thinking about the study he will do in the future, instead of actually studying the Dhamma. When a person is sure when he will study the Dhamma he should also know what exactly he will study and where, in which place, he will study. These are things people should investigate in the right way; they should not neglect studying and gaining understanding of the Dhamma themselves, they should not merely repeat what they have heard from others.\n\nThere is only one way which is the right way: everyone should be his own refuge by studying the Dhamma with the purpose to acquire more understanding of it. Everyone who studies the Dhamma and has right understanding of it, contributes to the propagation of the Dhamma, both with regard to himself and others. When people do not have right understanding of the Dhamma themselves they cannot propagate it. </div>
<div tiddler="ebooks" modifier="AlanWeller" modified="200812071642" created="200810261454" tags="">For free eBooks go here [[Scribd.com/Alan Weller|http://www.scribd.com/people/documents/1746908-alanweller?page=1]]</div>
</div>
<!--POST-BODY-START-->

<!--POST-BODY-END-->
	</body>
</html>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
